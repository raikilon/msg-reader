import{invoke as a,Resource as t,Channel as r}from"./core-DhEqZVGG.js";class l extends t{constructor(e){super(e.rid),this.available=!0,this.currentVersion=e.currentVersion,this.version=e.version,this.date=e.date,this.body=e.body,this.rawJson=e.rawJson}async download(e,d){i(d);const s=new r;e&&(s.onmessage=e);const o=await a("plugin:updater|download",{onEvent:s,rid:this.rid,...d});this.downloadedBytes=new t(o)}async install(){if(!this.downloadedBytes)throw new Error("Update.install called before Update.download");await a("plugin:updater|install",{updateRid:this.rid,bytesRid:this.downloadedBytes.rid}),this.downloadedBytes=void 0}async downloadAndInstall(e,d){i(d);const s=new r;e&&(s.onmessage=e),await a("plugin:updater|download_and_install",{onEvent:s,rid:this.rid,...d})}async close(){await this.downloadedBytes?.close(),await super.close()}}async function w(n){i(n);const e=await a("plugin:updater|check",{...n});return e?new l(e):null}function i(n){n?.headers&&(n.headers=Array.from(new Headers(n.headers).entries()))}export{l as Update,w as check};
