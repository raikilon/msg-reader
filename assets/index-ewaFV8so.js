const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/event-CnyWr2tN.js","assets/core-DhEqZVGG.js","assets/index-CV5cDhyM.js","assets/index-COqiF0ln.js","assets/index-DWAWkcyj.js","assets/webviewWindow-Dwy5goXe.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const f of i.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&e(f)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();class Al{constructor(t=null){this.backend=t||(typeof localStorage<"u"?localStorage:null)}get(t,r=null){if(!this.backend)return r;try{const e=this.backend.getItem(t);return e===null?r:JSON.parse(e)}catch(e){return console.error(`Storage: Error reading '${t}':`,e),r}}set(t,r){if(!this.backend)return!1;try{return this.backend.setItem(t,JSON.stringify(r)),!0}catch(e){return console.error(`Storage: Error writing '${t}':`,e),!1}}remove(t){if(!this.backend)return!1;try{return this.backend.removeItem(t),!0}catch(r){return console.error(`Storage: Error removing '${t}':`,r),!1}}has(t){if(!this.backend)return!1;try{return this.backend.getItem(t)!==null}catch{return!1}}clear(){if(!this.backend)return!1;try{return this.backend.clear(),!0}catch(t){return console.error("Storage: Error clearing storage:",t),!1}}}const gr=new Al;var It=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function va(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var an={exports:{}},sn={exports:{}},Pa;function Sl(){return Pa||(Pa=1,(function(){var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(r,e){return r<<e|r>>>32-e},rotr:function(r,e){return r<<32-e|r>>>e},endian:function(r){if(r.constructor==Number)return t.rotl(r,8)&16711935|t.rotl(r,24)&4278255360;for(var e=0;e<r.length;e++)r[e]=t.endian(r[e]);return r},randomBytes:function(r){for(var e=[];r>0;r--)e.push(Math.floor(Math.random()*256));return e},bytesToWords:function(r){for(var e=[],n=0,i=0;n<r.length;n++,i+=8)e[i>>>5]|=r[n]<<24-i%32;return e},wordsToBytes:function(r){for(var e=[],n=0;n<r.length*32;n+=8)e.push(r[n>>>5]>>>24-n%32&255);return e},bytesToHex:function(r){for(var e=[],n=0;n<r.length;n++)e.push((r[n]>>>4).toString(16)),e.push((r[n]&15).toString(16));return e.join("")},hexToBytes:function(r){for(var e=[],n=0;n<r.length;n+=2)e.push(parseInt(r.substr(n,2),16));return e},bytesToBase64:function(r){for(var e=[],n=0;n<r.length;n+=3)for(var i=r[n]<<16|r[n+1]<<8|r[n+2],f=0;f<4;f++)n*8+f*6<=r.length*8?e.push(s.charAt(i>>>6*(3-f)&63)):e.push("=");return e.join("")},base64ToBytes:function(r){r=r.replace(/[^A-Z0-9+\/]/ig,"");for(var e=[],n=0,i=0;n<r.length;i=++n%4)i!=0&&e.push((s.indexOf(r.charAt(n-1))&Math.pow(2,-2*i+8)-1)<<i*2|s.indexOf(r.charAt(n))>>>6-i*2);return e}};sn.exports=t})()),sn.exports}var on,Ua;function Ha(){if(Ua)return on;Ua=1;var s={utf8:{stringToBytes:function(t){return s.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(s.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var r=[],e=0;e<t.length;e++)r.push(t.charCodeAt(e)&255);return r},bytesToString:function(t){for(var r=[],e=0;e<t.length;e++)r.push(String.fromCharCode(t[e]));return r.join("")}}};return on=s,on}var cn,ja;function Tl(){if(ja)return cn;ja=1,cn=function(r){return r!=null&&(s(r)||t(r)||!!r._isBuffer)};function s(r){return!!r.constructor&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function t(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&s(r.slice(0,0))}return cn}var qa;function Fl(){return qa||(qa=1,(function(){var s=Sl(),t=Ha().utf8,r=Tl(),e=Ha().bin,n=function(i,f){i.constructor==String?f&&f.encoding==="binary"?i=e.stringToBytes(i):i=t.stringToBytes(i):r(i)?i=Array.prototype.slice.call(i,0):!Array.isArray(i)&&i.constructor!==Uint8Array&&(i=i.toString());for(var a=s.bytesToWords(i),l=i.length*8,c=1732584193,o=-271733879,d=-1732584194,u=271733878,h=0;h<a.length;h++)a[h]=(a[h]<<8|a[h]>>>24)&16711935|(a[h]<<24|a[h]>>>8)&4278255360;a[l>>>5]|=128<<l%32,a[(l+64>>>9<<4)+14]=l;for(var v=n._ff,w=n._gg,A=n._hh,_=n._ii,h=0;h<a.length;h+=16){var E=c,x=o,g=d,S=u;c=v(c,o,d,u,a[h+0],7,-680876936),u=v(u,c,o,d,a[h+1],12,-389564586),d=v(d,u,c,o,a[h+2],17,606105819),o=v(o,d,u,c,a[h+3],22,-1044525330),c=v(c,o,d,u,a[h+4],7,-176418897),u=v(u,c,o,d,a[h+5],12,1200080426),d=v(d,u,c,o,a[h+6],17,-1473231341),o=v(o,d,u,c,a[h+7],22,-45705983),c=v(c,o,d,u,a[h+8],7,1770035416),u=v(u,c,o,d,a[h+9],12,-1958414417),d=v(d,u,c,o,a[h+10],17,-42063),o=v(o,d,u,c,a[h+11],22,-1990404162),c=v(c,o,d,u,a[h+12],7,1804603682),u=v(u,c,o,d,a[h+13],12,-40341101),d=v(d,u,c,o,a[h+14],17,-1502002290),o=v(o,d,u,c,a[h+15],22,1236535329),c=w(c,o,d,u,a[h+1],5,-165796510),u=w(u,c,o,d,a[h+6],9,-1069501632),d=w(d,u,c,o,a[h+11],14,643717713),o=w(o,d,u,c,a[h+0],20,-373897302),c=w(c,o,d,u,a[h+5],5,-701558691),u=w(u,c,o,d,a[h+10],9,38016083),d=w(d,u,c,o,a[h+15],14,-660478335),o=w(o,d,u,c,a[h+4],20,-405537848),c=w(c,o,d,u,a[h+9],5,568446438),u=w(u,c,o,d,a[h+14],9,-1019803690),d=w(d,u,c,o,a[h+3],14,-187363961),o=w(o,d,u,c,a[h+8],20,1163531501),c=w(c,o,d,u,a[h+13],5,-1444681467),u=w(u,c,o,d,a[h+2],9,-51403784),d=w(d,u,c,o,a[h+7],14,1735328473),o=w(o,d,u,c,a[h+12],20,-1926607734),c=A(c,o,d,u,a[h+5],4,-378558),u=A(u,c,o,d,a[h+8],11,-2022574463),d=A(d,u,c,o,a[h+11],16,1839030562),o=A(o,d,u,c,a[h+14],23,-35309556),c=A(c,o,d,u,a[h+1],4,-1530992060),u=A(u,c,o,d,a[h+4],11,1272893353),d=A(d,u,c,o,a[h+7],16,-155497632),o=A(o,d,u,c,a[h+10],23,-1094730640),c=A(c,o,d,u,a[h+13],4,681279174),u=A(u,c,o,d,a[h+0],11,-358537222),d=A(d,u,c,o,a[h+3],16,-722521979),o=A(o,d,u,c,a[h+6],23,76029189),c=A(c,o,d,u,a[h+9],4,-640364487),u=A(u,c,o,d,a[h+12],11,-421815835),d=A(d,u,c,o,a[h+15],16,530742520),o=A(o,d,u,c,a[h+2],23,-995338651),c=_(c,o,d,u,a[h+0],6,-198630844),u=_(u,c,o,d,a[h+7],10,1126891415),d=_(d,u,c,o,a[h+14],15,-1416354905),o=_(o,d,u,c,a[h+5],21,-57434055),c=_(c,o,d,u,a[h+12],6,1700485571),u=_(u,c,o,d,a[h+3],10,-1894986606),d=_(d,u,c,o,a[h+10],15,-1051523),o=_(o,d,u,c,a[h+1],21,-2054922799),c=_(c,o,d,u,a[h+8],6,1873313359),u=_(u,c,o,d,a[h+15],10,-30611744),d=_(d,u,c,o,a[h+6],15,-1560198380),o=_(o,d,u,c,a[h+13],21,1309151649),c=_(c,o,d,u,a[h+4],6,-145523070),u=_(u,c,o,d,a[h+11],10,-1120210379),d=_(d,u,c,o,a[h+2],15,718787259),o=_(o,d,u,c,a[h+9],21,-343485551),c=c+E>>>0,o=o+x>>>0,d=d+g>>>0,u=u+S>>>0}return s.endian([c,o,d,u])};n._ff=function(i,f,a,l,c,o,d){var u=i+(f&a|~f&l)+(c>>>0)+d;return(u<<o|u>>>32-o)+f},n._gg=function(i,f,a,l,c,o,d){var u=i+(f&l|a&~l)+(c>>>0)+d;return(u<<o|u>>>32-o)+f},n._hh=function(i,f,a,l,c,o,d){var u=i+(f^a^l)+(c>>>0)+d;return(u<<o|u>>>32-o)+f},n._ii=function(i,f,a,l,c,o,d){var u=i+(a^(f|~l))+(c>>>0)+d;return(u<<o|u>>>32-o)+f},n._blocksize=16,n._digestsize=16,an.exports=function(i,f){if(i==null)throw new Error("Illegal argument "+i);var a=s.wordsToBytes(n(i,f));return f&&f.asBytes?a:f&&f.asString?e.bytesToString(a):s.bytesToHex(a)}})()),an.exports}var Bl=Fl();const Il=va(Bl);class Ml{constructor(t=null){this.storage=t||gr,this.messages=[],this.currentMessage=null,this.pinnedMessages=new Set(this.storage.get("pinnedMessages",[])),this.selectedMessages=new Set}addMessage(t,r){const e=`${t.senderEmail}-${t.messageDeliveryTime}-${t.subject}-${r}`,n=Il(e),i=[t.messageDeliveryTime,t.clientSubmitTime,t.creationTime,t.lastModificationTime];let f=null;for(const l of i)if(l){const c=new Date(l);if(!isNaN(c.getTime())){f=c;break}}const a={...t,fileName:r,messageHash:n,timestamp:f};return this.messages.unshift(a),this.sortMessages(),a}sortMessages(){this.messages.sort((t,r)=>r.timestamp-t.timestamp)}deleteMessage(t){const r=this.messages[t];if(this.messages.splice(t,1),this.pinnedMessages.delete(r.messageHash),this.selectedMessages.delete(r.messageHash),this.savePinnedMessages(),this.messages.length===0)return null;const e=Math.min(t,this.messages.length-1);return this.messages[e]}deleteMessagesByHash(t){const r=new Set(t);if(r.size===0)return 0;const e=this.messages.length;return this.messages=this.messages.filter(n=>!r.has(n.messageHash)),r.forEach(n=>{this.pinnedMessages.delete(n),this.selectedMessages.delete(n)}),this.savePinnedMessages(),e-this.messages.length}togglePin(t){const r=this.messages[t];return this.isPinned(r)?this.pinnedMessages.delete(r.messageHash):this.pinnedMessages.add(r.messageHash),this.savePinnedMessages(),r}setPinnedByHash(t,r){new Set(t).forEach(n=>{r?this.pinnedMessages.add(n):this.pinnedMessages.delete(n)}),this.savePinnedMessages()}isPinned(t){return this.pinnedMessages.has(t.messageHash)}isSelected(t){return this.selectedMessages.has(t.messageHash)}setSelected(t,r){t?.messageHash&&(r?this.selectedMessages.add(t.messageHash):this.selectedMessages.delete(t.messageHash))}clearSelection(){this.selectedMessages.clear()}setSelectionForMessages(t,r){Array.isArray(t)&&t.forEach(e=>this.setSelected(e,r))}getSelectedMessages(){return this.messages.filter(t=>this.selectedMessages.has(t.messageHash))}savePinnedMessages(){this.storage.set("pinnedMessages",[...this.pinnedMessages])}setCurrentMessage(t){this.currentMessage=t}getCurrentMessage(){return this.currentMessage}getMessages(){return this.messages}}const Cl={936:"gbk",950:"big5",932:"shift_jis",949:"cp949",928:"gb2312"},Rl="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iNTAiPjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iNTAiIGZpbGw9IiNlZWUiLz48dGV4dCB4PSI1MCUiIHk9IjUwJSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiM5OTkiPkltYWdlIG5vdCBhdmFpbGFibGU8L3RleHQ+PC9zdmc+",ln=["msg","eml"],kl="utf-8",Dl=.75,$a="en-US",Tr={error:5e3,warning:4e3,info:3e3},Ga={error:"bg-red-500 text-white",warning:"bg-yellow-500 text-black",info:"bg-blue-500 text-white"},Wa=500;class Ll{constructor(t,r){this.container=t,this.itemHeight=r.itemHeight,this.buffer=r.buffer??3,this.renderItem=r.renderItem,this.onItemClick=r.onItemClick,this.items=[],this.scrollTop=0,this.viewportHeight=0,this.visibleStartIndex=0,this.visibleEndIndex=0,this.ticking=!1,this.setupDOM(),this.setupScrollListener(),this.setupResizeObserver()}setupDOM(){this.container&&(this.scrollContent=document.createElement("div"),this.scrollContent.className="virtual-list-content",this.scrollContent.style.position="relative",this.scrollContent.style.width="100%",this.visibleContainer=document.createElement("div"),this.visibleContainer.className="virtual-list-visible",this.visibleContainer.style.position="absolute",this.visibleContainer.style.width="100%",this.visibleContainer.style.left="0",this.scrollContent.appendChild(this.visibleContainer),this.container.innerHTML="",this.container.appendChild(this.scrollContent),this.container.addEventListener("click",t=>{const r=t.target.closest("[data-message-index]");if(r&&this.onItemClick){const e=parseInt(r.dataset.messageIndex,10);this.onItemClick(e,this.items[e])}}))}setupScrollListener(){this.container&&this.container.addEventListener("scroll",()=>{this.ticking||(requestAnimationFrame(()=>{this.onScroll(),this.ticking=!1}),this.ticking=!0)},{passive:!0})}setupResizeObserver(){this.container&&typeof ResizeObserver<"u"&&(this.resizeObserver=new ResizeObserver(()=>{this.viewportHeight=Math.max(this.container.clientHeight,Wa),this.render()}),this.resizeObserver.observe(this.container))}onScroll(){this.scrollTop=this.container.scrollTop,this.render()}setItems(t){this.items=t,this.viewportHeight=Math.max(this.container.clientHeight,Wa),this.render()}calculateVisibleRange(){const t=Math.max(0,Math.floor(this.scrollTop/this.itemHeight)-this.buffer),r=Math.min(this.items.length,Math.ceil((this.scrollTop+this.viewportHeight)/this.itemHeight)+this.buffer);return{startIndex:t,endIndex:r}}render(){if(!this.container||this.items.length===0){this.scrollContent.style.height="0px",this.visibleContainer.innerHTML="";return}const t=this.items.length*this.itemHeight;this.scrollContent.style.height=`${t}px`;const{startIndex:r,endIndex:e}=this.calculateVisibleRange();this.visibleStartIndex=r,this.visibleEndIndex=e;const n=r*this.itemHeight;this.visibleContainer.style.top=`${n}px`;const i=this.items.slice(r,e);this.visibleContainer.innerHTML=i.map((f,a)=>this.renderItem(f,r+a)).join(""),this.updateAriaAttributes(r,e)}updateAriaAttributes(t,r){this.container.setAttribute("aria-rowcount",this.items.length.toString()),this.visibleContainer.querySelectorAll("[data-message-index]").forEach((n,i)=>{const f=t+i;n.setAttribute("aria-setsize",this.items.length.toString()),n.setAttribute("aria-posinset",(f+1).toString())})}scrollToIndex(t,r={}){if(t<0||t>=this.items.length)return;const e=t*this.itemHeight,n=e+this.itemHeight,i=this.scrollTop,f=i+this.viewportHeight;let a=null;const l=r.block||"nearest";l==="center"?a=e-(this.viewportHeight-this.itemHeight)/2:l==="start"?a=e:l==="end"?a=n-this.viewportHeight:e<i?a=e:n>f&&(a=n-this.viewportHeight),a!==null&&(a=Math.max(0,Math.min(a,this.items.length*this.itemHeight-this.viewportHeight)),typeof this.container.scrollTo=="function"?this.container.scrollTo({top:a,behavior:r.behavior||"smooth"}):this.container.scrollTop=a,this.scrollTop=a,this.render())}getItemElement(t){return this.visibleContainer.querySelector(`#message-${t}`)}isItemVisible(t){return t>=this.visibleStartIndex&&t<this.visibleEndIndex}updateItem(t,r){if(this.items[t]=r,this.isItemVisible(t)){const e=this.getItemElement(t);if(e){const n=this.renderItem(r,t),i=document.createElement("div");i.innerHTML=n,e.replaceWith(i.firstElementChild)}}}getScrollInfo(){return{scrollTop:this.scrollTop,viewportHeight:this.viewportHeight,totalHeight:this.items.length*this.itemHeight,visibleStartIndex:this.visibleStartIndex,visibleEndIndex:this.visibleEndIndex}}destroy(){this.resizeObserver&&this.resizeObserver.disconnect(),this.container.innerHTML="",this.items=[]}}const Ol=72;class Nl{constructor(t,r){this.container=t,this.messageHandler=r,this.virtualList=new Ll(t,{itemHeight:Ol,buffer:5,renderItem:(e,n)=>this.renderMessageItem(e,n)})}render(){if(!this.container)return;const t=this.messageHandler.getMessages();this.renderFiltered(t)}renderFiltered(t,r=!1){if(!this.container)return;this.filteredMessages=t,this.isSearchResult=r||t.length<this.messageHandler.getMessages().length,this.container.setAttribute("aria-label",`Email messages, ${t.length} items`),this.updateEmptyState(t.length===0&&this.isSearchResult),this.virtualList.setItems(t);const e=this.messageHandler.getCurrentMessage(),n=t.indexOf(e);n>=0&&this.container.setAttribute("aria-activedescendant",`message-${n}`)}updateEmptyState(t){let r=this.container.parentElement?.querySelector(".search-empty-state");t?(r||(r=document.createElement("div"),r.className="search-empty-state",r.innerHTML=`
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                    </svg>
                    <p class="search-empty-title">No results found</p>
                    <p class="search-empty-hint">Try different keywords or check your spelling</p>
                `,this.container.parentElement?.insertBefore(r,this.container)),r.style.display="flex",this.container.style.display="none"):(r&&(r.style.display="none"),this.container.style.display="")}getFilteredMessages(){return this.filteredMessages||this.messageHandler.getMessages()}renderMessageItem(t,r){const e=this.messageHandler.getCurrentMessage(),n=this.messageHandler.getMessages(),i=this.filteredMessages||n,f=n.indexOf(t),a=t.attachments?.some(v=>!v.pidContentId)||!1,l=t.timestamp,c=this.formatMessageDate(l),o=(t.body||t.bodyContent||"").replace(/<[^>]*>/g,"").replace(/\s+/g," ").trim(),d=t===e,u=this.messageHandler.isPinned(t),h=this.messageHandler.isSelected?this.messageHandler.isSelected(t):!1;return`
            <div class="message-item ${d?"active":""} ${u?"pinned":""} ${h?"selected":""}"
                 id="message-${r}"
                 role="option"
                 aria-selected="${d}"
                 aria-current="${d?"true":"false"}"
                 aria-setsize="${i.length}"
                 aria-posinset="${r+1}"
                 data-message-index="${f}"
                 tabindex="${d?"0":"-1"}"
                 title="${t.fileName}">
                <label class="message-select" data-action="select-message" data-message-index="${f}" title="Select message">
                    <input
                        type="checkbox"
                        class="message-select-checkbox"
                        data-action="select-message"
                        data-message-index="${f}"
                        ${h?"checked":""}
                        aria-label="Select message"
                    />
                </label>
                <div class="message-item-content">
                    <div class="message-sender">${t.senderName}</div>
                    <div class="message-subject-line">
                        <span class="message-subject grow">${t.subject}</span>
                        <div class="shrink-0">
                            ${a?'<span class="attachment-icon" aria-label="Has attachments"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13" /></svg></span>':""}
                        </div>
                    </div>
                    <div class="message-preview-container">
                        <div class="message-preview">${o}</div>
                        <div class="message-date">${c}</div>
                    </div>
                </div>
            </div>
        `}formatMessageDate(t){if(!t||Object.prototype.toString.call(t)!=="[object Date]"||isNaN(t.getTime()))return"Unknown date";const r=new Date,e=new Date(r);return e.setDate(e.getDate()-1),t.toDateString()===r.toDateString()?t.toLocaleTimeString($a,{hour:"2-digit",minute:"2-digit"}):t.toDateString()===e.toDateString()?"Yesterday":t.getFullYear()===r.getFullYear()?t.toLocaleDateString($a,{month:"short",day:"numeric"}):t.toISOString().split("T")[0]}scrollToMessage(t,r={}){this.virtualList.scrollToIndex(t,r)}getMessageElement(t){return this.virtualList.getItemElement(t)}isMessageVisible(t){return this.virtualList.isItemVisible(t)}updateMessage(t){const r=this.messageHandler.getMessages();t>=0&&t<r.length&&this.virtualList.updateItem(t,r[t])}destroy(){this.virtualList.destroy()}}const{entries:qc,setPrototypeOf:za,isFrozen:Pl,getPrototypeOf:Ul,getOwnPropertyDescriptor:Hl}=Object;let{freeze:Qe,seal:ct,create:ua}=Object,{apply:fa,construct:da}=typeof Reflect<"u"&&Reflect;Qe||(Qe=function(t){return t});ct||(ct=function(t){return t});fa||(fa=function(t,r){for(var e=arguments.length,n=new Array(e>2?e-2:0),i=2;i<e;i++)n[i-2]=arguments[i];return t.apply(r,n)});da||(da=function(t){for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];return new t(...e)});const Fr=et(Array.prototype.forEach),jl=et(Array.prototype.lastIndexOf),Va=et(Array.prototype.pop),Yt=et(Array.prototype.push),ql=et(Array.prototype.splice),Gr=et(String.prototype.toLowerCase),un=et(String.prototype.toString),fn=et(String.prototype.match),Kt=et(String.prototype.replace),$l=et(String.prototype.indexOf),Gl=et(String.prototype.trim),ut=et(Object.prototype.hasOwnProperty),Xe=et(RegExp.prototype.test),Zt=Wl(TypeError);function et(s){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];return fa(s,t,e)}}function Wl(s){return function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return da(s,r)}}function we(s,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Gr;za&&za(s,null);let e=t.length;for(;e--;){let n=t[e];if(typeof n=="string"){const i=r(n);i!==n&&(Pl(t)||(t[e]=i),n=i)}s[n]=!0}return s}function zl(s){for(let t=0;t<s.length;t++)ut(s,t)||(s[t]=null);return s}function ft(s){const t=ua(null);for(const[r,e]of qc(s))ut(s,r)&&(Array.isArray(e)?t[r]=zl(e):e&&typeof e=="object"&&e.constructor===Object?t[r]=ft(e):t[r]=e);return t}function Xt(s,t){for(;s!==null;){const e=Hl(s,t);if(e){if(e.get)return et(e.get);if(typeof e.value=="function")return et(e.value)}s=Ul(s)}function r(){return null}return r}const Ya=Qe(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),dn=Qe(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),hn=Qe(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Vl=Qe(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),pn=Qe(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Yl=Qe(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ka=Qe(["#text"]),Za=Qe(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),mn=Qe(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Xa=Qe(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Br=Qe(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Kl=ct(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Zl=ct(/<%[\w\W]*|[\w\W]*%>/gm),Xl=ct(/\$\{[\w\W]*/gm),Jl=ct(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ql=ct(/^aria-[\-\w]+$/),$c=ct(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),eu=ct(/^(?:\w+script|data):/i),tu=ct(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Gc=ct(/^html$/i),ru=ct(/^[a-z][.\w]*(-[.\w]+)+$/i);var Ja=Object.freeze({__proto__:null,ARIA_ATTR:Ql,ATTR_WHITESPACE:tu,CUSTOM_ELEMENT:ru,DATA_ATTR:Jl,DOCTYPE_NAME:Gc,ERB_EXPR:Zl,IS_ALLOWED_URI:$c,IS_SCRIPT_OR_DATA:eu,MUSTACHE_EXPR:Kl,TMPLIT_EXPR:Xl});const Jt={element:1,text:3,progressingInstruction:7,comment:8,document:9},nu=function(){return typeof window>"u"?null:window},iu=function(t,r){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let e=null;const n="data-tt-policy-suffix";r&&r.hasAttribute(n)&&(e=r.getAttribute(n));const i="dompurify"+(e?"#"+e:"");try{return t.createPolicy(i,{createHTML(f){return f},createScriptURL(f){return f}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},Qa=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Wc(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:nu();const t=le=>Wc(le);if(t.version="3.3.1",t.removed=[],!s||!s.document||s.document.nodeType!==Jt.document||!s.Element)return t.isSupported=!1,t;let{document:r}=s;const e=r,n=e.currentScript,{DocumentFragment:i,HTMLTemplateElement:f,Node:a,Element:l,NodeFilter:c,NamedNodeMap:o=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:d,DOMParser:u,trustedTypes:h}=s,v=l.prototype,w=Xt(v,"cloneNode"),A=Xt(v,"remove"),_=Xt(v,"nextSibling"),E=Xt(v,"childNodes"),x=Xt(v,"parentNode");if(typeof f=="function"){const le=r.createElement("template");le.content&&le.content.ownerDocument&&(r=le.content.ownerDocument)}let g,S="";const{implementation:B,createNodeIterator:k,createDocumentFragment:D,getElementsByTagName:$}=r,{importNode:j}=e;let Q=Qa();t.isSupported=typeof qc=="function"&&typeof x=="function"&&B&&B.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:L,ERB_EXPR:ie,TMPLIT_EXPR:ue,DATA_ATTR:fe,ARIA_ATTR:he,IS_SCRIPT_OR_DATA:ve,ATTR_WHITESPACE:oe,CUSTOM_ELEMENT:be}=Ja;let{IS_ALLOWED_URI:ce}=Ja,pe=null;const _e=we({},[...Ya,...dn,...hn,...pn,...Ka]);let q=null;const z=we({},[...Za,...mn,...Xa,...Br]);let W=Object.seal(ua(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),N=null,U=null;const K=Object.seal(ua(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let ee=!0,te=!0,I=!1,M=!0,Y=!1,ne=!0,de=!1,ae=!1,me=!1,Le=!1,X=!1,He=!1,Ge=!0,Ae=!1;const Be="user-content-";let qe=!0,Oe=!1,We={},Pe=null;const Ue=we({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let lt=null;const T=we({},["audio","video","img","source","image","track"]);let p=null;const b=we({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),C="http://www.w3.org/1998/Math/MathML",P="http://www.w3.org/2000/svg",G="http://www.w3.org/1999/xhtml";let J=G,ye=!1,Se=null;const Ie=we({},[C,P,G],un);let Fe=we({},["mi","mo","mn","ms","mtext"]),Ee=we({},["annotation-xml"]);const Lt=we({},["title","style","font","a","script"]);let Ve=null;const Vt=["application/xhtml+xml","text/html"],rn="text/html";let Me=null,Ft=null;const F=r.createElement("form"),m=function(O){return O instanceof RegExp||O instanceof Function},y=function(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ft&&Ft===O)){if((!O||typeof O!="object")&&(O={}),O=ft(O),Ve=Vt.indexOf(O.PARSER_MEDIA_TYPE)===-1?rn:O.PARSER_MEDIA_TYPE,Me=Ve==="application/xhtml+xml"?un:Gr,pe=ut(O,"ALLOWED_TAGS")?we({},O.ALLOWED_TAGS,Me):_e,q=ut(O,"ALLOWED_ATTR")?we({},O.ALLOWED_ATTR,Me):z,Se=ut(O,"ALLOWED_NAMESPACES")?we({},O.ALLOWED_NAMESPACES,un):Ie,p=ut(O,"ADD_URI_SAFE_ATTR")?we(ft(b),O.ADD_URI_SAFE_ATTR,Me):b,lt=ut(O,"ADD_DATA_URI_TAGS")?we(ft(T),O.ADD_DATA_URI_TAGS,Me):T,Pe=ut(O,"FORBID_CONTENTS")?we({},O.FORBID_CONTENTS,Me):Ue,N=ut(O,"FORBID_TAGS")?we({},O.FORBID_TAGS,Me):ft({}),U=ut(O,"FORBID_ATTR")?we({},O.FORBID_ATTR,Me):ft({}),We=ut(O,"USE_PROFILES")?O.USE_PROFILES:!1,ee=O.ALLOW_ARIA_ATTR!==!1,te=O.ALLOW_DATA_ATTR!==!1,I=O.ALLOW_UNKNOWN_PROTOCOLS||!1,M=O.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Y=O.SAFE_FOR_TEMPLATES||!1,ne=O.SAFE_FOR_XML!==!1,de=O.WHOLE_DOCUMENT||!1,Le=O.RETURN_DOM||!1,X=O.RETURN_DOM_FRAGMENT||!1,He=O.RETURN_TRUSTED_TYPE||!1,me=O.FORCE_BODY||!1,Ge=O.SANITIZE_DOM!==!1,Ae=O.SANITIZE_NAMED_PROPS||!1,qe=O.KEEP_CONTENT!==!1,Oe=O.IN_PLACE||!1,ce=O.ALLOWED_URI_REGEXP||$c,J=O.NAMESPACE||G,Fe=O.MATHML_TEXT_INTEGRATION_POINTS||Fe,Ee=O.HTML_INTEGRATION_POINTS||Ee,W=O.CUSTOM_ELEMENT_HANDLING||{},O.CUSTOM_ELEMENT_HANDLING&&m(O.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=O.CUSTOM_ELEMENT_HANDLING.tagNameCheck),O.CUSTOM_ELEMENT_HANDLING&&m(O.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=O.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),O.CUSTOM_ELEMENT_HANDLING&&typeof O.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(W.allowCustomizedBuiltInElements=O.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Y&&(te=!1),X&&(Le=!0),We&&(pe=we({},Ka),q=[],We.html===!0&&(we(pe,Ya),we(q,Za)),We.svg===!0&&(we(pe,dn),we(q,mn),we(q,Br)),We.svgFilters===!0&&(we(pe,hn),we(q,mn),we(q,Br)),We.mathMl===!0&&(we(pe,pn),we(q,Xa),we(q,Br))),O.ADD_TAGS&&(typeof O.ADD_TAGS=="function"?K.tagCheck=O.ADD_TAGS:(pe===_e&&(pe=ft(pe)),we(pe,O.ADD_TAGS,Me))),O.ADD_ATTR&&(typeof O.ADD_ATTR=="function"?K.attributeCheck=O.ADD_ATTR:(q===z&&(q=ft(q)),we(q,O.ADD_ATTR,Me))),O.ADD_URI_SAFE_ATTR&&we(p,O.ADD_URI_SAFE_ATTR,Me),O.FORBID_CONTENTS&&(Pe===Ue&&(Pe=ft(Pe)),we(Pe,O.FORBID_CONTENTS,Me)),O.ADD_FORBID_CONTENTS&&(Pe===Ue&&(Pe=ft(Pe)),we(Pe,O.ADD_FORBID_CONTENTS,Me)),qe&&(pe["#text"]=!0),de&&we(pe,["html","head","body"]),pe.table&&(we(pe,["tbody"]),delete N.tbody),O.TRUSTED_TYPES_POLICY){if(typeof O.TRUSTED_TYPES_POLICY.createHTML!="function")throw Zt('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof O.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Zt('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');g=O.TRUSTED_TYPES_POLICY,S=g.createHTML("")}else g===void 0&&(g=iu(h,n)),g!==null&&typeof S=="string"&&(S=g.createHTML(""));Qe&&Qe(O),Ft=O}},R=we({},[...dn,...hn,...Vl]),H=we({},[...pn,...Yl]),V=function(O){let re=x(O);(!re||!re.tagName)&&(re={namespaceURI:J,tagName:"template"});const se=Gr(O.tagName),De=Gr(re.tagName);return Se[O.namespaceURI]?O.namespaceURI===P?re.namespaceURI===G?se==="svg":re.namespaceURI===C?se==="svg"&&(De==="annotation-xml"||Fe[De]):!!R[se]:O.namespaceURI===C?re.namespaceURI===G?se==="math":re.namespaceURI===P?se==="math"&&Ee[De]:!!H[se]:O.namespaceURI===G?re.namespaceURI===P&&!Ee[De]||re.namespaceURI===C&&!Fe[De]?!1:!H[se]&&(Lt[se]||!R[se]):!!(Ve==="application/xhtml+xml"&&Se[O.namespaceURI]):!1},Z=function(O){Yt(t.removed,{element:O});try{x(O).removeChild(O)}catch{A(O)}},ge=function(O,re){try{Yt(t.removed,{attribute:re.getAttributeNode(O),from:re})}catch{Yt(t.removed,{attribute:null,from:re})}if(re.removeAttribute(O),O==="is")if(Le||X)try{Z(re)}catch{}else try{re.setAttribute(O,"")}catch{}},ke=function(O){let re=null,se=null;if(me)O="<remove></remove>"+O;else{const $e=fn(O,/^[\r\n\t ]+/);se=$e&&$e[0]}Ve==="application/xhtml+xml"&&J===G&&(O='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+O+"</body></html>");const De=g?g.createHTML(O):O;if(J===G)try{re=new u().parseFromString(De,Ve)}catch{}if(!re||!re.documentElement){re=B.createDocument(J,"template",null);try{re.documentElement.innerHTML=ye?S:De}catch{}}const Ye=re.body||re.documentElement;return O&&se&&Ye.insertBefore(r.createTextNode(se),Ye.childNodes[0]||null),J===G?$.call(re,de?"html":"body")[0]:de?re.documentElement:Ye},Ce=function(O){return k.call(O.ownerDocument||O,O,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Re=function(O){return O instanceof d&&(typeof O.nodeName!="string"||typeof O.textContent!="string"||typeof O.removeChild!="function"||!(O.attributes instanceof o)||typeof O.removeAttribute!="function"||typeof O.setAttribute!="function"||typeof O.namespaceURI!="string"||typeof O.insertBefore!="function"||typeof O.hasChildNodes!="function")},Te=function(O){return typeof a=="function"&&O instanceof a};function bt(le,O,re){Fr(le,se=>{se.call(t,O,re,Ft)})}const Ra=function(O){let re=null;if(bt(Q.beforeSanitizeElements,O,null),Re(O))return Z(O),!0;const se=Me(O.nodeName);if(bt(Q.uponSanitizeElement,O,{tagName:se,allowedTags:pe}),ne&&O.hasChildNodes()&&!Te(O.firstElementChild)&&Xe(/<[/\w!]/g,O.innerHTML)&&Xe(/<[/\w!]/g,O.textContent)||O.nodeType===Jt.progressingInstruction||ne&&O.nodeType===Jt.comment&&Xe(/<[/\w]/g,O.data))return Z(O),!0;if(!(K.tagCheck instanceof Function&&K.tagCheck(se))&&(!pe[se]||N[se])){if(!N[se]&&Da(se)&&(W.tagNameCheck instanceof RegExp&&Xe(W.tagNameCheck,se)||W.tagNameCheck instanceof Function&&W.tagNameCheck(se)))return!1;if(qe&&!Pe[se]){const De=x(O)||O.parentNode,Ye=E(O)||O.childNodes;if(Ye&&De){const $e=Ye.length;for(let tt=$e-1;tt>=0;--tt){const yt=w(Ye[tt],!0);yt.__removalCount=(O.__removalCount||0)+1,De.insertBefore(yt,_(O))}}}return Z(O),!0}return O instanceof l&&!V(O)||(se==="noscript"||se==="noembed"||se==="noframes")&&Xe(/<\/no(script|embed|frames)/i,O.innerHTML)?(Z(O),!0):(Y&&O.nodeType===Jt.text&&(re=O.textContent,Fr([L,ie,ue],De=>{re=Kt(re,De," ")}),O.textContent!==re&&(Yt(t.removed,{element:O.cloneNode()}),O.textContent=re)),bt(Q.afterSanitizeElements,O,null),!1)},ka=function(O,re,se){if(Ge&&(re==="id"||re==="name")&&(se in r||se in F))return!1;if(!(te&&!U[re]&&Xe(fe,re))){if(!(ee&&Xe(he,re))){if(!(K.attributeCheck instanceof Function&&K.attributeCheck(re,O))){if(!q[re]||U[re]){if(!(Da(O)&&(W.tagNameCheck instanceof RegExp&&Xe(W.tagNameCheck,O)||W.tagNameCheck instanceof Function&&W.tagNameCheck(O))&&(W.attributeNameCheck instanceof RegExp&&Xe(W.attributeNameCheck,re)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(re,O))||re==="is"&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&Xe(W.tagNameCheck,se)||W.tagNameCheck instanceof Function&&W.tagNameCheck(se))))return!1}else if(!p[re]){if(!Xe(ce,Kt(se,oe,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&O!=="script"&&$l(se,"data:")===0&&lt[O])){if(!(I&&!Xe(ve,Kt(se,oe,"")))){if(se)return!1}}}}}}}return!0},Da=function(O){return O!=="annotation-xml"&&fn(O,be)},La=function(O){bt(Q.beforeSanitizeAttributes,O,null);const{attributes:re}=O;if(!re||Re(O))return;const se={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:q,forceKeepAttr:void 0};let De=re.length;for(;De--;){const Ye=re[De],{name:$e,namespaceURI:tt,value:yt}=Ye,Ot=Me($e),nn=yt;let ze=$e==="value"?nn:Gl(nn);if(se.attrName=Ot,se.attrValue=ze,se.keepAttr=!0,se.forceKeepAttr=void 0,bt(Q.uponSanitizeAttribute,O,se),ze=se.attrValue,Ae&&(Ot==="id"||Ot==="name")&&(ge($e,O),ze=Be+ze),ne&&Xe(/((--!?|])>)|<\/(style|title|textarea)/i,ze)){ge($e,O);continue}if(Ot==="attributename"&&fn(ze,"href")){ge($e,O);continue}if(se.forceKeepAttr)continue;if(!se.keepAttr){ge($e,O);continue}if(!M&&Xe(/\/>/i,ze)){ge($e,O);continue}Y&&Fr([L,ie,ue],Na=>{ze=Kt(ze,Na," ")});const Oa=Me(O.nodeName);if(!ka(Oa,Ot,ze)){ge($e,O);continue}if(g&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!tt)switch(h.getAttributeType(Oa,Ot)){case"TrustedHTML":{ze=g.createHTML(ze);break}case"TrustedScriptURL":{ze=g.createScriptURL(ze);break}}if(ze!==nn)try{tt?O.setAttributeNS(tt,$e,ze):O.setAttribute($e,ze),Re(O)?Z(O):Va(t.removed)}catch{ge($e,O)}}bt(Q.afterSanitizeAttributes,O,null)},_l=function le(O){let re=null;const se=Ce(O);for(bt(Q.beforeSanitizeShadowDOM,O,null);re=se.nextNode();)bt(Q.uponSanitizeShadowNode,re,null),Ra(re),La(re),re.content instanceof i&&le(re.content);bt(Q.afterSanitizeShadowDOM,O,null)};return t.sanitize=function(le){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=null,se=null,De=null,Ye=null;if(ye=!le,ye&&(le="<!-->"),typeof le!="string"&&!Te(le))if(typeof le.toString=="function"){if(le=le.toString(),typeof le!="string")throw Zt("dirty is not a string, aborting")}else throw Zt("toString is not a function");if(!t.isSupported)return le;if(ae||y(O),t.removed=[],typeof le=="string"&&(Oe=!1),Oe){if(le.nodeName){const yt=Me(le.nodeName);if(!pe[yt]||N[yt])throw Zt("root node is forbidden and cannot be sanitized in-place")}}else if(le instanceof a)re=ke("<!---->"),se=re.ownerDocument.importNode(le,!0),se.nodeType===Jt.element&&se.nodeName==="BODY"||se.nodeName==="HTML"?re=se:re.appendChild(se);else{if(!Le&&!Y&&!de&&le.indexOf("<")===-1)return g&&He?g.createHTML(le):le;if(re=ke(le),!re)return Le?null:He?S:""}re&&me&&Z(re.firstChild);const $e=Ce(Oe?le:re);for(;De=$e.nextNode();)Ra(De),La(De),De.content instanceof i&&_l(De.content);if(Oe)return le;if(Le){if(X)for(Ye=D.call(re.ownerDocument);re.firstChild;)Ye.appendChild(re.firstChild);else Ye=re;return(q.shadowroot||q.shadowrootmode)&&(Ye=j.call(e,Ye,!0)),Ye}let tt=de?re.outerHTML:re.innerHTML;return de&&pe["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&Xe(Gc,re.ownerDocument.doctype.name)&&(tt="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+tt),Y&&Fr([L,ie,ue],yt=>{tt=Kt(tt,yt," ")}),g&&He?g.createHTML(tt):tt},t.setConfig=function(){let le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};y(le),ae=!0},t.clearConfig=function(){Ft=null,ae=!1},t.isValidAttribute=function(le,O,re){Ft||y({});const se=Me(le),De=Me(O);return ka(se,De,re)},t.addHook=function(le,O){typeof O=="function"&&Yt(Q[le],O)},t.removeHook=function(le,O){if(O!==void 0){const re=jl(Q[le],O);return re===-1?void 0:ql(Q[le],re,1)[0]}return Va(Q[le])},t.removeHooks=function(le){Q[le]=[]},t.removeAllHooks=function(){Q=Qa()},t}var au=Wc();const su={ALLOWED_TAGS:["p","br","div","span","b","i","u","strong","em","mark","small","del","ins","sub","sup","h1","h2","h3","h4","h5","h6","ul","ol","li","dl","dt","dd","table","tr","td","th","thead","tbody","tfoot","caption","colgroup","col","a","img","blockquote","pre","code","hr","address","style","font","center"],ALLOWED_ATTR:["class","id","style","title","href","target","rel","src","alt","width","height","colspan","rowspan","cellpadding","cellspacing","border","align","valign","bgcolor","color","face","size"],ALLOW_DATA_ATTR:!1,FORBID_TAGS:["script","iframe","object","embed","form","input","button","select","textarea","applet","base","meta","link"],FORBID_ATTR:["onerror","onload","onclick","onmouseover","onmouseout","onfocus","onblur","onchange","onsubmit","onkeydown","onkeyup","onkeypress"],ALLOW_UNKNOWN_PROTOCOLS:!1,ADD_ATTR:["target"],WHOLE_DOCUMENT:!1,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1};function ou(s){return s?s.replace(/style="([^"]*)"/gi,(t,r)=>{const e=r.replace(/position\s*:\s*(absolute|fixed)[^;]*/gi,"").replace(/mso-position[^:]*:[^;]+;?/gi,"").replace(/;\s*;/g,";").replace(/^\s*;\s*/g,"").trim();return e?`style="${e}"`:""}):""}function cu(s){if(!s)return"";const t=ou(s);let r;try{r=au.sanitize(t,su)}catch(e){return console.error("Error sanitizing HTML:",e),lu(s)}return r}function lu(s){if(!s)return"";const t=document.createElement("div");return t.textContent=s,t.innerHTML}const uu={blue:{r:0,g:0,b:255},darkblue:{r:0,g:0,b:139},navy:{r:0,g:0,b:128},midnightblue:{r:25,g:25,b:112},darkgreen:{r:0,g:100,b:0},darkred:{r:139,g:0,b:0},maroon:{r:128,g:0,b:0},purple:{r:128,g:0,b:128},indigo:{r:75,g:0,b:130},black:{r:0,g:0,b:0},dimgray:{r:105,g:105,b:105},gray:{r:128,g:128,b:128}};function es(s){if(!s||s==="transparent"||s==="inherit")return null;const t=s.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/i);if(t)return{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3])};const r=s.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);if(r)return{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16)};const e=s.match(/^#?([a-f\d])([a-f\d])([a-f\d])$/i);if(e)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16)};const n=s.toLowerCase().trim();return uu[n]||null}function ha(s){const[t,r,e]=[s.r/255,s.g/255,s.b/255],[n,i,f]=[t,r,e].map(a=>a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4));return .2126*n+.7152*i+.0722*f}function fu(s,t){const r=ha(s),e=ha(t),n=Math.max(r,e),i=Math.min(r,e);return(n+.05)/(i+.05)}function du(s,t){if(ha(t)<.5){const n=Math.min(255,Math.max(100,s.r*2.5)),i=Math.min(255,Math.max(100,s.g*2.5)),f=Math.min(255,Math.max(100,s.b*2.5));return`rgb(${Math.round(n)}, ${Math.round(i)}, ${Math.round(f)})`}return`rgb(${s.r}, ${s.g}, ${s.b})`}class hu{constructor(t,r,e){this.container=t,this.messageHandler=r,this.attachmentModal=e}render(t){if(!this.container)return;this.messageHandler.setCurrentMessage(t);const r=this.formatRecipients(t.recipients,"to"),e=this.formatRecipients(t.recipients,"cc"),n=this.processEmailContent(t),i=this.messageHandler.getMessages().indexOf(t),f=this.messageHandler.isPinned(t),a=`
            <div class="message-header">
                <div class="message-title pl-6">${t.subject}</div>
                <div class="message-actions pr-4">
                    <button data-action="pin" data-index="${i}" class="action-button rounded-full ${f?"pinned":""}" title="bookmark message">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z" />
                        </svg>
                    </button>
                    <button data-action="download-eml" data-index="${i}" class="action-button rounded-full" title="download as .eml">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
                        </svg>
                    </button>
                    <button data-action="delete" data-index="${i}" class="action-button rounded-full" title="remove message">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                        </svg>
                    </button>
                </div>
            </div>
            <div class="message-card">
                <div class="mb-4">
                    <div class="message-meta"><strong>From:</strong> ${t.senderName} &lt;${t.senderEmail}&gt;</div>
                    ${r?`<div class="message-meta"><strong>To:</strong> ${r}</div>`:""}
                    ${e?`<div class="message-meta"><strong>CC:</strong> ${e}</div>`:""}
                    <div class="message-timestamp">${t.timestamp.toLocaleString()}</div>
                </div>
                <div class="prose max-w-none">
                    <div class="email-content" style="position: relative; isolation: isolate;">
                        ${n}
                    </div>
                </div>
                ${this.renderAttachments(t)}
            </div>
        `;this.container.innerHTML=a,this.fixLowContrastColors()}fixLowContrastColors(){const t=this.container.querySelector(".email-content");if(!t)return;const r=document.documentElement.classList.contains("dark"),e=document.documentElement.dataset.emailTheme;if(!(e==="dark"||e!=="light"&&r))return;const i=es(getComputedStyle(t).backgroundColor)||{r:30,g:41,b:59};t.querySelectorAll('[style*="color"]').forEach(a=>{const l=a.getAttribute("style");if(!l)return;const c=l.match(/(?:^|;)\s*color\s*:\s*([^;]+)/i);if(!c)return;const o=c[1].trim(),d=es(o);if(!d)return;if(fu(d,i)<3){const h=du(d,i),v=l.replace(/(?:^|;)(\s*color\s*:\s*)([^;]+)/i,`$1${h}`);a.setAttribute("style",v)}})}formatRecipients(t,r){return t.filter(e=>e.recipType===r).map(e=>{const n=e.smtpAddress||e.email||"";return`${e.name} &lt;${n}&gt;`}).join(", ")}scopeEmailStyles(t){if(!t)return"";const r=document.createElement("div");r.innerHTML=t;const e=r.getElementsByTagName("style");return Array.from(e).forEach(n=>{const f=n.textContent.replace(/([^{}]+){/g,".email-content $1{");n.textContent=f}),r.innerHTML}processEmailContent(t){let r=t.bodyContentHTML||t.bodyContent;return!t.bodyContentHTML&&r&&(r="<p>"+r.replace(/\r\n/g,`
`).split(/\n{2,}/).map(i=>i.replace(/\n/g,"<br>")).join("</p><p>")+"</p>"),r=this.scopeEmailStyles(r),cu(r)}renderAttachments(t){return t.attachments?.length?(this.attachmentModal&&this.attachmentModal.setAttachments(t.attachments),`
            <div class="mt-6">
                <hr class="attachments-divider border-t mb-4">
                <div class="flex items-center gap-2 mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 attachment-icon">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13" />
                    </svg>
                    <span class="attachment-label">${t.attachments.length} ${t.attachments.length===1?"Attachment":"Attachments"}</span>
                </div>
                <div class="flex flex-wrap gap-4">
                    ${t.attachments.map((r,e)=>{const n=this.attachmentModal?.isPreviewable(r.attachMimeTag),i=this.attachmentModal?.isPreviewableImage(r.attachMimeTag),f=this.attachmentModal?.isPdf(r.attachMimeTag),a=this.attachmentModal?.isText(r.attachMimeTag),l=this.attachmentModal?.isPreviewableEml(r.attachMimeTag),c=()=>i?`<img src="${r.contentBase64}" alt="Attachment" class="w-10 h-10 object-cover">`:f?`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-red-500">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                                </svg>`:a?`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 attachment-icon">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                                </svg>`:l?`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-blue-500">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />
                                </svg>`:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 attachment-icon">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                            </svg>`;return n?`
                                <div class="cursor-pointer min-w-[250px] max-w-fit"
                                     data-action="preview"
                                     data-attachment-index="${e}"
                                     title="Click to preview">
                                    <div class="attachment-item flex items-center space-x-2">
                                        <div class="attachment-thumbnail w-10 h-10 shrink-0 flex items-center justify-center overflow-hidden">
                                            ${c()}
                                        </div>
                                        <div>
                                            <p class="attachment-filename">${r.fileName}</p>
                                            <p class="attachment-meta">${r.attachMimeTag} - ${r.contentLength} bytes</p>
                                        </div>
                                        <button data-action="download"
                                                data-attachment-index="${e}"
                                                class="ml-auto pl-2 attachment-download-btn"
                                                title="Download">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            `:`
                                <div class="cursor-pointer min-w-[250px] max-w-fit"
                                     data-action="download"
                                     data-attachment-index="${e}"
                                     title="Click to download">
                                    <div class="attachment-item flex items-center space-x-2">
                                        <div class="attachment-thumbnail w-10 h-10 shrink-0 flex items-center justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 attachment-icon">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                                            </svg>
                                        </div>
                                        <div>
                                            <p class="attachment-filename">${r.fileName}</p>
                                            <p class="attachment-meta">${r.attachMimeTag} - ${r.contentLength} bytes</p>
                                        </div>
                                        <div class="ml-auto pl-2 attachment-download-btn">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                            `}).join("")}
                </div>
            </div>
        `):""}}const pu="modulepreload",mu=function(s){return"/msg-reader/"+s},ts={},Bt=function(t,r,e){let n=Promise.resolve();if(r&&r.length>0){let c=function(o){return Promise.all(o.map(d=>Promise.resolve(d).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};var f=c;document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");n=c(r.map(o=>{if(o=mu(o),o in ts)return;ts[o]=!0;const d=o.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":pu,d||(h.as="script"),h.crossOrigin="",h.href=o,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((v,w)=>{h.addEventListener("load",v),h.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${o}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return n.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};function it(){return typeof window<"u"&&window.__TAURI_INTERNALS__!==void 0}let Ir=null;async function wa(){if(!it())return null;if(Ir)return Ir;const[{invoke:s},{listen:t}]=await Promise.all([Bt(()=>import("./core-DhEqZVGG.js"),[]),Bt(()=>import("./event-CnyWr2tN.js"),__vite__mapDeps([0,1]))]);return Ir={invoke:s,listen:t},Ir}async function rs(s){const t=await wa();if(!t)throw new Error("Tauri API not available");const r=await t.invoke("read_file_as_bytes",{path:s});return new Uint8Array(r).buffer}async function gu(){const s=await wa();return s?await s.invoke("get_pending_files"):[]}async function bu(s){const t=await wa();return t?await t.listen("file-open",r=>{r.payload&&s(r.payload)}):()=>{}}function gn(s){const t=s.split(/[/\\]/);return t[t.length-1]}async function yu(s,t){if(!it())throw new Error("openWithSystemViewer is only available in Tauri");const{invoke:r}=await Bt(async()=>{const{invoke:n}=await import("./core-DhEqZVGG.js");return{invoke:n}},[]),e=s.split(",")[1];await r("open_file_with_system",{base64Content:e,fileName:t})}async function pa(s,t){if(!it())throw new Error("saveFileWithDialog is only available in Tauri");const{invoke:r}=await Bt(async()=>{const{invoke:n}=await import("./core-DhEqZVGG.js");return{invoke:n}},[]),e=s.split(",")[1];return await r("save_file_with_dialog",{base64Content:e,fileName:t})}async function vu(){if(it())try{const{check:s}=await Bt(async()=>{const{check:e}=await import("./index-CV5cDhyM.js");return{check:e}},__vite__mapDeps([2,1])),{ask:t}=await Bt(async()=>{const{ask:e}=await import("./index-COqiF0ln.js");return{ask:e}},__vite__mapDeps([3,1])),r=await s();if(r&&await t(`Version ${r.version} is available!

Would you like to update now?`,{title:"Update available",kind:"info",okLabel:"Update",cancelLabel:"Later"})){await r.downloadAndInstall();const{relaunch:n}=await Bt(async()=>{const{relaunch:i}=await import("./index-DWAWkcyj.js");return{relaunch:i}},__vite__mapDeps([4,1]));await n()}}catch(s){console.error("Update check failed:",s)}}async function wu(s){if(!it())return()=>{};const{getCurrentWebviewWindow:t}=await Bt(async()=>{const{getCurrentWebviewWindow:e}=await import("./webviewWindow-Dwy5goXe.js");return{getCurrentWebviewWindow:e}},__vite__mapDeps([5,1,0]));return await t().onDragDropEvent(e=>{switch(e.payload.type){case"enter":case"over":s.onEnter&&s.onEnter();break;case"leave":s.onLeave&&s.onLeave();break;case"drop":{s.onLeave&&s.onLeave();const n=e.payload.paths;n&&n.length>0&&s.onDrop&&s.onDrop(n);break}}})}var vt={},Qt={},Mr={},rt={},ns;function xr(){if(ns)return rt;ns=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.arraysEqual=s,rt.uInt2int=t,rt.toHexStr=r,rt.toHex1=n,rt.toHex2=i,rt.toHex4=f,rt.msftUuidStringify=a,rt.emptyToNull=l,rt.readSystemTime=o,rt.readTransitionSystemTime=d,rt.bin2HexUpper=u;function s(h,v){if(h===v)return!0;if(h==null||v==null||h.length!=v.length)return!1;for(var w=0;w<h.length;w++)if(h[w]!==v[w])return!1;return!0}function t(h){for(var v=new Array(h.length),w=0;w<h.length;w++)v[w]=h[w]<<24>>24;return v}function r(h,v){for(var w="";h!=0;)w="0123456789abcdef"[h&15]+w,h>>=4,w="0123456789abcdef"[h&15]+w,h>>=4;for(;w.length<v;)w="0"+w;return w}var e="0123456789abcdef";function n(h){return e[h>>4&15]+e[h&15]}function i(h){return e[h>>12&15]+e[h>>8&15]+e[h>>4&15]+e[h&15]}function f(h){return e[h>>28&15]+e[h>>24&15]+e[h>>20&15]+e[h>>16&15]+e[h>>12&15]+e[h>>8&15]+e[h>>4&15]+e[h&15]}function a(h,v){return""+n(h[v+3])+n(h[v+2])+n(h[v+1])+n(h[v+0])+"-"+n(h[v+5])+n(h[v+4])+"-"+n(h[v+7])+n(h[v+6])+"-"+n(h[v+8])+n(h[v+9])+"-"+n(h[v+10])+n(h[v+11])+n(h[v+12])+n(h[v+13])+n(h[v+14])+n(h[v+15])}function l(h){return h===""?null:h}function c(h,v){return(""+h).padStart(v,"0")}function o(h){var v=h.readUint16(),w=h.readUint16();h.readUint16();var A=h.readUint16(),_=h.readUint16(),E=h.readUint16(),x=h.readUint16();h.readUint16();var g="".concat(c(v,4),"-").concat(c(w,2),"-").concat(c(A,2),"T").concat(c(_,2),":").concat(c(E,2),":").concat(c(x,2),"Z");return g==="0000-00-00T00:00:00Z"?null:new Date(g)}function d(h){var v=h.readUint16(),w=h.readUint16(),A=h.readUint16(),_=h.readUint16(),E=h.readUint16(),x=h.readUint16();return h.readUint16(),h.readUint16(),{year:v,month:w,dayOfWeek:A,day:_,hour:E,minute:x}}function u(h){for(var v="";!h.isEof();)v+=n(h.readUint8());return v.toUpperCase()}return rt}var is;function xa(){if(is)return Mr;is=1,Object.defineProperty(Mr,"__esModule",{value:!0});var s=xr();return Mr.default={FILE_HEADER:(0,s.uInt2int)([208,207,17,224,161,177,26,225]),MSG:{UNUSED_BLOCK:-1,END_OF_CHAIN:-2,S_BIG_BLOCK_SIZE:512,S_BIG_BLOCK_MARK:9,L_BIG_BLOCK_SIZE:4096,L_BIG_BLOCK_MARK:12,SMALL_BLOCK_SIZE:64,BIG_BLOCK_MIN_DOC_SIZE:4096,HEADER:{PROPERTY_START_OFFSET:48,BAT_START_OFFSET:76,BAT_COUNT_OFFSET:44,SBAT_START_OFFSET:60,SBAT_COUNT_OFFSET:64,XBAT_START_OFFSET:68,XBAT_COUNT_OFFSET:72},PROP:{NO_INDEX:-1,PROPERTY_SIZE:128,NAME_SIZE_OFFSET:64,MAX_NAME_LENGTH:64/2-1,TYPE_OFFSET:66,PREVIOUS_PROPERTY_OFFSET:68,NEXT_PROPERTY_OFFSET:72,CHILD_PROPERTY_OFFSET:76,START_BLOCK_OFFSET:116,SIZE_OFFSET:120,TYPE_ENUM:{DIRECTORY:1,DOCUMENT:2,ROOT:5}},FIELD:{PREFIX:{ATTACHMENT:"__attach_version1.0",RECIPIENT:"__recip_version1.0",DOCUMENT:"__substg1.",NAMEID:"__nameid_version1.0"},NAME_MAPPING:{"001a":"messageClass","0037":"subject","0c1a":"senderName","0c1e":"senderAddressType","0c1f":"senderEmail","5d01":"senderSmtpAddress","5d02":"sentRepresentingSmtpAddress","5d0a":"creatorSMTPAddress","5d0b":"lastModifierSMTPAddress",1e3:"body","007d":"headers",1009:"compressedRtf","3ffa":"lastModifierName","0039":"clientSubmitTime","0e06":"messageDeliveryTime","3fde":"internetCodepage","3ffd":"messageCodepage","3ff1":"messageLocaleId","0e07":"messageFlags",1035:"messageId","3fd9":"preview",3007:"creationTime",3008:"lastModificationTime",3703:"extension",3704:"fileNameShort",3707:"fileName",3712:"pidContentId","7ffe":"attachmentHidden","370e":"attachMimeTag","0c15":"recipType",3001:"name",3002:"addressType",3003:"email","39fe":"smtpAddress","3a18":"departmentName","3a44":"middleName","3a05":"generation","3a11":"surname","3a27":"addressCity","3a16":"companyName","3a24":"businessFaxNumber","3a29":"streetAddress","3a51":"businessHomePage","3a06":"givenName","3a09":"homeTelephoneNumber","3a15":"postalAddress","3a17":"title","3a1c":"mobileTelephoneNumber","3a26":"country","3a28":"stateOrProvince","3a2a":"postalCode","3a45":"displayNamePrefix","0070":"conversationTopic","0e1d":"normalizedSubject","3a08":"businessTelephoneNumber","3a0d":"location"},FULL_NAME_MAPPING:{"1013001f":"bodyHtml",10130102:"html"},PIDLID_MAPPING:{"00062008-0000-0000-c000-000000000046":{34080:{id:"PidLidVerbStream"},34084:{id:"PidLidVerbResponse",dispid:"votingResponse"},34176:{id:"PidLidInternetAccountName",dispid:"inetAcctName"}},"00062002-0000-0000-c000-000000000046":{33293:{id:"PidLidAppointmentStartWhole",dispid:"apptStartWhole"},33294:{id:"PidLidAppointmentEndWhole",dispid:"apptEndWhole"},33333:{id:"PidLidClipStart",dispid:"clipStart"},33334:{id:"PidLidClipEnd",dispid:"clipEnd"},33331:{id:"PidLidTimeZoneStruct",dispid:"timeZoneStruct"},33332:{id:"PidLidTimeZoneDescription",dispid:"timeZoneDesc"},33374:{id:"PidLidAppointmentTimeZoneDefinitionStartDisplay",dispid:"apptTZDefStartDisplay"},33375:{id:"PidLidAppointmentTimeZoneDefinitionEndDisplay",dispid:"apptTZDefEndDisplay"},33376:{id:"PidLidAppointmentTimeZoneDefinitionRecur",dispid:"apptTZDefRecur"},33302:{id:"PidLidAppointmentRecur",dispid:"apptRecur"},33288:{id:"PidLidLocation",dispid:"apptLocation"}},"00062004-0000-0000-c000-000000000046":{32812:{id:"dispidYomiFirstName",dispid:"yomiFirstName"},32899:{id:"dispidEmail1EmailAddress",dispid:"email1EmailAddress"},32814:{id:"dispidYomiCompanyName",dispid:"yomiCompanyName"},32978:{id:"PidLidFax3AddressType",dispid:"fax3AddrType"},32896:{id:"PidLidEmail1DisplayName",dispid:"email1DisplayName"},32900:{id:"PidLidEmail1OriginalDisplayName",dispid:"email1OriginalDisplayName"},32773:{id:"PidLidFileUnder",dispid:"fileUnder"},32813:{id:"PidLidYomiLastName",dispid:"yomiLastName"},32946:{id:"PidLidFax1AddressType",dispid:"fax1AddrType"},32963:{id:"PidLidFax2EmailAddress",dispid:"fax2EmailAddress"},32838:{id:"PidLidWorkAddressCity",dispid:"workAddressCity"},32989:{id:"PidLidAddressCountryCode",dispid:"addressCountryCode"},32962:{id:"PidLidFax2AddressType",dispid:"fax2AddrType"},32964:{id:"PidLidFax2OriginalDisplayName",dispid:"fax2OriginalDisplayName"},32840:{id:"PidLidWorkAddressPostalCode",dispid:"workAddressPostalCode"},32837:{id:"PidLidWorkAddressStreet",dispid:"workAddressStreet"},32839:{id:"PidLidWorkAddressState",dispid:"workAddressState"},32987:{id:"PidLidWorkAddressCountryCode",dispid:"workAddressCountryCode"},32841:{id:"PidLidWorkAddressCountry",dispid:"workAddressCountry"},32811:{id:"PidLidHtml",dispid:"contactHtml"},32795:{id:"PidLidWorkAddress",dispid:"workAddress"},32948:{id:"PidLidFax1OriginalDisplayName",dispid:"fax1OriginalDisplayName"},32866:{id:"PidLidInstantMessagingAddress",dispid:"instMsg"},32784:{id:"PidLidDepartment",dispid:"department"},32947:{id:"PidLidFax1EmailAddress",dispid:"fax1EmailAddress"},32980:{id:"PidLidFax3OriginalDisplayName",dispid:"fax3OriginalDisplayName"},32979:{id:"PidLidFax3EmailAddress",dispid:"fax3EmailAddress"}},"6ed8da90-450b-101b-98da-00aa003f1305":{3:{id:"PidLidGlobalObjectId",dispid:"globalAppointmentID"},40:{id:"PidLidOldLocation",dispid:"apptOldLocation"}}},CLASS_MAPPING:{ATTACHMENT_DATA:"3701"},TYPE_MAPPING:{"001e":"string","001f":"unicode","0040":"time","0102":"binary","0003":"integer","000b":"boolean"},DIR_TYPE:{INNER_MSG:"000d"}}}},Mr}var Cr={},bn={exports:{}};function xu(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var zc={exports:{}},je=zc.exports={},ht,pt;function ma(){throw new Error("setTimeout has not been defined")}function ga(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?ht=setTimeout:ht=ma}catch{ht=ma}try{typeof clearTimeout=="function"?pt=clearTimeout:pt=ga}catch{pt=ga}})();function Vc(s){if(ht===setTimeout)return setTimeout(s,0);if((ht===ma||!ht)&&setTimeout)return ht=setTimeout,setTimeout(s,0);try{return ht(s,0)}catch{try{return ht.call(null,s,0)}catch{return ht.call(this,s,0)}}}function Eu(s){if(pt===clearTimeout)return clearTimeout(s);if((pt===ga||!pt)&&clearTimeout)return pt=clearTimeout,clearTimeout(s);try{return pt(s)}catch{try{return pt.call(null,s)}catch{return pt.call(this,s)}}}var At=[],$t=!1,Ct,Wr=-1;function _u(){!$t||!Ct||($t=!1,Ct.length?At=Ct.concat(At):Wr=-1,At.length&&Yc())}function Yc(){if(!$t){var s=Vc(_u);$t=!0;for(var t=At.length;t;){for(Ct=At,At=[];++Wr<t;)Ct&&Ct[Wr].run();Wr=-1,t=At.length}Ct=null,$t=!1,Eu(s)}}je.nextTick=function(s){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];At.push(new Kc(s,t)),At.length===1&&!$t&&Vc(Yc)};function Kc(s,t){this.fun=s,this.array=t}Kc.prototype.run=function(){this.fun.apply(null,this.array)};je.title="browser";je.browser=!0;je.env={};je.argv=[];je.version="";je.versions={};function Tt(){}je.on=Tt;je.addListener=Tt;je.once=Tt;je.off=Tt;je.removeListener=Tt;je.removeAllListeners=Tt;je.emit=Tt;je.prependListener=Tt;je.prependOnceListener=Tt;je.listeners=function(s){return[]};je.binding=function(s){throw new Error("process.binding is not supported")};je.cwd=function(){return"/"};je.chdir=function(s){throw new Error("process.chdir is not supported")};je.umask=function(){return 0};var Au=zc.exports;const xe=xu(Au);var yn={},as;function Er(){return as||(as=1,(function(s){Object.defineProperties(s,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},r={};r.byteLength=o,r.toByteArray=u,r.fromByteArray=w;for(var e=[],n=[],i=typeof Uint8Array<"u"?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=f.length;a<l;++a)e[a]=f[a],n[f.charCodeAt(a)]=a;n[45]=62,n[95]=63;function c(E){var x=E.length;if(x%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=E.indexOf("=");g===-1&&(g=x);var S=g===x?0:4-g%4;return[g,S]}function o(E){var x=c(E),g=x[0],S=x[1];return(g+S)*3/4-S}function d(E,x,g){return(x+g)*3/4-g}function u(E){var x,g=c(E),S=g[0],B=g[1],k=new i(d(E,S,B)),D=0,$=B>0?S-4:S,j;for(j=0;j<$;j+=4)x=n[E.charCodeAt(j)]<<18|n[E.charCodeAt(j+1)]<<12|n[E.charCodeAt(j+2)]<<6|n[E.charCodeAt(j+3)],k[D++]=x>>16&255,k[D++]=x>>8&255,k[D++]=x&255;return B===2&&(x=n[E.charCodeAt(j)]<<2|n[E.charCodeAt(j+1)]>>4,k[D++]=x&255),B===1&&(x=n[E.charCodeAt(j)]<<10|n[E.charCodeAt(j+1)]<<4|n[E.charCodeAt(j+2)]>>2,k[D++]=x>>8&255,k[D++]=x&255),k}function h(E){return e[E>>18&63]+e[E>>12&63]+e[E>>6&63]+e[E&63]}function v(E,x,g){for(var S,B=[],k=x;k<g;k+=3)S=(E[k]<<16&16711680)+(E[k+1]<<8&65280)+(E[k+2]&255),B.push(h(S));return B.join("")}function w(E){for(var x,g=E.length,S=g%3,B=[],k=16383,D=0,$=g-S;D<$;D+=k)B.push(v(E,D,D+k>$?$:D+k));return S===1?(x=E[g-1],B.push(e[x>>2]+e[x<<4&63]+"==")):S===2&&(x=(E[g-2]<<8)+E[g-1],B.push(e[x>>10]+e[x>>4&63]+e[x<<2&63]+"=")),B.join("")}var A={};A.read=function(E,x,g,S,B){var k,D,$=B*8-S-1,j=(1<<$)-1,Q=j>>1,L=-7,ie=g?B-1:0,ue=g?-1:1,fe=E[x+ie];for(ie+=ue,k=fe&(1<<-L)-1,fe>>=-L,L+=$;L>0;k=k*256+E[x+ie],ie+=ue,L-=8);for(D=k&(1<<-L)-1,k>>=-L,L+=S;L>0;D=D*256+E[x+ie],ie+=ue,L-=8);if(k===0)k=1-Q;else{if(k===j)return D?NaN:(fe?-1:1)*(1/0);D=D+Math.pow(2,S),k=k-Q}return(fe?-1:1)*D*Math.pow(2,k-S)},A.write=function(E,x,g,S,B,k){var D,$,j,Q=k*8-B-1,L=(1<<Q)-1,ie=L>>1,ue=B===23?Math.pow(2,-24)-Math.pow(2,-77):0,fe=S?0:k-1,he=S?1:-1,ve=x<0||x===0&&1/x<0?1:0;for(x=Math.abs(x),isNaN(x)||x===1/0?($=isNaN(x)?1:0,D=L):(D=Math.floor(Math.log(x)/Math.LN2),x*(j=Math.pow(2,-D))<1&&(D--,j*=2),D+ie>=1?x+=ue/j:x+=ue*Math.pow(2,1-ie),x*j>=2&&(D++,j/=2),D+ie>=L?($=0,D=L):D+ie>=1?($=(x*j-1)*Math.pow(2,B),D=D+ie):($=x*Math.pow(2,ie-1)*Math.pow(2,B),D=0));B>=8;E[g+fe]=$&255,fe+=he,$/=256,B-=8);for(D=D<<B|$,Q+=B;Q>0;E[g+fe]=D&255,fe+=he,D/=256,Q-=8);E[g+fe-he]|=ve*128};(function(E){const x=r,g=A,S=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;E.Buffer=L,E.SlowBuffer=q,E.INSPECT_MAX_BYTES=50;const B=2147483647;E.kMaxLength=B;const{Uint8Array:k,ArrayBuffer:D,SharedArrayBuffer:$}=globalThis;L.TYPED_ARRAY_SUPPORT=j(),!L.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function j(){try{const F=new k(1),m={foo:function(){return 42}};return Object.setPrototypeOf(m,k.prototype),Object.setPrototypeOf(F,m),F.foo()===42}catch{return!1}}Object.defineProperty(L.prototype,"parent",{enumerable:!0,get:function(){if(L.isBuffer(this))return this.buffer}}),Object.defineProperty(L.prototype,"offset",{enumerable:!0,get:function(){if(L.isBuffer(this))return this.byteOffset}});function Q(F){if(F>B)throw new RangeError('The value "'+F+'" is invalid for option "size"');const m=new k(F);return Object.setPrototypeOf(m,L.prototype),m}function L(F,m,y){if(typeof F=="number"){if(typeof m=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return he(F)}return ie(F,m,y)}L.poolSize=8192;function ie(F,m,y){if(typeof F=="string")return ve(F,m);if(D.isView(F))return be(F);if(F==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof F);if(Ve(F,D)||F&&Ve(F.buffer,D)||typeof $<"u"&&(Ve(F,$)||F&&Ve(F.buffer,$)))return ce(F,m,y);if(typeof F=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const R=F.valueOf&&F.valueOf();if(R!=null&&R!==F)return L.from(R,m,y);const H=pe(F);if(H)return H;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof F[Symbol.toPrimitive]=="function")return L.from(F[Symbol.toPrimitive]("string"),m,y);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof F)}L.from=function(F,m,y){return ie(F,m,y)},Object.setPrototypeOf(L.prototype,k.prototype),Object.setPrototypeOf(L,k);function ue(F){if(typeof F!="number")throw new TypeError('"size" argument must be of type number');if(F<0)throw new RangeError('The value "'+F+'" is invalid for option "size"')}function fe(F,m,y){return ue(F),F<=0?Q(F):m!==void 0?typeof y=="string"?Q(F).fill(m,y):Q(F).fill(m):Q(F)}L.alloc=function(F,m,y){return fe(F,m,y)};function he(F){return ue(F),Q(F<0?0:_e(F)|0)}L.allocUnsafe=function(F){return he(F)},L.allocUnsafeSlow=function(F){return he(F)};function ve(F,m){if((typeof m!="string"||m==="")&&(m="utf8"),!L.isEncoding(m))throw new TypeError("Unknown encoding: "+m);const y=z(F,m)|0;let R=Q(y);const H=R.write(F,m);return H!==y&&(R=R.slice(0,H)),R}function oe(F){const m=F.length<0?0:_e(F.length)|0,y=Q(m);for(let R=0;R<m;R+=1)y[R]=F[R]&255;return y}function be(F){if(Ve(F,k)){const m=new k(F);return ce(m.buffer,m.byteOffset,m.byteLength)}return oe(F)}function ce(F,m,y){if(m<0||F.byteLength<m)throw new RangeError('"offset" is outside of buffer bounds');if(F.byteLength<m+(y||0))throw new RangeError('"length" is outside of buffer bounds');let R;return m===void 0&&y===void 0?R=new k(F):y===void 0?R=new k(F,m):R=new k(F,m,y),Object.setPrototypeOf(R,L.prototype),R}function pe(F){if(L.isBuffer(F)){const m=_e(F.length)|0,y=Q(m);return y.length===0||F.copy(y,0,0,m),y}if(F.length!==void 0)return typeof F.length!="number"||Vt(F.length)?Q(0):oe(F);if(F.type==="Buffer"&&Array.isArray(F.data))return oe(F.data)}function _e(F){if(F>=B)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+B.toString(16)+" bytes");return F|0}function q(F){return+F!=F&&(F=0),L.alloc(+F)}L.isBuffer=function(m){return m!=null&&m._isBuffer===!0&&m!==L.prototype},L.compare=function(m,y){if(Ve(m,k)&&(m=L.from(m,m.offset,m.byteLength)),Ve(y,k)&&(y=L.from(y,y.offset,y.byteLength)),!L.isBuffer(m)||!L.isBuffer(y))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(m===y)return 0;let R=m.length,H=y.length;for(let V=0,Z=Math.min(R,H);V<Z;++V)if(m[V]!==y[V]){R=m[V],H=y[V];break}return R<H?-1:H<R?1:0},L.isEncoding=function(m){switch(String(m).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},L.concat=function(m,y){if(!Array.isArray(m))throw new TypeError('"list" argument must be an Array of Buffers');if(m.length===0)return L.alloc(0);let R;if(y===void 0)for(y=0,R=0;R<m.length;++R)y+=m[R].length;const H=L.allocUnsafe(y);let V=0;for(R=0;R<m.length;++R){let Z=m[R];if(Ve(Z,k))V+Z.length>H.length?(L.isBuffer(Z)||(Z=L.from(Z)),Z.copy(H,V)):k.prototype.set.call(H,Z,V);else if(L.isBuffer(Z))Z.copy(H,V);else throw new TypeError('"list" argument must be an Array of Buffers');V+=Z.length}return H};function z(F,m){if(L.isBuffer(F))return F.length;if(D.isView(F)||Ve(F,D))return F.byteLength;if(typeof F!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof F);const y=F.length,R=arguments.length>2&&arguments[2]===!0;if(!R&&y===0)return 0;let H=!1;for(;;)switch(m){case"ascii":case"latin1":case"binary":return y;case"utf8":case"utf-8":return Se(F).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y*2;case"hex":return y>>>1;case"base64":return Ee(F).length;default:if(H)return R?-1:Se(F).length;m=(""+m).toLowerCase(),H=!0}}L.byteLength=z;function W(F,m,y){let R=!1;if((m===void 0||m<0)&&(m=0),m>this.length||((y===void 0||y>this.length)&&(y=this.length),y<=0)||(y>>>=0,m>>>=0,y<=m))return"";for(F||(F="utf8");;)switch(F){case"hex":return He(this,m,y);case"utf8":case"utf-8":return de(this,m,y);case"ascii":return Le(this,m,y);case"latin1":case"binary":return X(this,m,y);case"base64":return ne(this,m,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ge(this,m,y);default:if(R)throw new TypeError("Unknown encoding: "+F);F=(F+"").toLowerCase(),R=!0}}L.prototype._isBuffer=!0;function N(F,m,y){const R=F[m];F[m]=F[y],F[y]=R}L.prototype.swap16=function(){const m=this.length;if(m%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let y=0;y<m;y+=2)N(this,y,y+1);return this},L.prototype.swap32=function(){const m=this.length;if(m%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let y=0;y<m;y+=4)N(this,y,y+3),N(this,y+1,y+2);return this},L.prototype.swap64=function(){const m=this.length;if(m%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let y=0;y<m;y+=8)N(this,y,y+7),N(this,y+1,y+6),N(this,y+2,y+5),N(this,y+3,y+4);return this},L.prototype.toString=function(){const m=this.length;return m===0?"":arguments.length===0?de(this,0,m):W.apply(this,arguments)},L.prototype.toLocaleString=L.prototype.toString,L.prototype.equals=function(m){if(!L.isBuffer(m))throw new TypeError("Argument must be a Buffer");return this===m?!0:L.compare(this,m)===0},L.prototype.inspect=function(){let m="";const y=E.INSPECT_MAX_BYTES;return m=this.toString("hex",0,y).replace(/(.{2})/g,"$1 ").trim(),this.length>y&&(m+=" ... "),"<Buffer "+m+">"},S&&(L.prototype[S]=L.prototype.inspect),L.prototype.compare=function(m,y,R,H,V){if(Ve(m,k)&&(m=L.from(m,m.offset,m.byteLength)),!L.isBuffer(m))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof m);if(y===void 0&&(y=0),R===void 0&&(R=m?m.length:0),H===void 0&&(H=0),V===void 0&&(V=this.length),y<0||R>m.length||H<0||V>this.length)throw new RangeError("out of range index");if(H>=V&&y>=R)return 0;if(H>=V)return-1;if(y>=R)return 1;if(y>>>=0,R>>>=0,H>>>=0,V>>>=0,this===m)return 0;let Z=V-H,ge=R-y;const ke=Math.min(Z,ge),Ce=this.slice(H,V),Re=m.slice(y,R);for(let Te=0;Te<ke;++Te)if(Ce[Te]!==Re[Te]){Z=Ce[Te],ge=Re[Te];break}return Z<ge?-1:ge<Z?1:0};function U(F,m,y,R,H){if(F.length===0)return-1;if(typeof y=="string"?(R=y,y=0):y>2147483647?y=2147483647:y<-2147483648&&(y=-2147483648),y=+y,Vt(y)&&(y=H?0:F.length-1),y<0&&(y=F.length+y),y>=F.length){if(H)return-1;y=F.length-1}else if(y<0)if(H)y=0;else return-1;if(typeof m=="string"&&(m=L.from(m,R)),L.isBuffer(m))return m.length===0?-1:K(F,m,y,R,H);if(typeof m=="number")return m=m&255,typeof k.prototype.indexOf=="function"?H?k.prototype.indexOf.call(F,m,y):k.prototype.lastIndexOf.call(F,m,y):K(F,[m],y,R,H);throw new TypeError("val must be string, number or Buffer")}function K(F,m,y,R,H){let V=1,Z=F.length,ge=m.length;if(R!==void 0&&(R=String(R).toLowerCase(),R==="ucs2"||R==="ucs-2"||R==="utf16le"||R==="utf-16le")){if(F.length<2||m.length<2)return-1;V=2,Z/=2,ge/=2,y/=2}function ke(Re,Te){return V===1?Re[Te]:Re.readUInt16BE(Te*V)}let Ce;if(H){let Re=-1;for(Ce=y;Ce<Z;Ce++)if(ke(F,Ce)===ke(m,Re===-1?0:Ce-Re)){if(Re===-1&&(Re=Ce),Ce-Re+1===ge)return Re*V}else Re!==-1&&(Ce-=Ce-Re),Re=-1}else for(y+ge>Z&&(y=Z-ge),Ce=y;Ce>=0;Ce--){let Re=!0;for(let Te=0;Te<ge;Te++)if(ke(F,Ce+Te)!==ke(m,Te)){Re=!1;break}if(Re)return Ce}return-1}L.prototype.includes=function(m,y,R){return this.indexOf(m,y,R)!==-1},L.prototype.indexOf=function(m,y,R){return U(this,m,y,R,!0)},L.prototype.lastIndexOf=function(m,y,R){return U(this,m,y,R,!1)};function ee(F,m,y,R){y=Number(y)||0;const H=F.length-y;R?(R=Number(R),R>H&&(R=H)):R=H;const V=m.length;R>V/2&&(R=V/2);let Z;for(Z=0;Z<R;++Z){const ge=parseInt(m.substr(Z*2,2),16);if(Vt(ge))return Z;F[y+Z]=ge}return Z}function te(F,m,y,R){return Lt(Se(m,F.length-y),F,y,R)}function I(F,m,y,R){return Lt(Ie(m),F,y,R)}function M(F,m,y,R){return Lt(Ee(m),F,y,R)}function Y(F,m,y,R){return Lt(Fe(m,F.length-y),F,y,R)}L.prototype.write=function(m,y,R,H){if(y===void 0)H="utf8",R=this.length,y=0;else if(R===void 0&&typeof y=="string")H=y,R=this.length,y=0;else if(isFinite(y))y=y>>>0,isFinite(R)?(R=R>>>0,H===void 0&&(H="utf8")):(H=R,R=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const V=this.length-y;if((R===void 0||R>V)&&(R=V),m.length>0&&(R<0||y<0)||y>this.length)throw new RangeError("Attempt to write outside buffer bounds");H||(H="utf8");let Z=!1;for(;;)switch(H){case"hex":return ee(this,m,y,R);case"utf8":case"utf-8":return te(this,m,y,R);case"ascii":case"latin1":case"binary":return I(this,m,y,R);case"base64":return M(this,m,y,R);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,m,y,R);default:if(Z)throw new TypeError("Unknown encoding: "+H);H=(""+H).toLowerCase(),Z=!0}},L.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ne(F,m,y){return m===0&&y===F.length?x.fromByteArray(F):x.fromByteArray(F.slice(m,y))}function de(F,m,y){y=Math.min(F.length,y);const R=[];let H=m;for(;H<y;){const V=F[H];let Z=null,ge=V>239?4:V>223?3:V>191?2:1;if(H+ge<=y){let ke,Ce,Re,Te;switch(ge){case 1:V<128&&(Z=V);break;case 2:ke=F[H+1],(ke&192)===128&&(Te=(V&31)<<6|ke&63,Te>127&&(Z=Te));break;case 3:ke=F[H+1],Ce=F[H+2],(ke&192)===128&&(Ce&192)===128&&(Te=(V&15)<<12|(ke&63)<<6|Ce&63,Te>2047&&(Te<55296||Te>57343)&&(Z=Te));break;case 4:ke=F[H+1],Ce=F[H+2],Re=F[H+3],(ke&192)===128&&(Ce&192)===128&&(Re&192)===128&&(Te=(V&15)<<18|(ke&63)<<12|(Ce&63)<<6|Re&63,Te>65535&&Te<1114112&&(Z=Te))}}Z===null?(Z=65533,ge=1):Z>65535&&(Z-=65536,R.push(Z>>>10&1023|55296),Z=56320|Z&1023),R.push(Z),H+=ge}return me(R)}const ae=4096;function me(F){const m=F.length;if(m<=ae)return String.fromCharCode.apply(String,F);let y="",R=0;for(;R<m;)y+=String.fromCharCode.apply(String,F.slice(R,R+=ae));return y}function Le(F,m,y){let R="";y=Math.min(F.length,y);for(let H=m;H<y;++H)R+=String.fromCharCode(F[H]&127);return R}function X(F,m,y){let R="";y=Math.min(F.length,y);for(let H=m;H<y;++H)R+=String.fromCharCode(F[H]);return R}function He(F,m,y){const R=F.length;(!m||m<0)&&(m=0),(!y||y<0||y>R)&&(y=R);let H="";for(let V=m;V<y;++V)H+=rn[F[V]];return H}function Ge(F,m,y){const R=F.slice(m,y);let H="";for(let V=0;V<R.length-1;V+=2)H+=String.fromCharCode(R[V]+R[V+1]*256);return H}L.prototype.slice=function(m,y){const R=this.length;m=~~m,y=y===void 0?R:~~y,m<0?(m+=R,m<0&&(m=0)):m>R&&(m=R),y<0?(y+=R,y<0&&(y=0)):y>R&&(y=R),y<m&&(y=m);const H=this.subarray(m,y);return Object.setPrototypeOf(H,L.prototype),H};function Ae(F,m,y){if(F%1!==0||F<0)throw new RangeError("offset is not uint");if(F+m>y)throw new RangeError("Trying to access beyond buffer length")}L.prototype.readUintLE=L.prototype.readUIntLE=function(m,y,R){m=m>>>0,y=y>>>0,R||Ae(m,y,this.length);let H=this[m],V=1,Z=0;for(;++Z<y&&(V*=256);)H+=this[m+Z]*V;return H},L.prototype.readUintBE=L.prototype.readUIntBE=function(m,y,R){m=m>>>0,y=y>>>0,R||Ae(m,y,this.length);let H=this[m+--y],V=1;for(;y>0&&(V*=256);)H+=this[m+--y]*V;return H},L.prototype.readUint8=L.prototype.readUInt8=function(m,y){return m=m>>>0,y||Ae(m,1,this.length),this[m]},L.prototype.readUint16LE=L.prototype.readUInt16LE=function(m,y){return m=m>>>0,y||Ae(m,2,this.length),this[m]|this[m+1]<<8},L.prototype.readUint16BE=L.prototype.readUInt16BE=function(m,y){return m=m>>>0,y||Ae(m,2,this.length),this[m]<<8|this[m+1]},L.prototype.readUint32LE=L.prototype.readUInt32LE=function(m,y){return m=m>>>0,y||Ae(m,4,this.length),(this[m]|this[m+1]<<8|this[m+2]<<16)+this[m+3]*16777216},L.prototype.readUint32BE=L.prototype.readUInt32BE=function(m,y){return m=m>>>0,y||Ae(m,4,this.length),this[m]*16777216+(this[m+1]<<16|this[m+2]<<8|this[m+3])},L.prototype.readBigUInt64LE=Me(function(m){m=m>>>0,P(m,"offset");const y=this[m],R=this[m+7];(y===void 0||R===void 0)&&G(m,this.length-8);const H=y+this[++m]*2**8+this[++m]*2**16+this[++m]*2**24,V=this[++m]+this[++m]*2**8+this[++m]*2**16+R*2**24;return BigInt(H)+(BigInt(V)<<BigInt(32))}),L.prototype.readBigUInt64BE=Me(function(m){m=m>>>0,P(m,"offset");const y=this[m],R=this[m+7];(y===void 0||R===void 0)&&G(m,this.length-8);const H=y*2**24+this[++m]*2**16+this[++m]*2**8+this[++m],V=this[++m]*2**24+this[++m]*2**16+this[++m]*2**8+R;return(BigInt(H)<<BigInt(32))+BigInt(V)}),L.prototype.readIntLE=function(m,y,R){m=m>>>0,y=y>>>0,R||Ae(m,y,this.length);let H=this[m],V=1,Z=0;for(;++Z<y&&(V*=256);)H+=this[m+Z]*V;return V*=128,H>=V&&(H-=Math.pow(2,8*y)),H},L.prototype.readIntBE=function(m,y,R){m=m>>>0,y=y>>>0,R||Ae(m,y,this.length);let H=y,V=1,Z=this[m+--H];for(;H>0&&(V*=256);)Z+=this[m+--H]*V;return V*=128,Z>=V&&(Z-=Math.pow(2,8*y)),Z},L.prototype.readInt8=function(m,y){return m=m>>>0,y||Ae(m,1,this.length),this[m]&128?(255-this[m]+1)*-1:this[m]},L.prototype.readInt16LE=function(m,y){m=m>>>0,y||Ae(m,2,this.length);const R=this[m]|this[m+1]<<8;return R&32768?R|4294901760:R},L.prototype.readInt16BE=function(m,y){m=m>>>0,y||Ae(m,2,this.length);const R=this[m+1]|this[m]<<8;return R&32768?R|4294901760:R},L.prototype.readInt32LE=function(m,y){return m=m>>>0,y||Ae(m,4,this.length),this[m]|this[m+1]<<8|this[m+2]<<16|this[m+3]<<24},L.prototype.readInt32BE=function(m,y){return m=m>>>0,y||Ae(m,4,this.length),this[m]<<24|this[m+1]<<16|this[m+2]<<8|this[m+3]},L.prototype.readBigInt64LE=Me(function(m){m=m>>>0,P(m,"offset");const y=this[m],R=this[m+7];(y===void 0||R===void 0)&&G(m,this.length-8);const H=this[m+4]+this[m+5]*2**8+this[m+6]*2**16+(R<<24);return(BigInt(H)<<BigInt(32))+BigInt(y+this[++m]*2**8+this[++m]*2**16+this[++m]*2**24)}),L.prototype.readBigInt64BE=Me(function(m){m=m>>>0,P(m,"offset");const y=this[m],R=this[m+7];(y===void 0||R===void 0)&&G(m,this.length-8);const H=(y<<24)+this[++m]*2**16+this[++m]*2**8+this[++m];return(BigInt(H)<<BigInt(32))+BigInt(this[++m]*2**24+this[++m]*2**16+this[++m]*2**8+R)}),L.prototype.readFloatLE=function(m,y){return m=m>>>0,y||Ae(m,4,this.length),g.read(this,m,!0,23,4)},L.prototype.readFloatBE=function(m,y){return m=m>>>0,y||Ae(m,4,this.length),g.read(this,m,!1,23,4)},L.prototype.readDoubleLE=function(m,y){return m=m>>>0,y||Ae(m,8,this.length),g.read(this,m,!0,52,8)},L.prototype.readDoubleBE=function(m,y){return m=m>>>0,y||Ae(m,8,this.length),g.read(this,m,!1,52,8)};function Be(F,m,y,R,H,V){if(!L.isBuffer(F))throw new TypeError('"buffer" argument must be a Buffer instance');if(m>H||m<V)throw new RangeError('"value" argument is out of bounds');if(y+R>F.length)throw new RangeError("Index out of range")}L.prototype.writeUintLE=L.prototype.writeUIntLE=function(m,y,R,H){if(m=+m,y=y>>>0,R=R>>>0,!H){const ge=Math.pow(2,8*R)-1;Be(this,m,y,R,ge,0)}let V=1,Z=0;for(this[y]=m&255;++Z<R&&(V*=256);)this[y+Z]=m/V&255;return y+R},L.prototype.writeUintBE=L.prototype.writeUIntBE=function(m,y,R,H){if(m=+m,y=y>>>0,R=R>>>0,!H){const ge=Math.pow(2,8*R)-1;Be(this,m,y,R,ge,0)}let V=R-1,Z=1;for(this[y+V]=m&255;--V>=0&&(Z*=256);)this[y+V]=m/Z&255;return y+R},L.prototype.writeUint8=L.prototype.writeUInt8=function(m,y,R){return m=+m,y=y>>>0,R||Be(this,m,y,1,255,0),this[y]=m&255,y+1},L.prototype.writeUint16LE=L.prototype.writeUInt16LE=function(m,y,R){return m=+m,y=y>>>0,R||Be(this,m,y,2,65535,0),this[y]=m&255,this[y+1]=m>>>8,y+2},L.prototype.writeUint16BE=L.prototype.writeUInt16BE=function(m,y,R){return m=+m,y=y>>>0,R||Be(this,m,y,2,65535,0),this[y]=m>>>8,this[y+1]=m&255,y+2},L.prototype.writeUint32LE=L.prototype.writeUInt32LE=function(m,y,R){return m=+m,y=y>>>0,R||Be(this,m,y,4,4294967295,0),this[y+3]=m>>>24,this[y+2]=m>>>16,this[y+1]=m>>>8,this[y]=m&255,y+4},L.prototype.writeUint32BE=L.prototype.writeUInt32BE=function(m,y,R){return m=+m,y=y>>>0,R||Be(this,m,y,4,4294967295,0),this[y]=m>>>24,this[y+1]=m>>>16,this[y+2]=m>>>8,this[y+3]=m&255,y+4};function qe(F,m,y,R,H){C(m,R,H,F,y,7);let V=Number(m&BigInt(4294967295));F[y++]=V,V=V>>8,F[y++]=V,V=V>>8,F[y++]=V,V=V>>8,F[y++]=V;let Z=Number(m>>BigInt(32)&BigInt(4294967295));return F[y++]=Z,Z=Z>>8,F[y++]=Z,Z=Z>>8,F[y++]=Z,Z=Z>>8,F[y++]=Z,y}function Oe(F,m,y,R,H){C(m,R,H,F,y,7);let V=Number(m&BigInt(4294967295));F[y+7]=V,V=V>>8,F[y+6]=V,V=V>>8,F[y+5]=V,V=V>>8,F[y+4]=V;let Z=Number(m>>BigInt(32)&BigInt(4294967295));return F[y+3]=Z,Z=Z>>8,F[y+2]=Z,Z=Z>>8,F[y+1]=Z,Z=Z>>8,F[y]=Z,y+8}L.prototype.writeBigUInt64LE=Me(function(m,y=0){return qe(this,m,y,BigInt(0),BigInt("0xffffffffffffffff"))}),L.prototype.writeBigUInt64BE=Me(function(m,y=0){return Oe(this,m,y,BigInt(0),BigInt("0xffffffffffffffff"))}),L.prototype.writeIntLE=function(m,y,R,H){if(m=+m,y=y>>>0,!H){const ke=Math.pow(2,8*R-1);Be(this,m,y,R,ke-1,-ke)}let V=0,Z=1,ge=0;for(this[y]=m&255;++V<R&&(Z*=256);)m<0&&ge===0&&this[y+V-1]!==0&&(ge=1),this[y+V]=(m/Z>>0)-ge&255;return y+R},L.prototype.writeIntBE=function(m,y,R,H){if(m=+m,y=y>>>0,!H){const ke=Math.pow(2,8*R-1);Be(this,m,y,R,ke-1,-ke)}let V=R-1,Z=1,ge=0;for(this[y+V]=m&255;--V>=0&&(Z*=256);)m<0&&ge===0&&this[y+V+1]!==0&&(ge=1),this[y+V]=(m/Z>>0)-ge&255;return y+R},L.prototype.writeInt8=function(m,y,R){return m=+m,y=y>>>0,R||Be(this,m,y,1,127,-128),m<0&&(m=255+m+1),this[y]=m&255,y+1},L.prototype.writeInt16LE=function(m,y,R){return m=+m,y=y>>>0,R||Be(this,m,y,2,32767,-32768),this[y]=m&255,this[y+1]=m>>>8,y+2},L.prototype.writeInt16BE=function(m,y,R){return m=+m,y=y>>>0,R||Be(this,m,y,2,32767,-32768),this[y]=m>>>8,this[y+1]=m&255,y+2},L.prototype.writeInt32LE=function(m,y,R){return m=+m,y=y>>>0,R||Be(this,m,y,4,2147483647,-2147483648),this[y]=m&255,this[y+1]=m>>>8,this[y+2]=m>>>16,this[y+3]=m>>>24,y+4},L.prototype.writeInt32BE=function(m,y,R){return m=+m,y=y>>>0,R||Be(this,m,y,4,2147483647,-2147483648),m<0&&(m=4294967295+m+1),this[y]=m>>>24,this[y+1]=m>>>16,this[y+2]=m>>>8,this[y+3]=m&255,y+4},L.prototype.writeBigInt64LE=Me(function(m,y=0){return qe(this,m,y,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),L.prototype.writeBigInt64BE=Me(function(m,y=0){return Oe(this,m,y,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function We(F,m,y,R,H,V){if(y+R>F.length)throw new RangeError("Index out of range");if(y<0)throw new RangeError("Index out of range")}function Pe(F,m,y,R,H){return m=+m,y=y>>>0,H||We(F,m,y,4),g.write(F,m,y,R,23,4),y+4}L.prototype.writeFloatLE=function(m,y,R){return Pe(this,m,y,!0,R)},L.prototype.writeFloatBE=function(m,y,R){return Pe(this,m,y,!1,R)};function Ue(F,m,y,R,H){return m=+m,y=y>>>0,H||We(F,m,y,8),g.write(F,m,y,R,52,8),y+8}L.prototype.writeDoubleLE=function(m,y,R){return Ue(this,m,y,!0,R)},L.prototype.writeDoubleBE=function(m,y,R){return Ue(this,m,y,!1,R)},L.prototype.copy=function(m,y,R,H){if(!L.isBuffer(m))throw new TypeError("argument should be a Buffer");if(R||(R=0),!H&&H!==0&&(H=this.length),y>=m.length&&(y=m.length),y||(y=0),H>0&&H<R&&(H=R),H===R||m.length===0||this.length===0)return 0;if(y<0)throw new RangeError("targetStart out of bounds");if(R<0||R>=this.length)throw new RangeError("Index out of range");if(H<0)throw new RangeError("sourceEnd out of bounds");H>this.length&&(H=this.length),m.length-y<H-R&&(H=m.length-y+R);const V=H-R;return this===m&&typeof k.prototype.copyWithin=="function"?this.copyWithin(y,R,H):k.prototype.set.call(m,this.subarray(R,H),y),V},L.prototype.fill=function(m,y,R,H){if(typeof m=="string"){if(typeof y=="string"?(H=y,y=0,R=this.length):typeof R=="string"&&(H=R,R=this.length),H!==void 0&&typeof H!="string")throw new TypeError("encoding must be a string");if(typeof H=="string"&&!L.isEncoding(H))throw new TypeError("Unknown encoding: "+H);if(m.length===1){const Z=m.charCodeAt(0);(H==="utf8"&&Z<128||H==="latin1")&&(m=Z)}}else typeof m=="number"?m=m&255:typeof m=="boolean"&&(m=Number(m));if(y<0||this.length<y||this.length<R)throw new RangeError("Out of range index");if(R<=y)return this;y=y>>>0,R=R===void 0?this.length:R>>>0,m||(m=0);let V;if(typeof m=="number")for(V=y;V<R;++V)this[V]=m;else{const Z=L.isBuffer(m)?m:L.from(m,H),ge=Z.length;if(ge===0)throw new TypeError('The value "'+m+'" is invalid for argument "value"');for(V=0;V<R-y;++V)this[V+y]=Z[V%ge]}return this};const lt={};function T(F,m,y){lt[F]=class extends y{constructor(){super(),Object.defineProperty(this,"message",{value:m.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${F}]`,this.stack,delete this.name}get code(){return F}set code(H){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:H,writable:!0})}toString(){return`${this.name} [${F}]: ${this.message}`}}}T("ERR_BUFFER_OUT_OF_BOUNDS",function(F){return F?`${F} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),T("ERR_INVALID_ARG_TYPE",function(F,m){return`The "${F}" argument must be of type number. Received type ${typeof m}`},TypeError),T("ERR_OUT_OF_RANGE",function(F,m,y){let R=`The value of "${F}" is out of range.`,H=y;return Number.isInteger(y)&&Math.abs(y)>2**32?H=p(String(y)):typeof y=="bigint"&&(H=String(y),(y>BigInt(2)**BigInt(32)||y<-(BigInt(2)**BigInt(32)))&&(H=p(H)),H+="n"),R+=` It must be ${m}. Received ${H}`,R},RangeError);function p(F){let m="",y=F.length;const R=F[0]==="-"?1:0;for(;y>=R+4;y-=3)m=`_${F.slice(y-3,y)}${m}`;return`${F.slice(0,y)}${m}`}function b(F,m,y){P(m,"offset"),(F[m]===void 0||F[m+y]===void 0)&&G(m,F.length-(y+1))}function C(F,m,y,R,H,V){if(F>y||F<m){const Z=typeof m=="bigint"?"n":"";let ge;throw m===0||m===BigInt(0)?ge=`>= 0${Z} and < 2${Z} ** ${(V+1)*8}${Z}`:ge=`>= -(2${Z} ** ${(V+1)*8-1}${Z}) and < 2 ** ${(V+1)*8-1}${Z}`,new lt.ERR_OUT_OF_RANGE("value",ge,F)}b(R,H,V)}function P(F,m){if(typeof F!="number")throw new lt.ERR_INVALID_ARG_TYPE(m,"number",F)}function G(F,m,y){throw Math.floor(F)!==F?(P(F,y),new lt.ERR_OUT_OF_RANGE("offset","an integer",F)):m<0?new lt.ERR_BUFFER_OUT_OF_BOUNDS:new lt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${m}`,F)}const J=/[^+/0-9A-Za-z-_]/g;function ye(F){if(F=F.split("=")[0],F=F.trim().replace(J,""),F.length<2)return"";for(;F.length%4!==0;)F=F+"=";return F}function Se(F,m){m=m||1/0;let y;const R=F.length;let H=null;const V=[];for(let Z=0;Z<R;++Z){if(y=F.charCodeAt(Z),y>55295&&y<57344){if(!H){if(y>56319){(m-=3)>-1&&V.push(239,191,189);continue}else if(Z+1===R){(m-=3)>-1&&V.push(239,191,189);continue}H=y;continue}if(y<56320){(m-=3)>-1&&V.push(239,191,189),H=y;continue}y=(H-55296<<10|y-56320)+65536}else H&&(m-=3)>-1&&V.push(239,191,189);if(H=null,y<128){if((m-=1)<0)break;V.push(y)}else if(y<2048){if((m-=2)<0)break;V.push(y>>6|192,y&63|128)}else if(y<65536){if((m-=3)<0)break;V.push(y>>12|224,y>>6&63|128,y&63|128)}else if(y<1114112){if((m-=4)<0)break;V.push(y>>18|240,y>>12&63|128,y>>6&63|128,y&63|128)}else throw new Error("Invalid code point")}return V}function Ie(F){const m=[];for(let y=0;y<F.length;++y)m.push(F.charCodeAt(y)&255);return m}function Fe(F,m){let y,R,H;const V=[];for(let Z=0;Z<F.length&&!((m-=2)<0);++Z)y=F.charCodeAt(Z),R=y>>8,H=y%256,V.push(H),V.push(R);return V}function Ee(F){return x.toByteArray(ye(F))}function Lt(F,m,y,R){let H;for(H=0;H<R&&!(H+y>=m.length||H>=F.length);++H)m[H+y]=F[H];return H}function Ve(F,m){return F instanceof m||F!=null&&F.constructor!=null&&F.constructor.name!=null&&F.constructor.name===m.name}function Vt(F){return F!==F}const rn=(function(){const F="0123456789abcdef",m=new Array(256);for(let y=0;y<16;++y){const R=y*16;for(let H=0;H<16;++H)m[R+H]=F[y]+F[H]}return m})();function Me(F){return typeof BigInt>"u"?Ft:F}function Ft(){throw new Error("BigInt not supported")}})(t);const _=t.Buffer;s.Blob=t.Blob,s.BlobOptions=t.BlobOptions,s.Buffer=t.Buffer,s.File=t.File,s.FileOptions=t.FileOptions,s.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,s.SlowBuffer=t.SlowBuffer,s.TranscodeEncoding=t.TranscodeEncoding,s.atob=t.atob,s.btoa=t.btoa,s.constants=t.constants,s.default=_,s.isAscii=t.isAscii,s.isUtf8=t.isUtf8,s.kMaxLength=t.kMaxLength,s.kStringMaxLength=t.kStringMaxLength,s.resolveObjectURL=t.resolveObjectURL,s.transcode=t.transcode})(yn)),yn}var vn,ss;function Ze(){if(ss)return vn;ss=1;var s=Er(),t=s.Buffer,r={},e;for(e in s)s.hasOwnProperty(e)&&(e==="SlowBuffer"||e==="Buffer"||(r[e]=s[e]));var n=r.Buffer={};for(e in t)t.hasOwnProperty(e)&&(e==="allocUnsafe"||e==="allocUnsafeSlow"||(n[e]=t[e]));if(r.Buffer.prototype=t.prototype,(!n.from||n.from===Uint8Array.from)&&(n.from=function(i,f,a){if(typeof i=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof i);if(i&&typeof i.length>"u")throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i);return t(i,f,a)}),n.alloc||(n.alloc=function(i,f,a){if(typeof i!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof i);if(i<0||i>=2*(1<<30))throw new RangeError('The value "'+i+'" is invalid for option "size"');var l=t(i);return!f||f.length===0?l.fill(0):typeof a=="string"?l.fill(f,a):l.fill(f),l}),!r.kStringMaxLength)try{r.kStringMaxLength=xe.binding("buffer").kStringMaxLength}catch{}return r.constants||(r.constants={MAX_LENGTH:r.kMaxLength},r.kStringMaxLength&&(r.constants.MAX_STRING_LENGTH=r.kStringMaxLength)),vn=r,vn}var Rr={},os;function Su(){if(os)return Rr;os=1;var s="\uFEFF";Rr.PrependBOM=t;function t(e,n){this.encoder=e,this.addBOM=!0}t.prototype.write=function(e){return this.addBOM&&(e=s+e,this.addBOM=!1),this.encoder.write(e)},t.prototype.end=function(){return this.encoder.end()},Rr.StripBOM=r;function r(e,n){this.decoder=e,this.pass=!1,this.options=n||{}}return r.prototype.write=function(e){var n=this.decoder.write(e);return this.pass||!n||(n[0]===s&&(n=n.slice(1),typeof this.options.stripBOM=="function"&&this.options.stripBOM()),this.pass=!0),n},r.prototype.end=function(){return this.decoder.end()},Rr}var wn={},xn={},kr={exports:{}};var cs;function Tu(){return cs||(cs=1,(function(s,t){var r=Er(),e=r.Buffer;function n(f,a){for(var l in f)a[l]=f[l]}e.from&&e.alloc&&e.allocUnsafe&&e.allocUnsafeSlow?s.exports=r:(n(r,t),t.Buffer=i);function i(f,a,l){return e(f,a,l)}i.prototype=Object.create(e.prototype),n(e,i),i.from=function(f,a,l){if(typeof f=="number")throw new TypeError("Argument must not be a number");return e(f,a,l)},i.alloc=function(f,a,l){if(typeof f!="number")throw new TypeError("Argument must be a number");var c=e(f);return a!==void 0?typeof l=="string"?c.fill(a,l):c.fill(a):c.fill(0),c},i.allocUnsafe=function(f){if(typeof f!="number")throw new TypeError("Argument must be a number");return e(f)},i.allocUnsafeSlow=function(f){if(typeof f!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(f)}})(kr,kr.exports)),kr.exports}var ls;function Vr(){if(ls)return xn;ls=1;var s=Tu().Buffer,t=s.isEncoding||function(_){switch(_=""+_,_&&_.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(_){if(!_)return"utf8";for(var E;;)switch(_){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return _;default:if(E)return;_=(""+_).toLowerCase(),E=!0}}function e(_){var E=r(_);if(typeof E!="string"&&(s.isEncoding===t||!t(_)))throw new Error("Unknown encoding: "+_);return E||_}xn.StringDecoder=n;function n(_){this.encoding=e(_);var E;switch(this.encoding){case"utf16le":this.text=d,this.end=u,E=4;break;case"utf8":this.fillLast=l,E=4;break;case"base64":this.text=h,this.end=v,E=3;break;default:this.write=w,this.end=A;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=s.allocUnsafe(E)}n.prototype.write=function(_){if(_.length===0)return"";var E,x;if(this.lastNeed){if(E=this.fillLast(_),E===void 0)return"";x=this.lastNeed,this.lastNeed=0}else x=0;return x<_.length?E?E+this.text(_,x):this.text(_,x):E||""},n.prototype.end=o,n.prototype.text=c,n.prototype.fillLast=function(_){if(this.lastNeed<=_.length)return _.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,this.lastTotal-this.lastNeed,0,_.length),this.lastNeed-=_.length};function i(_){return _<=127?0:_>>5===6?2:_>>4===14?3:_>>3===30?4:_>>6===2?-1:-2}function f(_,E,x){var g=E.length-1;if(g<x)return 0;var S=i(E[g]);return S>=0?(S>0&&(_.lastNeed=S-1),S):--g<x||S===-2?0:(S=i(E[g]),S>=0?(S>0&&(_.lastNeed=S-2),S):--g<x||S===-2?0:(S=i(E[g]),S>=0?(S>0&&(S===2?S=0:_.lastNeed=S-3),S):0))}function a(_,E,x){if((E[0]&192)!==128)return _.lastNeed=0,"";if(_.lastNeed>1&&E.length>1){if((E[1]&192)!==128)return _.lastNeed=1,"";if(_.lastNeed>2&&E.length>2&&(E[2]&192)!==128)return _.lastNeed=2,""}}function l(_){var E=this.lastTotal-this.lastNeed,x=a(this,_);if(x!==void 0)return x;if(this.lastNeed<=_.length)return _.copy(this.lastChar,E,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,E,0,_.length),this.lastNeed-=_.length}function c(_,E){var x=f(this,_,E);if(!this.lastNeed)return _.toString("utf8",E);this.lastTotal=x;var g=_.length-(x-this.lastNeed);return _.copy(this.lastChar,0,g),_.toString("utf8",E,g)}function o(_){var E=_&&_.length?this.write(_):"";return this.lastNeed?E+"":E}function d(_,E){if((_.length-E)%2===0){var x=_.toString("utf16le",E);if(x){var g=x.charCodeAt(x.length-1);if(g>=55296&&g<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1],x.slice(0,-1)}return x}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=_[_.length-1],_.toString("utf16le",E,_.length-1)}function u(_){var E=_&&_.length?this.write(_):"";if(this.lastNeed){var x=this.lastTotal-this.lastNeed;return E+this.lastChar.toString("utf16le",0,x)}return E}function h(_,E){var x=(_.length-E)%3;return x===0?_.toString("base64",E):(this.lastNeed=3-x,this.lastTotal=3,x===1?this.lastChar[0]=_[_.length-1]:(this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1]),_.toString("base64",E,_.length-x))}function v(_){var E=_&&_.length?this.write(_):"";return this.lastNeed?E+this.lastChar.toString("base64",0,3-this.lastNeed):E}function w(_){return _.toString(this.encoding)}function A(_){return _&&_.length?this.write(_):""}return xn}var En,us;function Fu(){if(us)return En;us=1;var s=Ze().Buffer;En={utf8:{type:"_internal",bomAware:!0},cesu8:{type:"_internal",bomAware:!0},unicode11utf8:"utf8",ucs2:{type:"_internal",bomAware:!0},utf16le:"ucs2",binary:{type:"_internal"},base64:{type:"_internal"},hex:{type:"_internal"},_internal:t};function t(l,c){this.enc=l.encodingName,this.bomAware=l.bomAware,this.enc==="base64"?this.encoder=i:this.enc==="cesu8"&&(this.enc="utf8",this.encoder=f,s.from("eda0bdedb2a9","hex").toString()!==""&&(this.decoder=a,this.defaultCharUnicode=c.defaultCharUnicode))}t.prototype.encoder=n,t.prototype.decoder=e;var r=Vr().StringDecoder;r.prototype.end||(r.prototype.end=function(){});function e(l,c){this.decoder=new r(c.enc)}e.prototype.write=function(l){return s.isBuffer(l)||(l=s.from(l)),this.decoder.write(l)},e.prototype.end=function(){return this.decoder.end()};function n(l,c){this.enc=c.enc}n.prototype.write=function(l){return s.from(l,this.enc)},n.prototype.end=function(){};function i(l,c){this.prevStr=""}i.prototype.write=function(l){l=this.prevStr+l;var c=l.length-l.length%4;return this.prevStr=l.slice(c),l=l.slice(0,c),s.from(l,"base64")},i.prototype.end=function(){return s.from(this.prevStr,"base64")};function f(l,c){}f.prototype.write=function(l){for(var c=s.alloc(l.length*3),o=0,d=0;d<l.length;d++){var u=l.charCodeAt(d);u<128?c[o++]=u:u<2048?(c[o++]=192+(u>>>6),c[o++]=128+(u&63)):(c[o++]=224+(u>>>12),c[o++]=128+(u>>>6&63),c[o++]=128+(u&63))}return c.slice(0,o)},f.prototype.end=function(){};function a(l,c){this.acc=0,this.contBytes=0,this.accBytes=0,this.defaultCharUnicode=c.defaultCharUnicode}return a.prototype.write=function(l){for(var c=this.acc,o=this.contBytes,d=this.accBytes,u="",h=0;h<l.length;h++){var v=l[h];(v&192)!==128?(o>0&&(u+=this.defaultCharUnicode,o=0),v<128?u+=String.fromCharCode(v):v<224?(c=v&31,o=1,d=1):v<240?(c=v&15,o=2,d=1):u+=this.defaultCharUnicode):o>0?(c=c<<6|v&63,o--,d++,o===0&&(d===2&&c<128&&c>0?u+=this.defaultCharUnicode:d===3&&c<2048?u+=this.defaultCharUnicode:u+=String.fromCharCode(c))):u+=this.defaultCharUnicode}return this.acc=c,this.contBytes=o,this.accBytes=d,u},a.prototype.end=function(){var l=0;return this.contBytes>0&&(l+=this.defaultCharUnicode),l},En}var wt={},fs;function Bu(){if(fs)return wt;fs=1;var s=Ze().Buffer;wt._utf32=t;function t(c,o){this.iconv=o,this.bomAware=!0,this.isLE=c.isLE}wt.utf32le={type:"_utf32",isLE:!0},wt.utf32be={type:"_utf32",isLE:!1},wt.ucs4le="utf32le",wt.ucs4be="utf32be",t.prototype.encoder=r,t.prototype.decoder=e;function r(c,o){this.isLE=o.isLE,this.highSurrogate=0}r.prototype.write=function(c){for(var o=s.from(c,"ucs2"),d=s.alloc(o.length*2),u=this.isLE?d.writeUInt32LE:d.writeUInt32BE,h=0,v=0;v<o.length;v+=2){var w=o.readUInt16LE(v),A=55296<=w&&w<56320,_=56320<=w&&w<57344;if(this.highSurrogate)if(A||!_)u.call(d,this.highSurrogate,h),h+=4;else{var E=(this.highSurrogate-55296<<10|w-56320)+65536;u.call(d,E,h),h+=4,this.highSurrogate=0;continue}A?this.highSurrogate=w:(u.call(d,w,h),h+=4,this.highSurrogate=0)}return h<d.length&&(d=d.slice(0,h)),d},r.prototype.end=function(){if(this.highSurrogate){var c=s.alloc(4);return this.isLE?c.writeUInt32LE(this.highSurrogate,0):c.writeUInt32BE(this.highSurrogate,0),this.highSurrogate=0,c}};function e(c,o){this.isLE=o.isLE,this.badChar=o.iconv.defaultCharUnicode.charCodeAt(0),this.overflow=[]}e.prototype.write=function(c){if(c.length===0)return"";var o=0,d=0,u=s.alloc(c.length+4),h=0,v=this.isLE,w=this.overflow,A=this.badChar;if(w.length>0){for(;o<c.length&&w.length<4;o++)w.push(c[o]);w.length===4&&(v?d=w[o]|w[o+1]<<8|w[o+2]<<16|w[o+3]<<24:d=w[o+3]|w[o+2]<<8|w[o+1]<<16|w[o]<<24,w.length=0,h=n(u,h,d,A))}for(;o<c.length-3;o+=4)v?d=c[o]|c[o+1]<<8|c[o+2]<<16|c[o+3]<<24:d=c[o+3]|c[o+2]<<8|c[o+1]<<16|c[o]<<24,h=n(u,h,d,A);for(;o<c.length;o++)w.push(c[o]);return u.slice(0,h).toString("ucs2")};function n(c,o,d,u){if((d<0||d>1114111)&&(d=u),d>=65536){d-=65536;var h=55296|d>>10;c[o++]=h&255,c[o++]=h>>8;var d=56320|d&1023}return c[o++]=d&255,c[o++]=d>>8,o}e.prototype.end=function(){this.overflow.length=0},wt.utf32=i,wt.ucs4="utf32";function i(c,o){this.iconv=o}i.prototype.encoder=f,i.prototype.decoder=a;function f(c,o){c=c||{},c.addBOM===void 0&&(c.addBOM=!0),this.encoder=o.iconv.getEncoder(c.defaultEncoding||"utf-32le",c)}f.prototype.write=function(c){return this.encoder.write(c)},f.prototype.end=function(){return this.encoder.end()};function a(c,o){this.decoder=null,this.initialBufs=[],this.initialBufsLen=0,this.options=c||{},this.iconv=o.iconv}a.prototype.write=function(c){if(!this.decoder){if(this.initialBufs.push(c),this.initialBufsLen+=c.length,this.initialBufsLen<32)return"";var o=l(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(o,this.options);for(var d="",u=0;u<this.initialBufs.length;u++)d+=this.decoder.write(this.initialBufs[u]);return this.initialBufs.length=this.initialBufsLen=0,d}return this.decoder.write(c)},a.prototype.end=function(){if(!this.decoder){var c=l(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(c,this.options);for(var o="",d=0;d<this.initialBufs.length;d++)o+=this.decoder.write(this.initialBufs[d]);var u=this.decoder.end();return u&&(o+=u),this.initialBufs.length=this.initialBufsLen=0,o}return this.decoder.end()};function l(c,o){var d=[],u=0,h=0,v=0,w=0,A=0;e:for(var _=0;_<c.length;_++)for(var E=c[_],x=0;x<E.length;x++)if(d.push(E[x]),d.length===4){if(u===0){if(d[0]===255&&d[1]===254&&d[2]===0&&d[3]===0)return"utf-32le";if(d[0]===0&&d[1]===0&&d[2]===254&&d[3]===255)return"utf-32be"}if((d[0]!==0||d[1]>16)&&v++,(d[3]!==0||d[2]>16)&&h++,d[0]===0&&d[1]===0&&(d[2]!==0||d[3]!==0)&&A++,(d[0]!==0||d[1]!==0)&&d[2]===0&&d[3]===0&&w++,d.length=0,u++,u>=100)break e}return A-v>w-h?"utf-32be":A-v<w-h?"utf-32le":o||"utf-32le"}return wt}var Dr={},ds;function Iu(){if(ds)return Dr;ds=1;var s=Ze().Buffer;Dr.utf16be=t;function t(){}t.prototype.encoder=r,t.prototype.decoder=e,t.prototype.bomAware=!0;function r(){}r.prototype.write=function(l){for(var c=s.from(l,"ucs2"),o=0;o<c.length;o+=2){var d=c[o];c[o]=c[o+1],c[o+1]=d}return c},r.prototype.end=function(){};function e(){this.overflowByte=-1}e.prototype.write=function(l){if(l.length==0)return"";var c=s.alloc(l.length+1),o=0,d=0;for(this.overflowByte!==-1&&(c[0]=l[0],c[1]=this.overflowByte,o=1,d=2);o<l.length-1;o+=2,d+=2)c[d]=l[o+1],c[d+1]=l[o];return this.overflowByte=o==l.length-1?l[l.length-1]:-1,c.slice(0,d).toString("ucs2")},e.prototype.end=function(){this.overflowByte=-1},Dr.utf16=n;function n(l,c){this.iconv=c}n.prototype.encoder=i,n.prototype.decoder=f;function i(l,c){l=l||{},l.addBOM===void 0&&(l.addBOM=!0),this.encoder=c.iconv.getEncoder("utf-16le",l)}i.prototype.write=function(l){return this.encoder.write(l)},i.prototype.end=function(){return this.encoder.end()};function f(l,c){this.decoder=null,this.initialBufs=[],this.initialBufsLen=0,this.options=l||{},this.iconv=c.iconv}f.prototype.write=function(l){if(!this.decoder){if(this.initialBufs.push(l),this.initialBufsLen+=l.length,this.initialBufsLen<16)return"";var c=a(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(c,this.options);for(var o="",d=0;d<this.initialBufs.length;d++)o+=this.decoder.write(this.initialBufs[d]);return this.initialBufs.length=this.initialBufsLen=0,o}return this.decoder.write(l)},f.prototype.end=function(){if(!this.decoder){var l=a(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(l,this.options);for(var c="",o=0;o<this.initialBufs.length;o++)c+=this.decoder.write(this.initialBufs[o]);var d=this.decoder.end();return d&&(c+=d),this.initialBufs.length=this.initialBufsLen=0,c}return this.decoder.end()};function a(l,c){var o=[],d=0,u=0,h=0;e:for(var v=0;v<l.length;v++)for(var w=l[v],A=0;A<w.length;A++)if(o.push(w[A]),o.length===2){if(d===0){if(o[0]===255&&o[1]===254)return"utf-16le";if(o[0]===254&&o[1]===255)return"utf-16be"}if(o[0]===0&&o[1]!==0&&h++,o[0]!==0&&o[1]===0&&u++,o.length=0,d++,d>=100)break e}return h>u?"utf-16be":h<u?"utf-16le":c||"utf-16le"}return Dr}var er={},hs;function Mu(){if(hs)return er;hs=1;var s=Ze().Buffer;er.utf7=t,er.unicode11utf7="utf7";function t(w,A){this.iconv=A}t.prototype.encoder=e,t.prototype.decoder=n,t.prototype.bomAware=!0;var r=/[^A-Za-z0-9'\(\),-\.\/:\? \n\r\t]+/g;function e(w,A){this.iconv=A.iconv}e.prototype.write=function(w){return s.from(w.replace(r,function(A){return"+"+(A==="+"?"":this.iconv.encode(A,"utf16-be").toString("base64").replace(/=+$/,""))+"-"}.bind(this)))},e.prototype.end=function(){};function n(w,A){this.iconv=A.iconv,this.inBase64=!1,this.base64Accum=""}for(var i=/[A-Za-z0-9\/+]/,f=[],a=0;a<256;a++)f[a]=i.test(String.fromCharCode(a));var l=43,c=45,o=38;n.prototype.write=function(w){for(var A="",_=0,E=this.inBase64,x=this.base64Accum,g=0;g<w.length;g++)if(!E)w[g]==l&&(A+=this.iconv.decode(w.slice(_,g),"ascii"),_=g+1,E=!0);else if(!f[w[g]]){if(g==_&&w[g]==c)A+="+";else{var S=x+this.iconv.decode(w.slice(_,g),"ascii");A+=this.iconv.decode(s.from(S,"base64"),"utf16-be")}w[g]!=c&&g--,_=g+1,E=!1,x=""}if(!E)A+=this.iconv.decode(w.slice(_),"ascii");else{var S=x+this.iconv.decode(w.slice(_),"ascii"),B=S.length-S.length%8;x=S.slice(B),S=S.slice(0,B),A+=this.iconv.decode(s.from(S,"base64"),"utf16-be")}return this.inBase64=E,this.base64Accum=x,A},n.prototype.end=function(){var w="";return this.inBase64&&this.base64Accum.length>0&&(w=this.iconv.decode(s.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",w},er.utf7imap=d;function d(w,A){this.iconv=A}d.prototype.encoder=u,d.prototype.decoder=h,d.prototype.bomAware=!0;function u(w,A){this.iconv=A.iconv,this.inBase64=!1,this.base64Accum=s.alloc(6),this.base64AccumIdx=0}u.prototype.write=function(w){for(var A=this.inBase64,_=this.base64Accum,E=this.base64AccumIdx,x=s.alloc(w.length*5+10),g=0,S=0;S<w.length;S++){var B=w.charCodeAt(S);32<=B&&B<=126?(A&&(E>0&&(g+=x.write(_.slice(0,E).toString("base64").replace(/\//g,",").replace(/=+$/,""),g),E=0),x[g++]=c,A=!1),A||(x[g++]=B,B===o&&(x[g++]=c))):(A||(x[g++]=o,A=!0),A&&(_[E++]=B>>8,_[E++]=B&255,E==_.length&&(g+=x.write(_.toString("base64").replace(/\//g,","),g),E=0)))}return this.inBase64=A,this.base64AccumIdx=E,x.slice(0,g)},u.prototype.end=function(){var w=s.alloc(10),A=0;return this.inBase64&&(this.base64AccumIdx>0&&(A+=w.write(this.base64Accum.slice(0,this.base64AccumIdx).toString("base64").replace(/\//g,",").replace(/=+$/,""),A),this.base64AccumIdx=0),w[A++]=c,this.inBase64=!1),w.slice(0,A)};function h(w,A){this.iconv=A.iconv,this.inBase64=!1,this.base64Accum=""}var v=f.slice();return v[44]=!0,h.prototype.write=function(w){for(var A="",_=0,E=this.inBase64,x=this.base64Accum,g=0;g<w.length;g++)if(!E)w[g]==o&&(A+=this.iconv.decode(w.slice(_,g),"ascii"),_=g+1,E=!0);else if(!v[w[g]]){if(g==_&&w[g]==c)A+="&";else{var S=x+this.iconv.decode(w.slice(_,g),"ascii").replace(/,/g,"/");A+=this.iconv.decode(s.from(S,"base64"),"utf16-be")}w[g]!=c&&g--,_=g+1,E=!1,x=""}if(!E)A+=this.iconv.decode(w.slice(_),"ascii");else{var S=x+this.iconv.decode(w.slice(_),"ascii").replace(/,/g,"/"),B=S.length-S.length%8;x=S.slice(B),S=S.slice(0,B),A+=this.iconv.decode(s.from(S,"base64"),"utf16-be")}return this.inBase64=E,this.base64Accum=x,A},h.prototype.end=function(){var w="";return this.inBase64&&this.base64Accum.length>0&&(w=this.iconv.decode(s.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",w},er}var _n={},ps;function Cu(){if(ps)return _n;ps=1;var s=Ze().Buffer;_n._sbcs=t;function t(n,i){if(!n)throw new Error("SBCS codec is called without the data.");if(!n.chars||n.chars.length!==128&&n.chars.length!==256)throw new Error("Encoding '"+n.type+"' has incorrect 'chars' (must be of len 128 or 256)");if(n.chars.length===128){for(var f="",a=0;a<128;a++)f+=String.fromCharCode(a);n.chars=f+n.chars}this.decodeBuf=s.from(n.chars,"ucs2");for(var l=s.alloc(65536,i.defaultCharSingleByte.charCodeAt(0)),a=0;a<n.chars.length;a++)l[n.chars.charCodeAt(a)]=a;this.encodeBuf=l}t.prototype.encoder=r,t.prototype.decoder=e;function r(n,i){this.encodeBuf=i.encodeBuf}r.prototype.write=function(n){for(var i=s.alloc(n.length),f=0;f<n.length;f++)i[f]=this.encodeBuf[n.charCodeAt(f)];return i},r.prototype.end=function(){};function e(n,i){this.decodeBuf=i.decodeBuf}return e.prototype.write=function(n){for(var i=this.decodeBuf,f=s.alloc(n.length*2),a=0,l=0,c=0;c<n.length;c++)a=n[c]*2,l=c*2,f[l]=i[a],f[l+1]=i[a+1];return f.toString("ucs2")},e.prototype.end=function(){},_n}var An,ms;function Ru(){return ms||(ms=1,An={10029:"maccenteuro",maccenteuro:{type:"_sbcs",chars:""},808:"cp808",ibm808:"cp808",cp808:{type:"_sbcs",chars:""},mik:{type:"_sbcs",chars:""},cp720:{type:"_sbcs",chars:""},ascii8bit:"ascii",usascii:"ascii",ansix34:"ascii",ansix341968:"ascii",ansix341986:"ascii",csascii:"ascii",cp367:"ascii",ibm367:"ascii",isoir6:"ascii",iso646us:"ascii",iso646irv:"ascii",us:"ascii",latin1:"iso88591",latin2:"iso88592",latin3:"iso88593",latin4:"iso88594",latin5:"iso88599",latin6:"iso885910",latin7:"iso885913",latin8:"iso885914",latin9:"iso885915",latin10:"iso885916",csisolatin1:"iso88591",csisolatin2:"iso88592",csisolatin3:"iso88593",csisolatin4:"iso88594",csisolatincyrillic:"iso88595",csisolatinarabic:"iso88596",csisolatingreek:"iso88597",csisolatinhebrew:"iso88598",csisolatin5:"iso88599",csisolatin6:"iso885910",l1:"iso88591",l2:"iso88592",l3:"iso88593",l4:"iso88594",l5:"iso88599",l6:"iso885910",l7:"iso885913",l8:"iso885914",l9:"iso885915",l10:"iso885916",isoir14:"iso646jp",isoir57:"iso646cn",isoir100:"iso88591",isoir101:"iso88592",isoir109:"iso88593",isoir110:"iso88594",isoir144:"iso88595",isoir127:"iso88596",isoir126:"iso88597",isoir138:"iso88598",isoir148:"iso88599",isoir157:"iso885910",isoir166:"tis620",isoir179:"iso885913",isoir199:"iso885914",isoir203:"iso885915",isoir226:"iso885916",cp819:"iso88591",ibm819:"iso88591",cyrillic:"iso88595",arabic:"iso88596",arabic8:"iso88596",ecma114:"iso88596",asmo708:"iso88596",greek:"iso88597",greek8:"iso88597",ecma118:"iso88597",elot928:"iso88597",hebrew:"iso88598",hebrew8:"iso88598",turkish:"iso88599",turkish8:"iso88599",thai:"iso885911",thai8:"iso885911",celtic:"iso885914",celtic8:"iso885914",isoceltic:"iso885914",tis6200:"tis620",tis62025291:"tis620",tis62025330:"tis620",1e4:"macroman",10006:"macgreek",10007:"maccyrillic",10079:"maciceland",10081:"macturkish",cspc8codepage437:"cp437",cspc775baltic:"cp775",cspc850multilingual:"cp850",cspcp852:"cp852",cspc862latinhebrew:"cp862",cpgr:"cp869",msee:"cp1250",mscyrl:"cp1251",msansi:"cp1252",msgreek:"cp1253",msturk:"cp1254",mshebr:"cp1255",msarab:"cp1256",winbaltrim:"cp1257",cp20866:"koi8r",20866:"koi8r",ibm878:"koi8r",cskoi8r:"koi8r",cp21866:"koi8u",21866:"koi8u",ibm1168:"koi8u",strk10482002:"rk1048",tcvn5712:"tcvn",tcvn57121:"tcvn",gb198880:"iso646cn",cn:"iso646cn",csiso14jisc6220ro:"iso646jp",jisc62201969ro:"iso646jp",jp:"iso646jp",cshproman8:"hproman8",r8:"hproman8",roman8:"hproman8",xroman8:"hproman8",ibm1051:"hproman8",mac:"macintosh",csmacintosh:"macintosh"}),An}var Sn,gs;function ku(){return gs||(gs=1,Sn={437:"cp437",737:"cp737",775:"cp775",850:"cp850",852:"cp852",855:"cp855",856:"cp856",857:"cp857",858:"cp858",860:"cp860",861:"cp861",862:"cp862",863:"cp863",864:"cp864",865:"cp865",866:"cp866",869:"cp869",874:"windows874",922:"cp922",1046:"cp1046",1124:"cp1124",1125:"cp1125",1129:"cp1129",1133:"cp1133",1161:"cp1161",1162:"cp1162",1163:"cp1163",1250:"windows1250",1251:"windows1251",1252:"windows1252",1253:"windows1253",1254:"windows1254",1255:"windows1255",1256:"windows1256",1257:"windows1257",1258:"windows1258",28591:"iso88591",28592:"iso88592",28593:"iso88593",28594:"iso88594",28595:"iso88595",28596:"iso88596",28597:"iso88597",28598:"iso88598",28599:"iso88599",28600:"iso885910",28601:"iso885911",28603:"iso885913",28604:"iso885914",28605:"iso885915",28606:"iso885916",windows874:{type:"_sbcs",chars:""},win874:"windows874",cp874:"windows874",windows1250:{type:"_sbcs",chars:""},win1250:"windows1250",cp1250:"windows1250",windows1251:{type:"_sbcs",chars:""},win1251:"windows1251",cp1251:"windows1251",windows1252:{type:"_sbcs",chars:""},win1252:"windows1252",cp1252:"windows1252",windows1253:{type:"_sbcs",chars:""},win1253:"windows1253",cp1253:"windows1253",windows1254:{type:"_sbcs",chars:""},win1254:"windows1254",cp1254:"windows1254",windows1255:{type:"_sbcs",chars:""},win1255:"windows1255",cp1255:"windows1255",windows1256:{type:"_sbcs",chars:""},win1256:"windows1256",cp1256:"windows1256",windows1257:{type:"_sbcs",chars:""},win1257:"windows1257",cp1257:"windows1257",windows1258:{type:"_sbcs",chars:""},win1258:"windows1258",cp1258:"windows1258",iso88591:{type:"_sbcs",chars:""},cp28591:"iso88591",iso88592:{type:"_sbcs",chars:""},cp28592:"iso88592",iso88593:{type:"_sbcs",chars:""},cp28593:"iso88593",iso88594:{type:"_sbcs",chars:""},cp28594:"iso88594",iso88595:{type:"_sbcs",chars:""},cp28595:"iso88595",iso88596:{type:"_sbcs",chars:""},cp28596:"iso88596",iso88597:{type:"_sbcs",chars:""},cp28597:"iso88597",iso88598:{type:"_sbcs",chars:""},cp28598:"iso88598",iso88599:{type:"_sbcs",chars:""},cp28599:"iso88599",iso885910:{type:"_sbcs",chars:""},cp28600:"iso885910",iso885911:{type:"_sbcs",chars:""},cp28601:"iso885911",iso885913:{type:"_sbcs",chars:""},cp28603:"iso885913",iso885914:{type:"_sbcs",chars:""},cp28604:"iso885914",iso885915:{type:"_sbcs",chars:""},cp28605:"iso885915",iso885916:{type:"_sbcs",chars:""},cp28606:"iso885916",cp437:{type:"_sbcs",chars:""},ibm437:"cp437",csibm437:"cp437",cp737:{type:"_sbcs",chars:""},ibm737:"cp737",csibm737:"cp737",cp775:{type:"_sbcs",chars:""},ibm775:"cp775",csibm775:"cp775",cp850:{type:"_sbcs",chars:""},ibm850:"cp850",csibm850:"cp850",cp852:{type:"_sbcs",chars:""},ibm852:"cp852",csibm852:"cp852",cp855:{type:"_sbcs",chars:""},ibm855:"cp855",csibm855:"cp855",cp856:{type:"_sbcs",chars:""},ibm856:"cp856",csibm856:"cp856",cp857:{type:"_sbcs",chars:""},ibm857:"cp857",csibm857:"cp857",cp858:{type:"_sbcs",chars:""},ibm858:"cp858",csibm858:"cp858",cp860:{type:"_sbcs",chars:""},ibm860:"cp860",csibm860:"cp860",cp861:{type:"_sbcs",chars:""},ibm861:"cp861",csibm861:"cp861",cp862:{type:"_sbcs",chars:""},ibm862:"cp862",csibm862:"cp862",cp863:{type:"_sbcs",chars:""},ibm863:"cp863",csibm863:"cp863",cp864:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`},ibm864:"cp864",csibm864:"cp864",cp865:{type:"_sbcs",chars:""},ibm865:"cp865",csibm865:"cp865",cp866:{type:"_sbcs",chars:""},ibm866:"cp866",csibm866:"cp866",cp869:{type:"_sbcs",chars:""},ibm869:"cp869",csibm869:"cp869",cp922:{type:"_sbcs",chars:""},ibm922:"cp922",csibm922:"cp922",cp1046:{type:"_sbcs",chars:""},ibm1046:"cp1046",csibm1046:"cp1046",cp1124:{type:"_sbcs",chars:""},ibm1124:"cp1124",csibm1124:"cp1124",cp1125:{type:"_sbcs",chars:""},ibm1125:"cp1125",csibm1125:"cp1125",cp1129:{type:"_sbcs",chars:""},ibm1129:"cp1129",csibm1129:"cp1129",cp1133:{type:"_sbcs",chars:""},ibm1133:"cp1133",csibm1133:"cp1133",cp1161:{type:"_sbcs",chars:""},ibm1161:"cp1161",csibm1161:"cp1161",cp1162:{type:"_sbcs",chars:""},ibm1162:"cp1162",csibm1162:"cp1162",cp1163:{type:"_sbcs",chars:""},ibm1163:"cp1163",csibm1163:"cp1163",maccroatian:{type:"_sbcs",chars:""},maccyrillic:{type:"_sbcs",chars:""},macgreek:{type:"_sbcs",chars:""},maciceland:{type:"_sbcs",chars:""},macroman:{type:"_sbcs",chars:""},macromania:{type:"_sbcs",chars:""},macthai:{type:"_sbcs",chars:"\uFEFF"},macturkish:{type:"_sbcs",chars:""},macukraine:{type:"_sbcs",chars:""},koi8r:{type:"_sbcs",chars:""},koi8u:{type:"_sbcs",chars:""},koi8ru:{type:"_sbcs",chars:""},koi8t:{type:"_sbcs",chars:""},armscii8:{type:"_sbcs",chars:")(.,-"},rk1048:{type:"_sbcs",chars:""},tcvn:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`},georgianacademy:{type:"_sbcs",chars:""},georgianps:{type:"_sbcs",chars:""},pt154:{type:"_sbcs",chars:""},viscii:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`},iso646cn:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}`},iso646jp:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_\`abcdefghijklmnopqrstuvwxyz{|}`},hproman8:{type:"_sbcs",chars:""},macintosh:{type:"_sbcs",chars:""},ascii:{type:"_sbcs",chars:""},tis620:{type:"_sbcs",chars:""}}),Sn}var Tn={},bs;function Du(){if(bs)return Tn;bs=1;var s=Ze().Buffer;Tn._dbcs=l;for(var t=-1,r=-2,e=-10,n=-1e3,i=new Array(256),f=-1,a=0;a<256;a++)i[a]=t;function l(u,h){if(this.encodingName=u.encodingName,!u)throw new Error("DBCS codec is called without the data.");if(!u.table)throw new Error("Encoding '"+this.encodingName+"' has no data.");var v=u.table();this.decodeTables=[],this.decodeTables[0]=i.slice(0),this.decodeTableSeq=[];for(var w=0;w<v.length;w++)this._addDecodeChunk(v[w]);if(typeof u.gb18030=="function"){this.gb18030=u.gb18030();var A=this.decodeTables.length;this.decodeTables.push(i.slice(0));var _=this.decodeTables.length;this.decodeTables.push(i.slice(0));for(var E=this.decodeTables[0],w=129;w<=254;w++)for(var x=this.decodeTables[n-E[w]],g=48;g<=57;g++){if(x[g]===t)x[g]=n-A;else if(x[g]>n)throw new Error("gb18030 decode tables conflict at byte 2");for(var S=this.decodeTables[n-x[g]],B=129;B<=254;B++){if(S[B]===t)S[B]=n-_;else{if(S[B]===n-_)continue;if(S[B]>n)throw new Error("gb18030 decode tables conflict at byte 3")}for(var k=this.decodeTables[n-S[B]],D=48;D<=57;D++)k[D]===t&&(k[D]=r)}}}this.defaultCharUnicode=h.defaultCharUnicode,this.encodeTable=[],this.encodeTableSeq=[];var $={};if(u.encodeSkipVals)for(var w=0;w<u.encodeSkipVals.length;w++){var j=u.encodeSkipVals[w];if(typeof j=="number")$[j]=!0;else for(var g=j.from;g<=j.to;g++)$[g]=!0}if(this._fillEncodeTable(0,0,$),u.encodeAdd)for(var Q in u.encodeAdd)Object.prototype.hasOwnProperty.call(u.encodeAdd,Q)&&this._setEncodeChar(Q.charCodeAt(0),u.encodeAdd[Q]);this.defCharSB=this.encodeTable[0][h.defaultCharSingleByte.charCodeAt(0)],this.defCharSB===t&&(this.defCharSB=this.encodeTable[0]["?"]),this.defCharSB===t&&(this.defCharSB=63)}l.prototype.encoder=c,l.prototype.decoder=o,l.prototype._getDecodeTrieNode=function(u){for(var h=[];u>0;u>>>=8)h.push(u&255);h.length==0&&h.push(0);for(var v=this.decodeTables[0],w=h.length-1;w>0;w--){var A=v[h[w]];if(A==t)v[h[w]]=n-this.decodeTables.length,this.decodeTables.push(v=i.slice(0));else if(A<=n)v=this.decodeTables[n-A];else throw new Error("Overwrite byte in "+this.encodingName+", addr: "+u.toString(16))}return v},l.prototype._addDecodeChunk=function(u){var h=parseInt(u[0],16),v=this._getDecodeTrieNode(h);h=h&255;for(var w=1;w<u.length;w++){var A=u[w];if(typeof A=="string")for(var _=0;_<A.length;){var E=A.charCodeAt(_++);if(55296<=E&&E<56320){var x=A.charCodeAt(_++);if(56320<=x&&x<57344)v[h++]=65536+(E-55296)*1024+(x-56320);else throw new Error("Incorrect surrogate pair in "+this.encodingName+" at chunk "+u[0])}else if(4080<E&&E<=4095){for(var g=4095-E+2,S=[],B=0;B<g;B++)S.push(A.charCodeAt(_++));v[h++]=e-this.decodeTableSeq.length,this.decodeTableSeq.push(S)}else v[h++]=E}else if(typeof A=="number")for(var k=v[h-1]+1,_=0;_<A;_++)v[h++]=k++;else throw new Error("Incorrect type '"+typeof A+"' given in "+this.encodingName+" at chunk "+u[0])}if(h>255)throw new Error("Incorrect chunk in "+this.encodingName+" at addr "+u[0]+": too long"+h)},l.prototype._getEncodeBucket=function(u){var h=u>>8;return this.encodeTable[h]===void 0&&(this.encodeTable[h]=i.slice(0)),this.encodeTable[h]},l.prototype._setEncodeChar=function(u,h){var v=this._getEncodeBucket(u),w=u&255;v[w]<=e?this.encodeTableSeq[e-v[w]][f]=h:v[w]==t&&(v[w]=h)},l.prototype._setEncodeSequence=function(u,h){var v=u[0],w=this._getEncodeBucket(v),A=v&255,_;w[A]<=e?_=this.encodeTableSeq[e-w[A]]:(_={},w[A]!==t&&(_[f]=w[A]),w[A]=e-this.encodeTableSeq.length,this.encodeTableSeq.push(_));for(var E=1;E<u.length-1;E++){var x=_[v];typeof x=="object"?_=x:(_=_[v]={},x!==void 0&&(_[f]=x))}v=u[u.length-1],_[v]=h},l.prototype._fillEncodeTable=function(u,h,v){for(var w=this.decodeTables[u],A=!1,_={},E=0;E<256;E++){var x=w[E],g=h+E;if(!v[g])if(x>=0)this._setEncodeChar(x,g),A=!0;else if(x<=n){var S=n-x;if(!_[S]){var B=g<<8>>>0;this._fillEncodeTable(S,B,v)?A=!0:_[S]=!0}}else x<=e&&(this._setEncodeSequence(this.decodeTableSeq[e-x],g),A=!0)}return A};function c(u,h){this.leadSurrogate=-1,this.seqObj=void 0,this.encodeTable=h.encodeTable,this.encodeTableSeq=h.encodeTableSeq,this.defaultCharSingleByte=h.defCharSB,this.gb18030=h.gb18030}c.prototype.write=function(u){for(var h=s.alloc(u.length*(this.gb18030?4:3)),v=this.leadSurrogate,w=this.seqObj,A=-1,_=0,E=0;;){if(A===-1){if(_==u.length)break;var x=u.charCodeAt(_++)}else{var x=A;A=-1}if(55296<=x&&x<57344)if(x<56320)if(v===-1){v=x;continue}else v=x,x=t;else v!==-1?(x=65536+(v-55296)*1024+(x-56320),v=-1):x=t;else v!==-1&&(A=x,x=t,v=-1);var g=t;if(w!==void 0&&x!=t){var S=w[x];if(typeof S=="object"){w=S;continue}else typeof S=="number"?g=S:S==null&&(S=w[f],S!==void 0&&(g=S,A=x));w=void 0}else if(x>=0){var B=this.encodeTable[x>>8];if(B!==void 0&&(g=B[x&255]),g<=e){w=this.encodeTableSeq[e-g];continue}if(g==t&&this.gb18030){var k=d(this.gb18030.uChars,x);if(k!=-1){var g=this.gb18030.gbChars[k]+(x-this.gb18030.uChars[k]);h[E++]=129+Math.floor(g/12600),g=g%12600,h[E++]=48+Math.floor(g/1260),g=g%1260,h[E++]=129+Math.floor(g/10),g=g%10,h[E++]=48+g;continue}}}g===t&&(g=this.defaultCharSingleByte),g<256?h[E++]=g:g<65536?(h[E++]=g>>8,h[E++]=g&255):g<16777216?(h[E++]=g>>16,h[E++]=g>>8&255,h[E++]=g&255):(h[E++]=g>>>24,h[E++]=g>>>16&255,h[E++]=g>>>8&255,h[E++]=g&255)}return this.seqObj=w,this.leadSurrogate=v,h.slice(0,E)},c.prototype.end=function(){if(!(this.leadSurrogate===-1&&this.seqObj===void 0)){var u=s.alloc(10),h=0;if(this.seqObj){var v=this.seqObj[f];v!==void 0&&(v<256?u[h++]=v:(u[h++]=v>>8,u[h++]=v&255)),this.seqObj=void 0}return this.leadSurrogate!==-1&&(u[h++]=this.defaultCharSingleByte,this.leadSurrogate=-1),u.slice(0,h)}},c.prototype.findIdx=d;function o(u,h){this.nodeIdx=0,this.prevBytes=[],this.decodeTables=h.decodeTables,this.decodeTableSeq=h.decodeTableSeq,this.defaultCharUnicode=h.defaultCharUnicode,this.gb18030=h.gb18030}o.prototype.write=function(u){for(var h=s.alloc(u.length*2),v=this.nodeIdx,w=this.prevBytes,A=this.prevBytes.length,_=-this.prevBytes.length,E,x=0,g=0;x<u.length;x++){var S=x>=0?u[x]:w[x+A],E=this.decodeTables[v][S];if(!(E>=0))if(E===t)E=this.defaultCharUnicode.charCodeAt(0),x=_;else if(E===r){if(x>=3)var B=(u[x-3]-129)*12600+(u[x-2]-48)*1260+(u[x-1]-129)*10+(S-48);else var B=(w[x-3+A]-129)*12600+((x-2>=0?u[x-2]:w[x-2+A])-48)*1260+((x-1>=0?u[x-1]:w[x-1+A])-129)*10+(S-48);var k=d(this.gb18030.gbChars,B);E=this.gb18030.uChars[k]+B-this.gb18030.gbChars[k]}else if(E<=n){v=n-E;continue}else if(E<=e){for(var D=this.decodeTableSeq[e-E],$=0;$<D.length-1;$++)E=D[$],h[g++]=E&255,h[g++]=E>>8;E=D[D.length-1]}else throw new Error("iconv-lite internal error: invalid decoding table value "+E+" at "+v+"/"+S);if(E>=65536){E-=65536;var j=55296|E>>10;h[g++]=j&255,h[g++]=j>>8,E=56320|E&1023}h[g++]=E&255,h[g++]=E>>8,v=0,_=x+1}return this.nodeIdx=v,this.prevBytes=_>=0?Array.prototype.slice.call(u,_):w.slice(_+A).concat(Array.prototype.slice.call(u)),h.slice(0,g).toString("ucs2")},o.prototype.end=function(){for(var u="";this.prevBytes.length>0;){u+=this.defaultCharUnicode;var h=this.prevBytes.slice(1);this.prevBytes=[],this.nodeIdx=0,h.length>0&&(u+=this.write(h))}return this.prevBytes=[],this.nodeIdx=0,u};function d(u,h){if(u[0]>h)return-1;for(var v=0,w=u.length;v<w-1;){var A=v+(w-v+1>>1);u[A]<=h?v=A:w=A}return v}return Tn}const Lu=[["0","\0",128],["a1","",62],["8140","",9,""],["8180",""],["81b8",""],["81c8",""],["81da",""],["81f0",""],["81fc",""],["824f","",9],["8260","",25],["8281","",25],["829f","",82],["8340","",62],["8380","",22],["839f","",16,"",6],["83bf","",16,"",6],["8440","",5,"",25],["8470","",5,"",7],["8480","",17],["849f",""],["8740","",19,"",9],["875f",""],["877e",""],["8780","",4,""],["889f",""],["8940",""],["8980",""],["8a40",""],["8a80",""],["8b40",""],["8b80",""],["8c40",""],["8c80",""],["8d40",""],["8d80",""],["8e40",""],["8e80",""],["8f40",""],["8f80",""],["9040",""],["9080",""],["9140",""],["9180",""],["9240",""],["9280",""],["9340",""],["9380",""],["9440",""],["9480",""],["9540",""],["9580",""],["9640",""],["9680",""],["9740",""],["9780",""],["9840",""],["989f",""],["9940",""],["9980",""],["9a40",""],["9a80",""],["9b40",""],["9b80",""],["9c40",""],["9c80",""],["9d40",""],["9d80",""],["9e40",""],["9e80",""],["9f40",""],["9f80",""],["e040",""],["e080",""],["e140",""],["e180",""],["e240",""],["e280",""],["e340",""],["e380",""],["e440",""],["e480",""],["e540",""],["e580",""],["e640",""],["e680",""],["e740",""],["e780",""],["e840",""],["e880",""],["e940",""],["e980",""],["ea40",""],["ea80",""],["ed40",""],["ed80",""],["ee40",""],["ee80",""],["eeef","",9,""],["f040","",62],["f080","",124],["f140","",62],["f180","",124],["f240","",62],["f280","",124],["f340","",62],["f380","",124],["f440","",62],["f480","",124],["f540","",62],["f580","",124],["f640","",62],["f680","",124],["f740","",62],["f780","",124],["f840","",62],["f880","",124],["f940",""],["fa40","",9,"",9,""],["fa80",""],["fb40",""],["fb80",""],["fc40",""]],Ou=JSON.parse('[["0","\\u0000",127],["8ea1","",62],["a1a1","",9,""],["a2a1",""],["a2ba",""],["a2ca",""],["a2dc",""],["a2f2",""],["a2fe",""],["a3b0","",9],["a3c1","",25],["a3e1","",25],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a7a1","",5,"",25],["a7d1","",5,"",25],["a8a1",""],["ada1","",19,"",9],["adc0",""],["addf","",4,""],["b0a1",""],["b1a1",""],["b2a1",""],["b3a1",""],["b4a1",""],["b5a1",""],["b6a1",""],["b7a1",""],["b8a1",""],["b9a1",""],["baa1",""],["bba1",""],["bca1",""],["bda1",""],["bea1",""],["bfa1",""],["c0a1",""],["c1a1",""],["c2a1",""],["c3a1",""],["c4a1",""],["c5a1",""],["c6a1",""],["c7a1",""],["c8a1",""],["c9a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1",""],["d2a1",""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fcf1","",9,""],["8fa2af",""],["8fa2c2",""],["8fa2eb",""],["8fa6e1",""],["8fa6e7",""],["8fa6e9",""],["8fa6ec",""],["8fa6f1",""],["8fa7c2","",10,""],["8fa7f2","",10,""],["8fa9a1",""],["8fa9a4",""],["8fa9a6",""],["8fa9a8",""],["8fa9ab",""],["8fa9af",""],["8fa9c1",""],["8faaa1",""],["8faaba",""],["8faba1",""],["8fabbd",""],["8fabc5",""],["8fb0a1",""],["8fb1a1",""],["8fb2a1","",4,""],["8fb3a1",""],["8fb4a1",""],["8fb5a1",""],["8fb6a1","",5,"",4,""],["8fb7a1","",4,""],["8fb8a1",""],["8fb9a1",""],["8fbaa1","",4,""],["8fbba1",""],["8fbca1","",4,""],["8fbda1","",4,""],["8fbea1","",4,""],["8fbfa1",""],["8fc0a1",""],["8fc1a1",""],["8fc2a1",""],["8fc3a1","",4,""],["8fc4a1",""],["8fc5a1",""],["8fc6a1",""],["8fc7a1",""],["8fc8a1",""],["8fc9a1","",4,"",4,""],["8fcaa1",""],["8fcba1",""],["8fcca1","",9,""],["8fcda1","",5,""],["8fcea1","",6,""],["8fcfa1",""],["8fd0a1",""],["8fd1a1",""],["8fd2a1","",5],["8fd3a1",""],["8fd4a1","",4,""],["8fd5a1",""],["8fd6a1",""],["8fd7a1",""],["8fd8a1",""],["8fd9a1","",4,"",6,""],["8fdaa1","",4,""],["8fdba1","",6,""],["8fdca1","",4,""],["8fdda1","",4,""],["8fdea1","",4,""],["8fdfa1",""],["8fe0a1",""],["8fe1a1","",4,""],["8fe2a1",""],["8fe3a1","",5,"",4,""],["8fe4a1","",4,""],["8fe5a1","",4,""],["8fe6a1",""],["8fe7a1",""],["8fe8a1","",4,""],["8fe9a1","",4],["8feaa1","",4,""],["8feba1","",4,""],["8feca1",""],["8feda1","",4,"",4,""]]'),Fn=JSON.parse('[["0","\\u0000",127,""],["8140","",5,"",9,"",6,""],["8180","",6,"",4,"",4,"",5,""],["8240","",4,"",8,"",4,"",11],["8280","",10,"",4,"",7,"",5,"",8,"",20,"",4,"",6,""],["8340","",17,"",5,"",10,"",4,"",9,""],["8380","",5,"",13,"",28,"",4,"",4,"",5],["8440","",5,"",5,""],["8480","",9,"",4,"",6,"",6,"",9,"",5,"",10,"",7,""],["8540","",9,""],["8580","",4,"",6,"",4,"",4,"",7,""],["8640","",4,"",5,"",4,"",5,""],["8680","",4,"",4,"",5,"",6,"",8,"",4,"",4,"",4,""],["8740","",7,"",11,"",4,"",4],["8780","",7,"",6,"",14,"",10,"",6,"",12,"",8,"",5,"",6],["8840","",9,"",4,"",4,""],["8880","",4,"",6,"",8,"",6,"",7,"",4,"",4,"",7],["8940","",5,"",6,"",4,"",5,"",4,"",16,""],["8980","",4,"",4,"",7,"",17,"",10,"",13,"",5,"",7,"",4,""],["8a40","",4,"",12,""],["8a80","",5,"",6,"",4,"",11,"",6,"",4,"",4,"",9,"",5],["8b40","",8,"",17,"",6,"",13,""],["8b80","",4,"",4,"",5,"",4,"",4,"",22,"",11,"",25,"",7,"",6],["8c40","",7,""],["8c80","",8,"",4,"",6,"",6,"",6,"",4,"",4,"",4],["8d40","",5,"",5,"",5,"",6,"",9,"",4],["8d80","",5,"",4,"",4,"",4,"",7,"",7,"",10,"",10,"",12,"",21,""],["8e40","",21,"",12,"",6,"",12,""],["8e80","",4,"",7,"",4,"",4,"",5,"",6,"",4,"",14,"",4,"",4,"",6],["8f40","",5,"",11,"",8,""],["8f80","",6,"",14,"",5,"",5,"",4,""],["9040","",4,"",4,"",6,""],["9080","",7,"",4,"",4,"",4,"",4,"",18,"",6],["9140","",6,"",6,"",18,"",4,""],["9180","",6,"",8,"",9,"",5,"",4,"",4,"",16,"",13,"",8,"",5,"",4,""],["9240","",6,"",5,""],["9280","",5,"",7,"",6,""],["9340","",6,"",4,"",4,"",5,""],["9380","",5,"",4,"",6,"",4,"",7,"",9,"",6,"",8,"",4,"",6,""],["9440","",24,"",7,"",7,"",4,"",8],["9480","",4,"",4,"",14,"",7,"",7,""],["9540","",4,"",4,"",6,""],["9580","",4,"",4,"",8,"",4,"",4,"",25,"",7,"",5,""],["9640","",5,"",4,""],["9680","",7,"",9,"",7,"",4,"",6,"",6,"",5],["9740","",7,"",8,"",7,"",9,""],["9780","",6,"",5,"",4,"",9,"",4,"",11,"",7,"",16,""],["9840","",4,"",5,"",9,""],["9880","",7,"",5,"",11,"",9,"",9,"",11,"",5,"",5,"",6,"",4,"",7,"",6,""],["9940","",4,"",10,"",6,"",8,"",4,"",7,"",5],["9980","",114,"",6],["9a40","",11,"",7,"",13,""],["9a80","",4,"",7,"",7,"",6,"",4,"",4,"",7,"",6,"",4,"",4,""],["9b40","",4,""],["9b80","",5,"",4,"",4,"",5,""],["9c40","",7,""],["9c80","",7,"",7,"",10,"",14,"",4,"",6,"",5],["9d40","",7,"",4,"",9,"",6,""],["9d80","",9,"",5,"",6,"",12,"",4,"",10,"",5,"",5,"",6,"",10,""],["9e40","",7,"",32,"",7,"",6,"",6],["9e80","",9,"",17,"",13,"",11,"",12,"",12,""],["9f40","",6,"",10,"",4,"",10,"",7,""],["9f80","",13,"",12,"",4,"",4,"",5,"",4,"",4,"",6,"",5,"",8,"",9,"",4],["a040","",9,"",5,"",9,"",11,"",19],["a080","",9,"",6,"",4,"",11,"",11,"",6,""],["a1a1","",7,""],["a2a1","",9],["a2b1","",19,"",19,"",9],["a2e5","",9],["a2f1","",11],["a3a1","",88,""],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a6e0",""],["a6ee",""],["a6f4",""],["a7a1","",5,"",25],["a7d1","",5,"",25],["a840","",35,"",6],["a880","",7,""],["a8a1",""],["a8bd",""],["a8c0",""],["a8c5","",36],["a940","",8,""],["a959",""],["a95c",""],["a960","",9,"",8],["a980","",4,""],["a996",""],["a9a4","",75],["aa40","",5,"",5,"",8],["aa80","",7,"",10,""],["ab40","",11,"",4,"",5,"",4],["ab80","",6,"",4],["ac40","",10,"",8,"",5,"",4,"",11],["ac80","",6,"",12,"",4,""],["ad40","",10,"",7,"",15,"",12],["ad80","",9,"",8,"",6,""],["ae40","",6,"",7,"",4,""],["ae80","",7,"",6,"",4,""],["af40","",4,""],["af80",""],["b040","",6,"",5,"",4,"",6,"",7,""],["b080","",7,"",8,"",9,""],["b140","",4,"",7,"",10,""],["b180","",4,"",7,"",7,""],["b240","",11,"",5,"",11,"",4],["b280","",12,"",8,"",4,""],["b340","",5,""],["b380","",11,"",7,"",6,""],["b440","",7,"",9],["b480","",4,"",5,"",6,""],["b540","",5,"",9,"",4,"",14,"",4,"",8,""],["b580","",6,"",4,""],["b640","",6,"",11,"",10,"",4,"",5,""],["b680","",6,"",4,""],["b740","",14,"",5,"",9,"",4,"",16],["b780","",6,""],["b840","",4,"",10,"",10,"",9,"",5,""],["b880","",4,""],["b940","",5,"",10,"",6,""],["b980","",7,""],["ba40","",4,"",4,"",7,"",5,""],["ba80","",4,"",5,"",12,"",5,""],["bb40","",9,"",36,"",5,"",9],["bb80","",6,"",4,""],["bc40","",6,"",6,"",5,"",7,"",13,"",5],["bc80","",14,"",6,""],["bd40","",54,"",7],["bd80","",32,""],["be40","",12,"",6,"",42],["be80","",32,""],["bf40","",62],["bf80","",4,"",4,"",21,""],["c040","",35,"",23,""],["c080","",6,"",9,""],["c140","",4,"",7,"",4,"",4,"",6,""],["c180","",4,"",4,"",5,""],["c240","",6,"",5,""],["c280","",13,"",5,"",11,""],["c340","",5,"",4,"",6,""],["c380","",12,"",4,""],["c440","",5,"",4,"",4,"",5,"",4,""],["c480","",7,"",5,"",6,""],["c540","",14,"",4,"",5,"",4,"",5,""],["c580","",7,"",7,""],["c640",""],["c680","",4,"",9,""],["c740","",4,"",4,"",6,"",6,"",6,""],["c780",""],["c840","",4,"",5,"",5,"",7,"",5,"",7,""],["c880","",6,"",4,"",4,""],["c940","",4,"",7,"",12,""],["c980","",4,"",4,"",10,""],["ca40","",8,"",8,"",9,"",4,"",10],["ca80","",4,"",8,""],["cb40","",6,"",10,"",6,"",5,"",6,"",6,"",4,""],["cb80","",5,"",6,"",14,""],["cc40","",4,"",10,"",15,"",13,""],["cc80","",11,"",4,"",7,""],["cd40","",6,"",6,"",4,"",5,"",4,"",4,""],["cd80",""],["ce40","",6,"",5,"",7,""],["ce80","",4,"",6,"",4,""],["cf40","",4,"",4,"",6,"",9],["cf80","",5,"",7,"",4,""],["d040","",13,"",5,"",5,"",5,"",6,""],["d080","",4,"",4,"",5,""],["d140","",4,"",4,"",6,"",5],["d180","",4,"",4,"",4,""],["d240","",8,"",24,"",5,"",19,""],["d280","",26,""],["d340","",30,"",6],["d380","",4,"",5,"",21,""],["d440","",31,"",8,"",21],["d480","",25,"",6,""],["d540","",7,"",7,"",46],["d580","",32,""],["d640","",34,"",27],["d680","",30,""],["d740","",31,"",4,"",25],["d780","",24,""],["d840","",8,"",7,"",5,"",6,"",6,"",6,""],["d880","",6,"",20,""],["d940","",62],["d980","",32,""],["da40","",14,"",8,"",4,"",9,""],["da80","",12,""],["db40","",6,"",7,"",4,""],["db80","",4,"",5,"",11,""],["dc40","",4,"",6,"",6,"",11,"",6,"",7],["dc80","",10,"",21,""],["dd40","",62],["dd80","",32,""],["de40","",32,""],["de80","",4,""],["df40","",5,"",4,"",4,"",5,"",4,"",6,""],["df80","",4,""],["e040","",19,""],["e080","",10,"",6,"",8,""],["e140","",4,"",6,"",5,"",5,""],["e180","",10,"",9,"",8,""],["e240","",62],["e280","",32,"",5,""],["e340","",45,"",16],["e380","",7,"",24,""],["e440","",5,"",24,"",31],["e480","",32,""],["e540","",51,"",10],["e580","",31,""],["e640","",34,"",27],["e680","",29,""],["e740","",7,"",54],["e780","",32,"",6,"",4,""],["e840","",14,"",43,""],["e880","",20,""],["e940","",7,"",42],["e980","",32,""],["ea40","",27,"",6,""],["ea80","",4,"",12,""],["eb40","",9,"",7,"",9,"",6,""],["eb80","",4,""],["ec40","",8,"",4,"",18,"",7],["ec80","",4,"",7,"",4,"",4,""],["ed40","",6,"",46],["ed80","",4,"",23,""],["ee40","",62],["ee80","",32,"",4,"",6,""],["ef40","",5,"",37,"",4],["ef80","",30,"",4,"",8,""],["f040","",4,"",28,"",26],["f080","",9,"",12,"",4,"",6,""],["f140","",10,"",47],["f180","",32,""],["f240","",62],["f280","",32,""],["f340","",17,"",6,"",4,""],["f380","",8,"",6,""],["f440","",5,"",10,"",10,"",7,"",5],["f480","",32,""],["f540","",62],["f580","",32,""],["f640","",62],["f680","",32,"",5,"",5,"",4,"",7,""],["f740","",62],["f780","",4,"",4,""],["f840","",62],["f880","",32],["f940","",62],["f980","",32],["fa40","",62],["fa80","",32],["fb40","",27,"",9,""],["fb80","",5,"",8,"",5,""],["fc40","",8,"",4,"",8,"",6],["fc80","",4,"",5,"",8,""],["fd40","",4,"",4,"",10,"",38],["fd80","",5,"",11,"",4,""],["fe40",""]]'),ys=[["a140","",62],["a180","",32],["a240","",62],["a280","",32],["a2ab","",5],["a2e3",""],["a2ef",""],["a2fd",""],["a340","",62],["a380","",31,""],["a440","",62],["a480","",32],["a4f4","",10],["a540","",62],["a580","",32],["a5f7","",7],["a640","",62],["a680","",32],["a6b9","",7],["a6d9","",6],["a6ec",""],["a6f3",""],["a6f6","",8],["a740","",62],["a780","",32],["a7c2","",14],["a7f2","",12],["a896","",10],["a8bc",""],["a8bf",""],["a8c1",""],["a8ea","",20],["a958",""],["a95b",""],["a95d",""],["a989","",11],["a997","",12],["a9f0","",14],["aaa1","",93],["aba1","",93],["aca1","",93],["ada1","",93],["aea1","",93],["afa1","",93],["d7fa","",4],["f8a1","",93],["f9a1","",93],["faa1","",93],["fba1","",93],["fca1","",93],["fda1","",93],["fe50",""],["fe80","",6,"",93],["8135f437",""]],Nu=[128,165,169,178,184,216,226,235,238,244,248,251,253,258,276,284,300,325,329,334,364,463,465,467,469,471,473,475,477,506,594,610,712,716,730,930,938,962,970,1026,1104,1106,8209,8215,8218,8222,8231,8241,8244,8246,8252,8365,8452,8454,8458,8471,8482,8556,8570,8596,8602,8713,8720,8722,8726,8731,8737,8740,8742,8748,8751,8760,8766,8777,8781,8787,8802,8808,8816,8854,8858,8870,8896,8979,9322,9372,9548,9588,9616,9622,9634,9652,9662,9672,9676,9680,9702,9735,9738,9793,9795,11906,11909,11913,11917,11928,11944,11947,11951,11956,11960,11964,11979,12284,12292,12312,12319,12330,12351,12436,12447,12535,12543,12586,12842,12850,12964,13200,13215,13218,13253,13263,13267,13270,13384,13428,13727,13839,13851,14617,14703,14801,14816,14964,15183,15471,15585,16471,16736,17208,17325,17330,17374,17623,17997,18018,18212,18218,18301,18318,18760,18811,18814,18820,18823,18844,18848,18872,19576,19620,19738,19887,40870,59244,59336,59367,59413,59417,59423,59431,59437,59443,59452,59460,59478,59493,63789,63866,63894,63976,63986,64016,64018,64021,64025,64034,64037,64042,65074,65093,65107,65112,65127,65132,65375,65510,65536],Pu=[0,36,38,45,50,81,89,95,96,100,103,104,105,109,126,133,148,172,175,179,208,306,307,308,309,310,311,312,313,341,428,443,544,545,558,741,742,749,750,805,819,820,7922,7924,7925,7927,7934,7943,7944,7945,7950,8062,8148,8149,8152,8164,8174,8236,8240,8262,8264,8374,8380,8381,8384,8388,8390,8392,8393,8394,8396,8401,8406,8416,8419,8424,8437,8439,8445,8482,8485,8496,8521,8603,8936,8946,9046,9050,9063,9066,9076,9092,9100,9108,9111,9113,9131,9162,9164,9218,9219,11329,11331,11334,11336,11346,11361,11363,11366,11370,11372,11375,11389,11682,11686,11687,11692,11694,11714,11716,11723,11725,11730,11736,11982,11989,12102,12336,12348,12350,12384,12393,12395,12397,12510,12553,12851,12962,12973,13738,13823,13919,13933,14080,14298,14585,14698,15583,15847,16318,16434,16438,16481,16729,17102,17122,17315,17320,17402,17418,17859,17909,17911,17915,17916,17936,17939,17961,18664,18703,18814,18962,19043,33469,33470,33471,33484,33485,33490,33497,33501,33505,33513,33520,33536,33550,37845,37921,37948,38029,38038,38064,38065,38066,38069,38075,38076,38078,39108,39109,39113,39114,39115,39116,39265,39394,189e3],Uu={uChars:Nu,gbChars:Pu},Hu=JSON.parse('[["0","\\u0000",127],["8141","",4,"",6,""],["8161","",9,"",5,""],["8181","",18,"",4,"",6,"",5,"",6,"",7,"",7,"",4,"",4,""],["8241","",7,"",5],["8261","",6,"",5,""],["8281","",7,"",7,"",4,"",10,"",5,"",17,"",7,"",6,"",7,"",18],["8341","",5,"",5,"",7],["8361","",18,""],["8381","",4,"",6,"",5,"",5,"",46,"",6,"",5,"",8],["8441","",5,"",8],["8461","",18],["8481","",7,"",6,"",5,"",10,"",5,"",18,"",5,"",6,"",5,"",26,""],["8541","",5,"",4,"",6,"",4],["8561","",5,"",5,"",6,""],["8581","",6,"",6,"",9,"",26,"",29,"",6,"",5,""],["8641","",6,"",5,""],["8661","",6,"",10],["8681","",22,"",4,"",6,"",5,"",6,"",22,"",4,""],["8741","",9,"",15],["8761","",18,""],["8781","",5,"",7,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",4],["8841","",4,"",5,"",6,"",4],["8861","",4,""],["8881","",15,"",4,"",6,"",5,"",54,""],["8941","",6,"",5,""],["8961","",10,"",5,""],["8981","",21,"",18,"",18,"",6,"",6,"",7,"",15],["8a41","",10,"",6,""],["8a61","",4,"",18,""],["8a81","",4,"",19,"",5,"",7,"",5,"",6,"",5,"",4,"",5,"",26,""],["8b41","",5,"",4,"",6,""],["8b61","",6,"",8],["8b81","",52,"",4,"",6,"",5,"",18,"",18],["8c41","",15,"",4],["8c61","",6,"",5,"",6,"",5],["8c81","",12,"",26,"",50,"",5,"",16],["8d41","",16,"",8],["8d61","",17,""],["8d81","",4,"",33,"",6,"",7,"",6,"",9,"",6,"",5,"",6,""],["8e41","",6,"",5,"",8],["8e61","",4,"",19],["8e81","",13,"",6,"",4,"",6,"",5,"",6,"",5,"",11,"",7,"",6,"",5,"",7],["8f41","",7,"",17],["8f61","",7,"",6,"",4],["8f81","",5,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",5],["9041","",6,"",5,""],["9061","",5,"",15],["9081","",12,"",6,"",5,"",4,"",6,"",4,"",5,"",11,"",33,""],["9141","",6,"",5],["9161","",9,"",5],["9181","",20,"",4,"",5,"",14,"",33,"",7,"",5,"",6],["9241","",7,"",4,""],["9261","",7,"",7,"",4],["9281","",21,"",18,"",6,"",7,"",6,"",35,""],["9341","",4,""],["9361","",6,"",8],["9381","",37,"",4,"",4,"",6,"",5,"",7,"",22,""],["9441","",5,"",5,"",8],["9461","",5,"",6,"",12],["9481","",5,"",6,"",6,"",9,"",22,"",4,"",6,"",10,"",6,"",24],["9541","",11,"",5,""],["9561","",6,"",5,""],["9581","",6,"",35,"",4,"",4,"",4,"",6,"",5,"",13,"",14],["9641","",23,""],["9661","",6,"",5,"",8],["9681","",10,"",5,"",13,"",33,"",6,"",44],["9741","",16,"",8],["9761","",17,"",7],["9781","",11,"",5,"",6,"",89,""],["9841","",16,"",5,""],["9861","",6,"",15],["9881","",21,"",6,"",5,"",4,"",6,"",5,"",6,"",5,"",6,"",5,""],["9941","",6,"",5,""],["9961","",6,"",5,""],["9981","",8,"",5,"",4,"",11,"",5,"",6,"",6,"",6,"",7,"",6,"",5,""],["9a41","",16],["9a61","",6,"",6,""],["9a81","",4,"",6,"",5,"",5,"",6,"",5,"",5,"",33,"",5,"",6,""],["9b41","",6,"",8],["9b61","",17,"",7],["9b81","",25,"",4,"",5,"",50,"",22,""],["9c41","",4,"",5,"",5],["9c61","",8,"",6,"",9],["9c81","",8,"",6,"",6,"",9,"",26,"",6,"",5,"",18,"",6,"",12],["9d41","",13,"",8],["9d61","",25],["9d81","",8,"",5,"",9,"",6,"",10,"",6,"",5,"",6,"",5,""],["9e41","",7,"",9,""],["9e61","",4,"",6,""],["9e81","",6,"",6,"",6,"",5,"",10,"",5,"",6,"",5,"",6,""],["9f41","",5,"",4,"",5,""],["9f61","",6,"",5,""],["9f81","",4,"",5,"",6,"",5,"",6,"",4,"",6,"",7,"",4,"",4,""],["a041","",5,"",6,""],["a061","",5,"",13],["a081","",4,"",4,"",4,"",6,"",5,"",6,"",5,"",26,"",4,"",5,"",7,""],["a141","",18,""],["a161","",6,"",5,""],["a181","",14,"",5,"",4,"",9,""],["a241","",5,"",18],["a261","",6,"",18],["a281","",7,"",6,"",7,""],["a341","",6,"",10,""],["a361","",6,"",16],["a381","",16,"",4,"",58,"",32,""],["a441","",5,""],["a461","",5,"",12],["a481","",28,"",93],["a541","",4,"",6,"",5,""],["a561","",17,"",5,""],["a581","",16,"",14,"",9],["a5b0","",9],["a5c1","",16,"",6],["a5e1","",16,"",6],["a641","",19,""],["a661","",5,"",5,"",6],["a681","",6,"",18,"",7],["a741","",4,"",6,"",7],["a761","",22,""],["a781","",6,"",5,"",7,"",9,"",9,"",4,"",5,"",4,""],["a841","",10,"",14],["a861","",18,"",6],["a881","",19,"",11,""],["a8a6",""],["a8a8",""],["a8b1","",27,"",25,"",14,""],["a941","",14,"",10],["a961","",18],["a981","",14,"",6,"",27,"",25,"",14,""],["aa41","",6,"",4,""],["aa61","",4,"",5,"",6,""],["aa81","",29,"",82],["ab41","",6,"",5,""],["ab61","",6,"",5,"",5],["ab81","",8,"",6,"",12,"",85],["ac41","",5,"",6,""],["ac61","",11,"",4],["ac81","",28,"",5,"",25],["acd1","",5,"",25],["ad41","",6,"",5,"",7],["ad61","",6,"",10,""],["ad81","",5,"",18,""],["ae41","",5,"",16],["ae61","",5,"",6,"",4],["ae81","",6,"",5,""],["af41","",19],["af61","",13,"",5,""],["af81","",5,"",6,"",5,""],["b041","",5,"",5,"",12],["b061","",5,"",19],["b081","",13,"",6,"",5,"",7,"",4,""],["b141","",6,"",5,""],["b161","",6,"",5,"",11],["b181","",14,"",6,""],["b241","",6,"",5,""],["b261","",18,"",5,""],["b281","",5,"",18,"",6,""],["b341","",19,""],["b361","",5,"",5,"",5],["b381","",5,"",5,"",19,"",4,""],["b441","",5,"",6,"",5],["b461","",6,"",10,""],["b481","",6,"",18,"",4,"",4,""],["b541","",14,"",5],["b561","",5,"",5,"",4],["b581","",6,"",5,"",11,""],["b641","",7,"",17],["b661","",15,""],["b681","",5,"",6,"",5,""],["b741","",13,"",6,""],["b761","",20,""],["b781","",6,"",14,""],["b841","",7,"",17],["b861","",8,"",13],["b881","",5,"",24,"",4,""],["b941","",6,"",5,""],["b961","",14,"",6,""],["b981","",22,"",4,"",4,""],["ba41","",5,"",6,""],["ba61","",5,"",4,"",5],["ba81","",6,"",9,""],["bb41","",4,"",5,"",4,""],["bb61","",6,"",5,""],["bb81","",31,""],["bc41","",17,""],["bc61","",5,"",6,""],["bc81","",4,"",6,"",5,"",5,"",4,""],["bd41","",7,"",7,""],["bd61","",5,"",13],["bd81","",5,"",25,""],["be41","",7,"",14],["be61","",7,"",7,""],["be81","",4,"",4,"",5,"",8,"",6,""],["bf41","",10,"",14],["bf61","",18,""],["bf81","",5,"",7,"",6,"",5,""],["c041","",5,"",6,"",5],["c061","",25],["c081","",6,"",5,"",7,""],["c141","",5,"",6,""],["c161","",19,""],["c181","",31,""],["c241","",4,"",5,""],["c261","",4,"",5,"",6,""],["c281","",5,"",7,"",9,""],["c341","",4],["c361","",4,"",5,"",11],["c381","",5,"",7,"",5,""],["c441","",7,"",7,""],["c461","",5,"",4],["c481","",5,"",11,""],["c541","",6,"",5,""],["c561","",6,"",5,"",4],["c581","",6,"",5,""],["c641","",6,"",5],["c6a1",""],["c7a1",""],["c8a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1","",5,"",4,""],["d2a1","",4,"",5,"",10,"",7,"",5,""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f5a1",""],["f6a1",""],["f7a1",""],["f8a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fda1",""]]'),vs=JSON.parse('[["0","\\u0000",127],["a140",""],["a1a1","",4,""],["a240","",7,""],["a2a1","",9,"",9,"",8,"",25,"",21],["a340","",16,"",6,"",16,"",6,"",10],["a3a1","",25,""],["a3e1",""],["a440",""],["a4a1",""],["a540",""],["a5a1",""],["a640",""],["a6a1",""],["a740",""],["a7a1",""],["a840",""],["a8a1",""],["a940",""],["a9a1",""],["aa40",""],["aaa1",""],["ab40",""],["aba1",""],["ac40",""],["aca1",""],["ad40",""],["ada1",""],["ae40",""],["aea1",""],["af40",""],["afa1",""],["b040",""],["b0a1",""],["b140",""],["b1a1",""],["b240",""],["b2a1",""],["b340",""],["b3a1",""],["b440",""],["b4a1",""],["b540",""],["b5a1",""],["b640",""],["b6a1",""],["b740",""],["b7a1",""],["b840",""],["b8a1",""],["b940",""],["b9a1",""],["ba40",""],["baa1",""],["bb40",""],["bba1",""],["bc40",""],["bca1",""],["bd40",""],["bda1",""],["be40",""],["bea1",""],["bf40",""],["bfa1",""],["c040",""],["c0a1",""],["c140",""],["c1a1",""],["c240",""],["c2a1",""],["c340",""],["c3a1",""],["c440",""],["c4a1",""],["c540",""],["c5a1",""],["c640",""],["c940",""],["c9a1",""],["ca40",""],["caa1",""],["cb40",""],["cba1",""],["cc40",""],["cca1",""],["cd40",""],["cda1",""],["ce40",""],["cea1",""],["cf40",""],["cfa1",""],["d040",""],["d0a1",""],["d140",""],["d1a1",""],["d240",""],["d2a1",""],["d340",""],["d3a1",""],["d440",""],["d4a1",""],["d540",""],["d5a1",""],["d640",""],["d6a1",""],["d740",""],["d7a1",""],["d840",""],["d8a1",""],["d940",""],["d9a1",""],["da40",""],["daa1",""],["db40",""],["dba1",""],["dc40",""],["dca1",""],["dd40",""],["dda1",""],["de40",""],["dea1",""],["df40",""],["dfa1",""],["e040",""],["e0a1",""],["e140",""],["e1a1",""],["e240",""],["e2a1",""],["e340",""],["e3a1",""],["e440",""],["e4a1",""],["e540",""],["e5a1",""],["e640",""],["e6a1",""],["e740",""],["e7a1",""],["e840",""],["e8a1",""],["e940",""],["e9a1",""],["ea40",""],["eaa1",""],["eb40",""],["eba1",""],["ec40",""],["eca1",""],["ed40",""],["eda1",""],["ee40",""],["eea1",""],["ef40",""],["efa1",""],["f040",""],["f0a1",""],["f140",""],["f1a1",""],["f240",""],["f2a1",""],["f340",""],["f3a1",""],["f440",""],["f4a1",""],["f540",""],["f5a1",""],["f640",""],["f6a1",""],["f740",""],["f7a1",""],["f840",""],["f8a1",""],["f940",""],["f9a1",""]]'),ju=[["8740",""],["8767",""],["87a1",""],["8840","",4,""],["88a1",""],["8940",""],["8943",""],["8946",""],["894c",""],["89a1",""],["89ab",""],["89b0",""],["89b5",""],["89c1",""],["89c5",""],["8a40",""],["8a43",""],["8a64",""],["8a76",""],["8aa1",""],["8aac",""],["8ab2",""],["8abb",""],["8ac9",""],["8ace",""],["8adf",""],["8af6",""],["8b40",""],["8b55",""],["8ba1",""],["8bde",""],["8c40",""],["8ca1",""],["8ca7",""],["8cc9",""],["8cce",""],["8ce6",""],["8d40",""],["8d42",""],["8da1",""],["8e40",""],["8ea1",""],["8f40",""],["8fa1",""],["9040",""],["90a1",""],["9140",""],["91a1",""],["9240",""],["92a1",""],["9340",""],["93a1",""],["9440",""],["94a1",""],["9540",""],["95a1",""],["9640",""],["96a1",""],["9740",""],["97a1",""],["9840",""],["98a1",""],["9940",""],["99a1",""],["9a40",""],["9aa1",""],["9b40",""],["9b62",""],["9ba1",""],["9c40",""],["9ca1",""],["9d40",""],["9da1",""],["9e40",""],["9ea1",""],["9ead",""],["9ec5",""],["9ef5",""],["9f40",""],["9f4f",""],["9fa1",""],["9fae",""],["9fb2",""],["9fc1",""],["9fc9",""],["9fdb",""],["9fe7",""],["9feb",""],["9ff0",""],["a040",""],["a055",""],["a058",""],["a05b",""],["a063",""],["a073",""],["a0a1",""],["a0a6",""],["a0ae",""],["a0b0",""],["a0d4",""],["a0e2",""],["a3c0","",31,""],["c6a1","",9,"",9,"",9,"",23],["c740","",58,""],["c7a1","",81,"",5,"",4],["c840","",26,"",25,""],["c8a1",""],["c8cd",""],["c8f5",""],["f9fe",""],["fa40",""],["faa1",""],["fb40",""],["fba1",""],["fc40",""],["fca1",""],["fd40",""],["fda1",""],["fe40",""],["fea1",""]];var Bn,ws;function qu(){return ws||(ws=1,Bn={shiftjis:{type:"_dbcs",table:function(){return Lu},encodeAdd:{"":92,"":126},encodeSkipVals:[{from:60736,to:63808}]},csshiftjis:"shiftjis",mskanji:"shiftjis",sjis:"shiftjis",windows31j:"shiftjis",ms31j:"shiftjis",xsjis:"shiftjis",windows932:"shiftjis",ms932:"shiftjis",932:"shiftjis",cp932:"shiftjis",eucjp:{type:"_dbcs",table:function(){return Ou},encodeAdd:{"":92,"":126}},gb2312:"cp936",gb231280:"cp936",gb23121980:"cp936",csgb2312:"cp936",csiso58gb231280:"cp936",euccn:"cp936",windows936:"cp936",ms936:"cp936",936:"cp936",cp936:{type:"_dbcs",table:function(){return Fn}},gbk:{type:"_dbcs",table:function(){return Fn.concat(ys)}},xgbk:"gbk",isoir58:"gbk",gb18030:{type:"_dbcs",table:function(){return Fn.concat(ys)},gb18030:function(){return Uu},encodeSkipVals:[128],encodeAdd:{"":41699}},chinese:"gb18030",windows949:"cp949",ms949:"cp949",949:"cp949",cp949:{type:"_dbcs",table:function(){return Hu}},cseuckr:"cp949",csksc56011987:"cp949",euckr:"cp949",isoir149:"cp949",korean:"cp949",ksc56011987:"cp949",ksc56011989:"cp949",ksc5601:"cp949",windows950:"cp950",ms950:"cp950",950:"cp950",cp950:{type:"_dbcs",table:function(){return vs}},big5:"big5hkscs",big5hkscs:{type:"_dbcs",table:function(){return vs.concat(ju)},encodeSkipVals:[36457,36463,36478,36523,36532,36557,36560,36695,36713,36718,36811,36862,36973,36986,37060,37084,37105,37311,37551,37552,37553,37554,37585,37959,38090,38361,38652,39285,39798,39800,39803,39878,39902,39916,39926,40002,40019,40034,40040,40043,40055,40124,40125,40144,40279,40282,40388,40431,40443,40617,40687,40701,40800,40907,41079,41180,41183,36812,37576,38468,38637,41636,41637,41639,41638,41676,41678]},cnbig5:"big5hkscs",csbig5:"big5hkscs",xxbig5:"big5hkscs"}),Bn}var xs;function $u(){return xs||(xs=1,(function(s){for(var t=[Fu(),Bu(),Iu(),Mu(),Cu(),Ru(),ku(),Du(),qu()],r=0;r<t.length;r++){var e=t[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(s[n]=e[n])}})(wn)),wn}var In,Es;function Gu(){if(Es)return In;Es=1;var s=Ze().Buffer;return In=function(t){var r=t.Transform;function e(i,f){this.conv=i,f=f||{},f.decodeStrings=!1,r.call(this,f)}e.prototype=Object.create(r.prototype,{constructor:{value:e}}),e.prototype._transform=function(i,f,a){if(typeof i!="string")return a(new Error("Iconv encoding stream needs strings as its input."));try{var l=this.conv.write(i);l&&l.length&&this.push(l),a()}catch(c){a(c)}},e.prototype._flush=function(i){try{var f=this.conv.end();f&&f.length&&this.push(f),i()}catch(a){i(a)}},e.prototype.collect=function(i){var f=[];return this.on("error",i),this.on("data",function(a){f.push(a)}),this.on("end",function(){i(null,s.concat(f))}),this};function n(i,f){this.conv=i,f=f||{},f.encoding=this.encoding="utf8",r.call(this,f)}return n.prototype=Object.create(r.prototype,{constructor:{value:n}}),n.prototype._transform=function(i,f,a){if(!s.isBuffer(i)&&!(i instanceof Uint8Array))return a(new Error("Iconv decoding stream needs buffers as its input."));try{var l=this.conv.write(i);l&&l.length&&this.push(l,this.encoding),a()}catch(c){a(c)}},n.prototype._flush=function(i){try{var f=this.conv.end();f&&f.length&&this.push(f,this.encoding),i()}catch(a){i(a)}},n.prototype.collect=function(i){var f="";return this.on("error",i),this.on("data",function(a){f+=a}),this.on("end",function(){i(null,f)}),this},{IconvLiteEncoderStream:e,IconvLiteDecoderStream:n}},In}var Lr={exports:{}},_s;function Ea(){if(_s)return Lr.exports;_s=1;var s=typeof Reflect=="object"?Reflect:null,t=s&&typeof s.apply=="function"?s.apply:function(S,B,k){return Function.prototype.apply.call(S,B,k)},r;s&&typeof s.ownKeys=="function"?r=s.ownKeys:Object.getOwnPropertySymbols?r=function(S){return Object.getOwnPropertyNames(S).concat(Object.getOwnPropertySymbols(S))}:r=function(S){return Object.getOwnPropertyNames(S)};function e(g){console&&console.warn&&console.warn(g)}var n=Number.isNaN||function(S){return S!==S};function i(){i.init.call(this)}Lr.exports=i,Lr.exports.once=_,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var f=10;function a(g){if(typeof g!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof g)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(g){if(typeof g!="number"||g<0||n(g))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+g+".");f=g}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(S){if(typeof S!="number"||S<0||n(S))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+S+".");return this._maxListeners=S,this};function l(g){return g._maxListeners===void 0?i.defaultMaxListeners:g._maxListeners}i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(S){for(var B=[],k=1;k<arguments.length;k++)B.push(arguments[k]);var D=S==="error",$=this._events;if($!==void 0)D=D&&$.error===void 0;else if(!D)return!1;if(D){var j;if(B.length>0&&(j=B[0]),j instanceof Error)throw j;var Q=new Error("Unhandled error."+(j?" ("+j.message+")":""));throw Q.context=j,Q}var L=$[S];if(L===void 0)return!1;if(typeof L=="function")t(L,this,B);else for(var ie=L.length,ue=v(L,ie),k=0;k<ie;++k)t(ue[k],this,B);return!0};function c(g,S,B,k){var D,$,j;if(a(B),$=g._events,$===void 0?($=g._events=Object.create(null),g._eventsCount=0):($.newListener!==void 0&&(g.emit("newListener",S,B.listener?B.listener:B),$=g._events),j=$[S]),j===void 0)j=$[S]=B,++g._eventsCount;else if(typeof j=="function"?j=$[S]=k?[B,j]:[j,B]:k?j.unshift(B):j.push(B),D=l(g),D>0&&j.length>D&&!j.warned){j.warned=!0;var Q=new Error("Possible EventEmitter memory leak detected. "+j.length+" "+String(S)+" listeners added. Use emitter.setMaxListeners() to increase limit");Q.name="MaxListenersExceededWarning",Q.emitter=g,Q.type=S,Q.count=j.length,e(Q)}return g}i.prototype.addListener=function(S,B){return c(this,S,B,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(S,B){return c(this,S,B,!0)};function o(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(g,S,B){var k={fired:!1,wrapFn:void 0,target:g,type:S,listener:B},D=o.bind(k);return D.listener=B,k.wrapFn=D,D}i.prototype.once=function(S,B){return a(B),this.on(S,d(this,S,B)),this},i.prototype.prependOnceListener=function(S,B){return a(B),this.prependListener(S,d(this,S,B)),this},i.prototype.removeListener=function(S,B){var k,D,$,j,Q;if(a(B),D=this._events,D===void 0)return this;if(k=D[S],k===void 0)return this;if(k===B||k.listener===B)--this._eventsCount===0?this._events=Object.create(null):(delete D[S],D.removeListener&&this.emit("removeListener",S,k.listener||B));else if(typeof k!="function"){for($=-1,j=k.length-1;j>=0;j--)if(k[j]===B||k[j].listener===B){Q=k[j].listener,$=j;break}if($<0)return this;$===0?k.shift():w(k,$),k.length===1&&(D[S]=k[0]),D.removeListener!==void 0&&this.emit("removeListener",S,Q||B)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(S){var B,k,D;if(k=this._events,k===void 0)return this;if(k.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):k[S]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete k[S]),this;if(arguments.length===0){var $=Object.keys(k),j;for(D=0;D<$.length;++D)j=$[D],j!=="removeListener"&&this.removeAllListeners(j);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(B=k[S],typeof B=="function")this.removeListener(S,B);else if(B!==void 0)for(D=B.length-1;D>=0;D--)this.removeListener(S,B[D]);return this};function u(g,S,B){var k=g._events;if(k===void 0)return[];var D=k[S];return D===void 0?[]:typeof D=="function"?B?[D.listener||D]:[D]:B?A(D):v(D,D.length)}i.prototype.listeners=function(S){return u(this,S,!0)},i.prototype.rawListeners=function(S){return u(this,S,!1)},i.listenerCount=function(g,S){return typeof g.listenerCount=="function"?g.listenerCount(S):h.call(g,S)},i.prototype.listenerCount=h;function h(g){var S=this._events;if(S!==void 0){var B=S[g];if(typeof B=="function")return 1;if(B!==void 0)return B.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function v(g,S){for(var B=new Array(S),k=0;k<S;++k)B[k]=g[k];return B}function w(g,S){for(;S+1<g.length;S++)g[S]=g[S+1];g.pop()}function A(g){for(var S=new Array(g.length),B=0;B<S.length;++B)S[B]=g[B].listener||g[B];return S}function _(g,S){return new Promise(function(B,k){function D(j){g.removeListener(S,$),k(j)}function $(){typeof g.removeListener=="function"&&g.removeListener("error",D),B([].slice.call(arguments))}x(g,S,$,{once:!0}),S!=="error"&&E(g,D,{once:!0})})}function E(g,S,B){typeof g.on=="function"&&x(g,"error",S,B)}function x(g,S,B,k){if(typeof g.on=="function")k.once?g.once(S,B):g.on(S,B);else if(typeof g.addEventListener=="function")g.addEventListener(S,function D($){k.once&&g.removeEventListener(S,D),B($)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof g)}return Lr.exports}var Or={exports:{}},As;function kt(){return As||(As=1,typeof Object.create=="function"?Or.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Or.exports=function(t,r){if(r){t.super_=r;var e=function(){};e.prototype=r.prototype,t.prototype=new e,t.prototype.constructor=t}}),Or.exports}var Mn,Ss;function Zc(){return Ss||(Ss=1,Mn=Ea().EventEmitter),Mn}var Cn={},Rn={},kn,Ts;function Xc(){return Ts||(Ts=1,kn=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),e=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(e)!=="[object Symbol]")return!1;var n=42;t[r]=n;for(var i in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var f=Object.getOwnPropertySymbols(t);if(f.length!==1||f[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(t,r);if(a.value!==n||a.enumerable!==!0)return!1}return!0}),kn}var Dn,Fs;function Xr(){if(Fs)return Dn;Fs=1;var s=Xc();return Dn=function(){return s()&&!!Symbol.toStringTag},Dn}var Ln,Bs;function Jc(){return Bs||(Bs=1,Ln=Object),Ln}var On,Is;function Wu(){return Is||(Is=1,On=Error),On}var Nn,Ms;function zu(){return Ms||(Ms=1,Nn=EvalError),Nn}var Pn,Cs;function Vu(){return Cs||(Cs=1,Pn=RangeError),Pn}var Un,Rs;function Yu(){return Rs||(Rs=1,Un=ReferenceError),Un}var Hn,ks;function Qc(){return ks||(ks=1,Hn=SyntaxError),Hn}var jn,Ds;function _r(){return Ds||(Ds=1,jn=TypeError),jn}var qn,Ls;function Ku(){return Ls||(Ls=1,qn=URIError),qn}var $n,Os;function Zu(){return Os||(Os=1,$n=Math.abs),$n}var Gn,Ns;function Xu(){return Ns||(Ns=1,Gn=Math.floor),Gn}var Wn,Ps;function Ju(){return Ps||(Ps=1,Wn=Math.max),Wn}var zn,Us;function Qu(){return Us||(Us=1,zn=Math.min),zn}var Vn,Hs;function e0(){return Hs||(Hs=1,Vn=Math.pow),Vn}var Yn,js;function t0(){return js||(js=1,Yn=Math.round),Yn}var Kn,qs;function r0(){return qs||(qs=1,Kn=Number.isNaN||function(t){return t!==t}),Kn}var Zn,$s;function n0(){if($s)return Zn;$s=1;var s=r0();return Zn=function(r){return s(r)||r===0?r:r<0?-1:1},Zn}var Xn,Gs;function i0(){return Gs||(Gs=1,Xn=Object.getOwnPropertyDescriptor),Xn}var Jn,Ws;function Wt(){if(Ws)return Jn;Ws=1;var s=i0();if(s)try{s([],"length")}catch{s=null}return Jn=s,Jn}var Qn,zs;function Jr(){if(zs)return Qn;zs=1;var s=Object.defineProperty||!1;if(s)try{s({},"a",{value:1})}catch{s=!1}return Qn=s,Qn}var ei,Vs;function a0(){if(Vs)return ei;Vs=1;var s=typeof Symbol<"u"&&Symbol,t=Xc();return ei=function(){return typeof s!="function"||typeof Symbol!="function"||typeof s("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},ei}var ti,Ys;function el(){return Ys||(Ys=1,ti=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),ti}var ri,Ks;function tl(){if(Ks)return ri;Ks=1;var s=Jc();return ri=s.getPrototypeOf||null,ri}var ni,Zs;function s0(){if(Zs)return ni;Zs=1;var s="Function.prototype.bind called on incompatible ",t=Object.prototype.toString,r=Math.max,e="[object Function]",n=function(l,c){for(var o=[],d=0;d<l.length;d+=1)o[d]=l[d];for(var u=0;u<c.length;u+=1)o[u+l.length]=c[u];return o},i=function(l,c){for(var o=[],d=c,u=0;d<l.length;d+=1,u+=1)o[u]=l[d];return o},f=function(a,l){for(var c="",o=0;o<a.length;o+=1)c+=a[o],o+1<a.length&&(c+=l);return c};return ni=function(l){var c=this;if(typeof c!="function"||t.apply(c)!==e)throw new TypeError(s+c);for(var o=i(arguments,1),d,u=function(){if(this instanceof d){var _=c.apply(this,n(o,arguments));return Object(_)===_?_:this}return c.apply(l,n(o,arguments))},h=r(0,c.length-o.length),v=[],w=0;w<h;w++)v[w]="$"+w;if(d=Function("binder","return function ("+f(v,",")+"){ return binder.apply(this,arguments); }")(u),c.prototype){var A=function(){};A.prototype=c.prototype,d.prototype=new A,A.prototype=null}return d},ni}var ii,Xs;function Ar(){if(Xs)return ii;Xs=1;var s=s0();return ii=Function.prototype.bind||s,ii}var ai,Js;function _a(){return Js||(Js=1,ai=Function.prototype.call),ai}var si,Qs;function Aa(){return Qs||(Qs=1,si=Function.prototype.apply),si}var oi,eo;function o0(){return eo||(eo=1,oi=typeof Reflect<"u"&&Reflect&&Reflect.apply),oi}var ci,to;function rl(){if(to)return ci;to=1;var s=Ar(),t=Aa(),r=_a(),e=o0();return ci=e||s.call(r,t),ci}var li,ro;function Sa(){if(ro)return li;ro=1;var s=Ar(),t=_r(),r=_a(),e=rl();return li=function(i){if(i.length<1||typeof i[0]!="function")throw new t("a function is required");return e(s,r,i)},li}var ui,no;function c0(){if(no)return ui;no=1;var s=Sa(),t=Wt(),r;try{r=[].__proto__===Array.prototype}catch(f){if(!f||typeof f!="object"||!("code"in f)||f.code!=="ERR_PROTO_ACCESS")throw f}var e=!!r&&t&&t(Object.prototype,"__proto__"),n=Object,i=n.getPrototypeOf;return ui=e&&typeof e.get=="function"?s([e.get]):typeof i=="function"?function(a){return i(a==null?a:n(a))}:!1,ui}var fi,io;function Ta(){if(io)return fi;io=1;var s=el(),t=tl(),r=c0();return fi=s?function(n){return s(n)}:t?function(n){if(!n||typeof n!="object"&&typeof n!="function")throw new TypeError("getProto: not an object");return t(n)}:r?function(n){return r(n)}:null,fi}var di,ao;function nl(){if(ao)return di;ao=1;var s=Function.prototype.call,t=Object.prototype.hasOwnProperty,r=Ar();return di=r.call(s,t),di}var hi,so;function il(){if(so)return hi;so=1;var s,t=Jc(),r=Wu(),e=zu(),n=Vu(),i=Yu(),f=Qc(),a=_r(),l=Ku(),c=Zu(),o=Xu(),d=Ju(),u=Qu(),h=e0(),v=t0(),w=n0(),A=Function,_=function(ee){try{return A('"use strict"; return ('+ee+").constructor;")()}catch{}},E=Wt(),x=Jr(),g=function(){throw new a},S=E?(function(){try{return arguments.callee,g}catch{try{return E(arguments,"callee").get}catch{return g}}})():g,B=a0()(),k=Ta(),D=tl(),$=el(),j=Aa(),Q=_a(),L={},ie=typeof Uint8Array>"u"||!k?s:k(Uint8Array),ue={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?s:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?s:ArrayBuffer,"%ArrayIteratorPrototype%":B&&k?k([][Symbol.iterator]()):s,"%AsyncFromSyncIteratorPrototype%":s,"%AsyncFunction%":L,"%AsyncGenerator%":L,"%AsyncGeneratorFunction%":L,"%AsyncIteratorPrototype%":L,"%Atomics%":typeof Atomics>"u"?s:Atomics,"%BigInt%":typeof BigInt>"u"?s:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?s:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?s:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?s:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":e,"%Float16Array%":typeof Float16Array>"u"?s:Float16Array,"%Float32Array%":typeof Float32Array>"u"?s:Float32Array,"%Float64Array%":typeof Float64Array>"u"?s:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?s:FinalizationRegistry,"%Function%":A,"%GeneratorFunction%":L,"%Int8Array%":typeof Int8Array>"u"?s:Int8Array,"%Int16Array%":typeof Int16Array>"u"?s:Int16Array,"%Int32Array%":typeof Int32Array>"u"?s:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":B&&k?k(k([][Symbol.iterator]())):s,"%JSON%":typeof JSON=="object"?JSON:s,"%Map%":typeof Map>"u"?s:Map,"%MapIteratorPrototype%":typeof Map>"u"||!B||!k?s:k(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":E,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?s:Promise,"%Proxy%":typeof Proxy>"u"?s:Proxy,"%RangeError%":n,"%ReferenceError%":i,"%Reflect%":typeof Reflect>"u"?s:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?s:Set,"%SetIteratorPrototype%":typeof Set>"u"||!B||!k?s:k(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?s:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":B&&k?k(""[Symbol.iterator]()):s,"%Symbol%":B?Symbol:s,"%SyntaxError%":f,"%ThrowTypeError%":S,"%TypedArray%":ie,"%TypeError%":a,"%Uint8Array%":typeof Uint8Array>"u"?s:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?s:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?s:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?s:Uint32Array,"%URIError%":l,"%WeakMap%":typeof WeakMap>"u"?s:WeakMap,"%WeakRef%":typeof WeakRef>"u"?s:WeakRef,"%WeakSet%":typeof WeakSet>"u"?s:WeakSet,"%Function.prototype.call%":Q,"%Function.prototype.apply%":j,"%Object.defineProperty%":x,"%Object.getPrototypeOf%":D,"%Math.abs%":c,"%Math.floor%":o,"%Math.max%":d,"%Math.min%":u,"%Math.pow%":h,"%Math.round%":v,"%Math.sign%":w,"%Reflect.getPrototypeOf%":$};if(k)try{null.error}catch(ee){var fe=k(k(ee));ue["%Error.prototype%"]=fe}var he=function ee(te){var I;if(te==="%AsyncFunction%")I=_("async function () {}");else if(te==="%GeneratorFunction%")I=_("function* () {}");else if(te==="%AsyncGeneratorFunction%")I=_("async function* () {}");else if(te==="%AsyncGenerator%"){var M=ee("%AsyncGeneratorFunction%");M&&(I=M.prototype)}else if(te==="%AsyncIteratorPrototype%"){var Y=ee("%AsyncGenerator%");Y&&k&&(I=k(Y.prototype))}return ue[te]=I,I},ve={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},oe=Ar(),be=nl(),ce=oe.call(Q,Array.prototype.concat),pe=oe.call(j,Array.prototype.splice),_e=oe.call(Q,String.prototype.replace),q=oe.call(Q,String.prototype.slice),z=oe.call(Q,RegExp.prototype.exec),W=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,N=/\\(\\)?/g,U=function(te){var I=q(te,0,1),M=q(te,-1);if(I==="%"&&M!=="%")throw new f("invalid intrinsic syntax, expected closing `%`");if(M==="%"&&I!=="%")throw new f("invalid intrinsic syntax, expected opening `%`");var Y=[];return _e(te,W,function(ne,de,ae,me){Y[Y.length]=ae?_e(me,N,"$1"):de||ne}),Y},K=function(te,I){var M=te,Y;if(be(ve,M)&&(Y=ve[M],M="%"+Y[0]+"%"),be(ue,M)){var ne=ue[M];if(ne===L&&(ne=he(M)),typeof ne>"u"&&!I)throw new a("intrinsic "+te+" exists, but is not available. Please file an issue!");return{alias:Y,name:M,value:ne}}throw new f("intrinsic "+te+" does not exist!")};return hi=function(te,I){if(typeof te!="string"||te.length===0)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof I!="boolean")throw new a('"allowMissing" argument must be a boolean');if(z(/^%?[^%]*%?$/,te)===null)throw new f("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var M=U(te),Y=M.length>0?M[0]:"",ne=K("%"+Y+"%",I),de=ne.name,ae=ne.value,me=!1,Le=ne.alias;Le&&(Y=Le[0],pe(M,ce([0,1],Le)));for(var X=1,He=!0;X<M.length;X+=1){var Ge=M[X],Ae=q(Ge,0,1),Be=q(Ge,-1);if((Ae==='"'||Ae==="'"||Ae==="`"||Be==='"'||Be==="'"||Be==="`")&&Ae!==Be)throw new f("property names with quotes must have matching quotes");if((Ge==="constructor"||!He)&&(me=!0),Y+="."+Ge,de="%"+Y+"%",be(ue,de))ae=ue[de];else if(ae!=null){if(!(Ge in ae)){if(!I)throw new a("base intrinsic for "+te+" exists, but the property is not available.");return}if(E&&X+1>=M.length){var qe=E(ae,Ge);He=!!qe,He&&"get"in qe&&!("originalValue"in qe.get)?ae=qe.get:ae=ae[Ge]}else He=be(ae,Ge),ae=ae[Ge];He&&!me&&(ue[de]=ae)}}return ae},hi}var pi,oo;function Sr(){if(oo)return pi;oo=1;var s=il(),t=Sa(),r=t([s("%String.prototype.indexOf%")]);return pi=function(n,i){var f=s(n,!!i);return typeof f=="function"&&r(n,".prototype.")>-1?t([f]):f},pi}var mi,co;function l0(){if(co)return mi;co=1;var s=Xr()(),t=Sr(),r=t("Object.prototype.toString"),e=function(a){return s&&a&&typeof a=="object"&&Symbol.toStringTag in a?!1:r(a)==="[object Arguments]"},n=function(a){return e(a)?!0:a!==null&&typeof a=="object"&&"length"in a&&typeof a.length=="number"&&a.length>=0&&r(a)!=="[object Array]"&&"callee"in a&&r(a.callee)==="[object Function]"},i=(function(){return e(arguments)})();return e.isLegacyArguments=n,mi=i?e:n,mi}var gi,lo;function u0(){if(lo)return gi;lo=1;var s=Sr(),t=Xr()(),r=nl(),e=Wt(),n;if(t){var i=s("RegExp.prototype.exec"),f={},a=function(){throw f},l={toString:a,valueOf:a};typeof Symbol.toPrimitive=="symbol"&&(l[Symbol.toPrimitive]=a),n=function(u){if(!u||typeof u!="object")return!1;var h=e(u,"lastIndex"),v=h&&r(h,"value");if(!v)return!1;try{i(u,l)}catch(w){return w===f}}}else{var c=s("Object.prototype.toString"),o="[object RegExp]";n=function(u){return!u||typeof u!="object"&&typeof u!="function"?!1:c(u)===o}}return gi=n,gi}var bi,uo;function f0(){if(uo)return bi;uo=1;var s=Sr(),t=u0(),r=s("RegExp.prototype.exec"),e=_r();return bi=function(i){if(!t(i))throw new e("`regex` must be a RegExp");return function(a){return r(i,a)!==null}},bi}var yi,fo;function d0(){if(fo)return yi;fo=1;const s=function*(){}.constructor;return yi=()=>s,yi}var vi,ho;function h0(){if(ho)return vi;ho=1;var s=Sr(),t=f0(),r=t(/^\s*(?:function)?\*/),e=Xr()(),n=Ta(),i=s("Object.prototype.toString"),f=s("Function.prototype.toString"),a=d0();return vi=function(c){if(typeof c!="function")return!1;if(r(f(c)))return!0;if(!e){var o=i(c);return o==="[object GeneratorFunction]"}if(!n)return!1;var d=a();return d&&n(c)===d.prototype},vi}var wi,po;function p0(){if(po)return wi;po=1;var s=Function.prototype.toString,t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,e;if(typeof t=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw e}}),e={},t(function(){throw 42},null,r)}catch(E){E!==e&&(t=null)}else t=null;var n=/^\s*class\b/,i=function(x){try{var g=s.call(x);return n.test(g)}catch{return!1}},f=function(x){try{return i(x)?!1:(s.call(x),!0)}catch{return!1}},a=Object.prototype.toString,l="[object Object]",c="[object Function]",o="[object GeneratorFunction]",d="[object HTMLAllCollection]",u="[object HTML document.all class]",h="[object HTMLCollection]",v=typeof Symbol=="function"&&!!Symbol.toStringTag,w=!(0 in[,]),A=function(){return!1};if(typeof document=="object"){var _=document.all;a.call(_)===a.call(document.all)&&(A=function(x){if((w||!x)&&(typeof x>"u"||typeof x=="object"))try{var g=a.call(x);return(g===d||g===u||g===h||g===l)&&x("")==null}catch{}return!1})}return wi=t?function(x){if(A(x))return!0;if(!x||typeof x!="function"&&typeof x!="object")return!1;try{t(x,null,r)}catch(g){if(g!==e)return!1}return!i(x)&&f(x)}:function(x){if(A(x))return!0;if(!x||typeof x!="function"&&typeof x!="object")return!1;if(v)return f(x);if(i(x))return!1;var g=a.call(x);return g!==c&&g!==o&&!/^\[object HTML/.test(g)?!1:f(x)},wi}var xi,mo;function m0(){if(mo)return xi;mo=1;var s=p0(),t=Object.prototype.toString,r=Object.prototype.hasOwnProperty,e=function(l,c,o){for(var d=0,u=l.length;d<u;d++)r.call(l,d)&&(o==null?c(l[d],d,l):c.call(o,l[d],d,l))},n=function(l,c,o){for(var d=0,u=l.length;d<u;d++)o==null?c(l.charAt(d),d,l):c.call(o,l.charAt(d),d,l)},i=function(l,c,o){for(var d in l)r.call(l,d)&&(o==null?c(l[d],d,l):c.call(o,l[d],d,l))};function f(a){return t.call(a)==="[object Array]"}return xi=function(l,c,o){if(!s(c))throw new TypeError("iterator must be a function");var d;arguments.length>=3&&(d=o),f(l)?e(l,c,d):typeof l=="string"?n(l,c,d):i(l,c,d)},xi}var Ei,go;function g0(){return go||(go=1,Ei=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),Ei}var _i,bo;function b0(){if(bo)return _i;bo=1;var s=g0(),t=typeof globalThis>"u"?It:globalThis;return _i=function(){for(var e=[],n=0;n<s.length;n++)typeof t[s[n]]=="function"&&(e[e.length]=s[n]);return e},_i}var Ai={exports:{}},Si,yo;function y0(){if(yo)return Si;yo=1;var s=Jr(),t=Qc(),r=_r(),e=Wt();return Si=function(i,f,a){if(!i||typeof i!="object"&&typeof i!="function")throw new r("`obj` must be an object or a function`");if(typeof f!="string"&&typeof f!="symbol")throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new r("`loose`, if provided, must be a boolean");var l=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,d=arguments.length>6?arguments[6]:!1,u=!!e&&e(i,f);if(s)s(i,f,{configurable:o===null&&u?u.configurable:!o,enumerable:l===null&&u?u.enumerable:!l,value:a,writable:c===null&&u?u.writable:!c});else if(d||!l&&!c&&!o)i[f]=a;else throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Si}var Ti,vo;function v0(){if(vo)return Ti;vo=1;var s=Jr(),t=function(){return!!s};return t.hasArrayLengthDefineBug=function(){if(!s)return null;try{return s([],"length",{value:1}).length!==1}catch{return!0}},Ti=t,Ti}var Fi,wo;function w0(){if(wo)return Fi;wo=1;var s=il(),t=y0(),r=v0()(),e=Wt(),n=_r(),i=s("%Math.floor%");return Fi=function(a,l){if(typeof a!="function")throw new n("`fn` is not a function");if(typeof l!="number"||l<0||l>4294967295||i(l)!==l)throw new n("`length` must be a positive 32-bit integer");var c=arguments.length>2&&!!arguments[2],o=!0,d=!0;if("length"in a&&e){var u=e(a,"length");u&&!u.configurable&&(o=!1),u&&!u.writable&&(d=!1)}return(o||d||!c)&&(r?t(a,"length",l,!0,!0):t(a,"length",l)),a},Fi}var Bi,xo;function x0(){if(xo)return Bi;xo=1;var s=Ar(),t=Aa(),r=rl();return Bi=function(){return r(s,t,arguments)},Bi}var Eo;function E0(){return Eo||(Eo=1,(function(s){var t=w0(),r=Jr(),e=Sa(),n=x0();s.exports=function(f){var a=e(arguments),l=f.length-(arguments.length-1);return t(a,1+(l>0?l:0),!0)},r?r(s.exports,"apply",{value:n}):s.exports.apply=n})(Ai)),Ai.exports}var Ii,_o;function al(){if(_o)return Ii;_o=1;var s=m0(),t=b0(),r=E0(),e=Sr(),n=Wt(),i=Ta(),f=e("Object.prototype.toString"),a=Xr()(),l=typeof globalThis>"u"?It:globalThis,c=t(),o=e("String.prototype.slice"),d=e("Array.prototype.indexOf",!0)||function(A,_){for(var E=0;E<A.length;E+=1)if(A[E]===_)return E;return-1},u={__proto__:null};a&&n&&i?s(c,function(w){var A=new l[w];if(Symbol.toStringTag in A&&i){var _=i(A),E=n(_,Symbol.toStringTag);if(!E&&_){var x=i(_);E=n(x,Symbol.toStringTag)}u["$"+w]=r(E.get)}}):s(c,function(w){var A=new l[w],_=A.slice||A.set;_&&(u["$"+w]=r(_))});var h=function(A){var _=!1;return s(u,function(E,x){if(!_)try{"$"+E(A)===x&&(_=o(x,1))}catch{}}),_},v=function(A){var _=!1;return s(u,function(E,x){if(!_)try{E(A),_=o(x,1)}catch{}}),_};return Ii=function(A){if(!A||typeof A!="object")return!1;if(!a){var _=o(f(A),8,-1);return d(c,_)>-1?_:_!=="Object"?!1:v(A)}return n?h(A):null},Ii}var Mi,Ao;function _0(){if(Ao)return Mi;Ao=1;var s=al();return Mi=function(r){return!!s(r)},Mi}var So;function A0(){return So||(So=1,(function(s){var t=l0(),r=h0(),e=al(),n=_0();function i(X){return X.call.bind(X)}var f=typeof BigInt<"u",a=typeof Symbol<"u",l=i(Object.prototype.toString),c=i(Number.prototype.valueOf),o=i(String.prototype.valueOf),d=i(Boolean.prototype.valueOf);if(f)var u=i(BigInt.prototype.valueOf);if(a)var h=i(Symbol.prototype.valueOf);function v(X,He){if(typeof X!="object")return!1;try{return He(X),!0}catch{return!1}}s.isArgumentsObject=t,s.isGeneratorFunction=r,s.isTypedArray=n;function w(X){return typeof Promise<"u"&&X instanceof Promise||X!==null&&typeof X=="object"&&typeof X.then=="function"&&typeof X.catch=="function"}s.isPromise=w;function A(X){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(X):n(X)||q(X)}s.isArrayBufferView=A;function _(X){return e(X)==="Uint8Array"}s.isUint8Array=_;function E(X){return e(X)==="Uint8ClampedArray"}s.isUint8ClampedArray=E;function x(X){return e(X)==="Uint16Array"}s.isUint16Array=x;function g(X){return e(X)==="Uint32Array"}s.isUint32Array=g;function S(X){return e(X)==="Int8Array"}s.isInt8Array=S;function B(X){return e(X)==="Int16Array"}s.isInt16Array=B;function k(X){return e(X)==="Int32Array"}s.isInt32Array=k;function D(X){return e(X)==="Float32Array"}s.isFloat32Array=D;function $(X){return e(X)==="Float64Array"}s.isFloat64Array=$;function j(X){return e(X)==="BigInt64Array"}s.isBigInt64Array=j;function Q(X){return e(X)==="BigUint64Array"}s.isBigUint64Array=Q;function L(X){return l(X)==="[object Map]"}L.working=typeof Map<"u"&&L(new Map);function ie(X){return typeof Map>"u"?!1:L.working?L(X):X instanceof Map}s.isMap=ie;function ue(X){return l(X)==="[object Set]"}ue.working=typeof Set<"u"&&ue(new Set);function fe(X){return typeof Set>"u"?!1:ue.working?ue(X):X instanceof Set}s.isSet=fe;function he(X){return l(X)==="[object WeakMap]"}he.working=typeof WeakMap<"u"&&he(new WeakMap);function ve(X){return typeof WeakMap>"u"?!1:he.working?he(X):X instanceof WeakMap}s.isWeakMap=ve;function oe(X){return l(X)==="[object WeakSet]"}oe.working=typeof WeakSet<"u"&&oe(new WeakSet);function be(X){return oe(X)}s.isWeakSet=be;function ce(X){return l(X)==="[object ArrayBuffer]"}ce.working=typeof ArrayBuffer<"u"&&ce(new ArrayBuffer);function pe(X){return typeof ArrayBuffer>"u"?!1:ce.working?ce(X):X instanceof ArrayBuffer}s.isArrayBuffer=pe;function _e(X){return l(X)==="[object DataView]"}_e.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&_e(new DataView(new ArrayBuffer(1),0,1));function q(X){return typeof DataView>"u"?!1:_e.working?_e(X):X instanceof DataView}s.isDataView=q;var z=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function W(X){return l(X)==="[object SharedArrayBuffer]"}function N(X){return typeof z>"u"?!1:(typeof W.working>"u"&&(W.working=W(new z)),W.working?W(X):X instanceof z)}s.isSharedArrayBuffer=N;function U(X){return l(X)==="[object AsyncFunction]"}s.isAsyncFunction=U;function K(X){return l(X)==="[object Map Iterator]"}s.isMapIterator=K;function ee(X){return l(X)==="[object Set Iterator]"}s.isSetIterator=ee;function te(X){return l(X)==="[object Generator]"}s.isGeneratorObject=te;function I(X){return l(X)==="[object WebAssembly.Module]"}s.isWebAssemblyCompiledModule=I;function M(X){return v(X,c)}s.isNumberObject=M;function Y(X){return v(X,o)}s.isStringObject=Y;function ne(X){return v(X,d)}s.isBooleanObject=ne;function de(X){return f&&v(X,u)}s.isBigIntObject=de;function ae(X){return a&&v(X,h)}s.isSymbolObject=ae;function me(X){return M(X)||Y(X)||ne(X)||de(X)||ae(X)}s.isBoxedPrimitive=me;function Le(X){return typeof Uint8Array<"u"&&(pe(X)||N(X))}s.isAnyArrayBuffer=Le,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(X){Object.defineProperty(s,X,{enumerable:!1,value:function(){throw new Error(X+" is not supported in userland")}})})})(Rn)),Rn}var Ci,To;function S0(){return To||(To=1,Ci=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}),Ci}var Fo;function sl(){return Fo||(Fo=1,(function(s){var t={},r=Object.getOwnPropertyDescriptors||function(z){for(var W=Object.keys(z),N={},U=0;U<W.length;U++)N[W[U]]=Object.getOwnPropertyDescriptor(z,W[U]);return N},e=/%[sdj%]/g;s.format=function(q){if(!B(q)){for(var z=[],W=0;W<arguments.length;W++)z.push(a(arguments[W]));return z.join(" ")}for(var W=1,N=arguments,U=N.length,K=String(q).replace(e,function(te){if(te==="%%")return"%";if(W>=U)return te;switch(te){case"%s":return String(N[W++]);case"%d":return Number(N[W++]);case"%j":try{return JSON.stringify(N[W++])}catch{return"[Circular]"}default:return te}}),ee=N[W];W<U;ee=N[++W])x(ee)||!j(ee)?K+=" "+ee:K+=" "+a(ee);return K},s.deprecate=function(q,z){if(typeof xe<"u"&&xe.noDeprecation===!0)return q;if(typeof xe>"u")return function(){return s.deprecate(q,z).apply(this,arguments)};var W=!1;function N(){if(!W){if(xe.throwDeprecation)throw new Error(z);xe.traceDeprecation?console.trace(z):console.error(z),W=!0}return q.apply(this,arguments)}return N};var n={},i=/^$/;if(t.NODE_DEBUG){var f=t.NODE_DEBUG;f=f.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),i=new RegExp("^"+f+"$","i")}s.debuglog=function(q){if(q=q.toUpperCase(),!n[q])if(i.test(q)){var z=xe.pid;n[q]=function(){var W=s.format.apply(s,arguments);console.error("%s %d: %s",q,z,W)}}else n[q]=function(){};return n[q]};function a(q,z){var W={seen:[],stylize:c};return arguments.length>=3&&(W.depth=arguments[2]),arguments.length>=4&&(W.colors=arguments[3]),E(z)?W.showHidden=z:z&&s._extend(W,z),D(W.showHidden)&&(W.showHidden=!1),D(W.depth)&&(W.depth=2),D(W.colors)&&(W.colors=!1),D(W.customInspect)&&(W.customInspect=!0),W.colors&&(W.stylize=l),d(W,q,W.depth)}s.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function l(q,z){var W=a.styles[z];return W?"\x1B["+a.colors[W][0]+"m"+q+"\x1B["+a.colors[W][1]+"m":q}function c(q,z){return q}function o(q){var z={};return q.forEach(function(W,N){z[W]=!0}),z}function d(q,z,W){if(q.customInspect&&z&&ie(z.inspect)&&z.inspect!==s.inspect&&!(z.constructor&&z.constructor.prototype===z)){var N=z.inspect(W,q);return B(N)||(N=d(q,N,W)),N}var U=u(q,z);if(U)return U;var K=Object.keys(z),ee=o(K);if(q.showHidden&&(K=Object.getOwnPropertyNames(z)),L(z)&&(K.indexOf("message")>=0||K.indexOf("description")>=0))return h(z);if(K.length===0){if(ie(z)){var te=z.name?": "+z.name:"";return q.stylize("[Function"+te+"]","special")}if($(z))return q.stylize(RegExp.prototype.toString.call(z),"regexp");if(Q(z))return q.stylize(Date.prototype.toString.call(z),"date");if(L(z))return h(z)}var I="",M=!1,Y=["{","}"];if(_(z)&&(M=!0,Y=["[","]"]),ie(z)){var ne=z.name?": "+z.name:"";I=" [Function"+ne+"]"}if($(z)&&(I=" "+RegExp.prototype.toString.call(z)),Q(z)&&(I=" "+Date.prototype.toUTCString.call(z)),L(z)&&(I=" "+h(z)),K.length===0&&(!M||z.length==0))return Y[0]+I+Y[1];if(W<0)return $(z)?q.stylize(RegExp.prototype.toString.call(z),"regexp"):q.stylize("[Object]","special");q.seen.push(z);var de;return M?de=v(q,z,W,ee,K):de=K.map(function(ae){return w(q,z,W,ee,ae,M)}),q.seen.pop(),A(de,I,Y)}function u(q,z){if(D(z))return q.stylize("undefined","undefined");if(B(z)){var W="'"+JSON.stringify(z).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return q.stylize(W,"string")}if(S(z))return q.stylize(""+z,"number");if(E(z))return q.stylize(""+z,"boolean");if(x(z))return q.stylize("null","null")}function h(q){return"["+Error.prototype.toString.call(q)+"]"}function v(q,z,W,N,U){for(var K=[],ee=0,te=z.length;ee<te;++ee)be(z,String(ee))?K.push(w(q,z,W,N,String(ee),!0)):K.push("");return U.forEach(function(I){I.match(/^\d+$/)||K.push(w(q,z,W,N,I,!0))}),K}function w(q,z,W,N,U,K){var ee,te,I;if(I=Object.getOwnPropertyDescriptor(z,U)||{value:z[U]},I.get?I.set?te=q.stylize("[Getter/Setter]","special"):te=q.stylize("[Getter]","special"):I.set&&(te=q.stylize("[Setter]","special")),be(N,U)||(ee="["+U+"]"),te||(q.seen.indexOf(I.value)<0?(x(W)?te=d(q,I.value,null):te=d(q,I.value,W-1),te.indexOf(`
`)>-1&&(K?te=te.split(`
`).map(function(M){return"  "+M}).join(`
`).slice(2):te=`
`+te.split(`
`).map(function(M){return"   "+M}).join(`
`))):te=q.stylize("[Circular]","special")),D(ee)){if(K&&U.match(/^\d+$/))return te;ee=JSON.stringify(""+U),ee.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(ee=ee.slice(1,-1),ee=q.stylize(ee,"name")):(ee=ee.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),ee=q.stylize(ee,"string"))}return ee+": "+te}function A(q,z,W){var N=q.reduce(function(U,K){return K.indexOf(`
`)>=0,U+K.replace(/\u001b\[\d\d?m/g,"").length+1},0);return N>60?W[0]+(z===""?"":z+`
 `)+" "+q.join(`,
  `)+" "+W[1]:W[0]+z+" "+q.join(", ")+" "+W[1]}s.types=A0();function _(q){return Array.isArray(q)}s.isArray=_;function E(q){return typeof q=="boolean"}s.isBoolean=E;function x(q){return q===null}s.isNull=x;function g(q){return q==null}s.isNullOrUndefined=g;function S(q){return typeof q=="number"}s.isNumber=S;function B(q){return typeof q=="string"}s.isString=B;function k(q){return typeof q=="symbol"}s.isSymbol=k;function D(q){return q===void 0}s.isUndefined=D;function $(q){return j(q)&&fe(q)==="[object RegExp]"}s.isRegExp=$,s.types.isRegExp=$;function j(q){return typeof q=="object"&&q!==null}s.isObject=j;function Q(q){return j(q)&&fe(q)==="[object Date]"}s.isDate=Q,s.types.isDate=Q;function L(q){return j(q)&&(fe(q)==="[object Error]"||q instanceof Error)}s.isError=L,s.types.isNativeError=L;function ie(q){return typeof q=="function"}s.isFunction=ie;function ue(q){return q===null||typeof q=="boolean"||typeof q=="number"||typeof q=="string"||typeof q=="symbol"||typeof q>"u"}s.isPrimitive=ue,s.isBuffer=S0();function fe(q){return Object.prototype.toString.call(q)}function he(q){return q<10?"0"+q.toString(10):q.toString(10)}var ve=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function oe(){var q=new Date,z=[he(q.getHours()),he(q.getMinutes()),he(q.getSeconds())].join(":");return[q.getDate(),ve[q.getMonth()],z].join(" ")}s.log=function(){console.log("%s - %s",oe(),s.format.apply(s,arguments))},s.inherits=kt(),s._extend=function(q,z){if(!z||!j(z))return q;for(var W=Object.keys(z),N=W.length;N--;)q[W[N]]=z[W[N]];return q};function be(q,z){return Object.prototype.hasOwnProperty.call(q,z)}var ce=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;s.promisify=function(z){if(typeof z!="function")throw new TypeError('The "original" argument must be of type Function');if(ce&&z[ce]){var W=z[ce];if(typeof W!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(W,ce,{value:W,enumerable:!1,writable:!1,configurable:!0}),W}function W(){for(var N,U,K=new Promise(function(I,M){N=I,U=M}),ee=[],te=0;te<arguments.length;te++)ee.push(arguments[te]);ee.push(function(I,M){I?U(I):N(M)});try{z.apply(this,ee)}catch(I){U(I)}return K}return Object.setPrototypeOf(W,Object.getPrototypeOf(z)),ce&&Object.defineProperty(W,ce,{value:W,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(W,r(z))},s.promisify.custom=ce;function pe(q,z){if(!q){var W=new Error("Promise was rejected with a falsy value");W.reason=q,q=W}return z(q)}function _e(q){if(typeof q!="function")throw new TypeError('The "original" argument must be of type Function');function z(){for(var W=[],N=0;N<arguments.length;N++)W.push(arguments[N]);var U=W.pop();if(typeof U!="function")throw new TypeError("The last argument must be of type Function");var K=this,ee=function(){return U.apply(K,arguments)};q.apply(this,W).then(function(te){xe.nextTick(ee.bind(null,null,te))},function(te){xe.nextTick(pe.bind(null,te,ee))})}return Object.setPrototypeOf(z,Object.getPrototypeOf(q)),Object.defineProperties(z,r(q)),z}s.callbackify=_e})(Cn)),Cn}var Ri,Bo;function T0(){if(Bo)return Ri;Bo=1;function s(v,w){var A=Object.keys(v);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(v);w&&(_=_.filter(function(E){return Object.getOwnPropertyDescriptor(v,E).enumerable})),A.push.apply(A,_)}return A}function t(v){for(var w=1;w<arguments.length;w++){var A=arguments[w]!=null?arguments[w]:{};w%2?s(Object(A),!0).forEach(function(_){r(v,_,A[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(A)):s(Object(A)).forEach(function(_){Object.defineProperty(v,_,Object.getOwnPropertyDescriptor(A,_))})}return v}function r(v,w,A){return w=f(w),w in v?Object.defineProperty(v,w,{value:A,enumerable:!0,configurable:!0,writable:!0}):v[w]=A,v}function e(v,w){if(!(v instanceof w))throw new TypeError("Cannot call a class as a function")}function n(v,w){for(var A=0;A<w.length;A++){var _=w[A];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(v,f(_.key),_)}}function i(v,w,A){return w&&n(v.prototype,w),Object.defineProperty(v,"prototype",{writable:!1}),v}function f(v){var w=a(v,"string");return typeof w=="symbol"?w:String(w)}function a(v,w){if(typeof v!="object"||v===null)return v;var A=v[Symbol.toPrimitive];if(A!==void 0){var _=A.call(v,w);if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(v)}var l=Er(),c=l.Buffer,o=sl(),d=o.inspect,u=d&&d.custom||"inspect";function h(v,w,A){c.prototype.copy.call(v,w,A)}return Ri=(function(){function v(){e(this,v),this.head=null,this.tail=null,this.length=0}return i(v,[{key:"push",value:function(A){var _={data:A,next:null};this.length>0?this.tail.next=_:this.head=_,this.tail=_,++this.length}},{key:"unshift",value:function(A){var _={data:A,next:this.head};this.length===0&&(this.tail=_),this.head=_,++this.length}},{key:"shift",value:function(){if(this.length!==0){var A=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,A}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(A){if(this.length===0)return"";for(var _=this.head,E=""+_.data;_=_.next;)E+=A+_.data;return E}},{key:"concat",value:function(A){if(this.length===0)return c.alloc(0);for(var _=c.allocUnsafe(A>>>0),E=this.head,x=0;E;)h(E.data,_,x),x+=E.data.length,E=E.next;return _}},{key:"consume",value:function(A,_){var E;return A<this.head.data.length?(E=this.head.data.slice(0,A),this.head.data=this.head.data.slice(A)):A===this.head.data.length?E=this.shift():E=_?this._getString(A):this._getBuffer(A),E}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(A){var _=this.head,E=1,x=_.data;for(A-=x.length;_=_.next;){var g=_.data,S=A>g.length?g.length:A;if(S===g.length?x+=g:x+=g.slice(0,A),A-=S,A===0){S===g.length?(++E,_.next?this.head=_.next:this.head=this.tail=null):(this.head=_,_.data=g.slice(S));break}++E}return this.length-=E,x}},{key:"_getBuffer",value:function(A){var _=c.allocUnsafe(A),E=this.head,x=1;for(E.data.copy(_),A-=E.data.length;E=E.next;){var g=E.data,S=A>g.length?g.length:A;if(g.copy(_,_.length-A,0,S),A-=S,A===0){S===g.length?(++x,E.next?this.head=E.next:this.head=this.tail=null):(this.head=E,E.data=g.slice(S));break}++x}return this.length-=x,_}},{key:u,value:function(A,_){return d(this,t(t({},_),{},{depth:0,customInspect:!1}))}}]),v})(),Ri}var ki,Io;function ol(){if(Io)return ki;Io=1;function s(f,a){var l=this,c=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return c||o?(a?a(f):f&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,xe.nextTick(n,this,f)):xe.nextTick(n,this,f)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(f||null,function(d){!a&&d?l._writableState?l._writableState.errorEmitted?xe.nextTick(r,l):(l._writableState.errorEmitted=!0,xe.nextTick(t,l,d)):xe.nextTick(t,l,d):a?(xe.nextTick(r,l),a(d)):xe.nextTick(r,l)}),this)}function t(f,a){n(f,a),r(f)}function r(f){f._writableState&&!f._writableState.emitClose||f._readableState&&!f._readableState.emitClose||f.emit("close")}function e(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function n(f,a){f.emit("error",a)}function i(f,a){var l=f._readableState,c=f._writableState;l&&l.autoDestroy||c&&c.autoDestroy?f.destroy(a):f.emit("error",a)}return ki={destroy:s,undestroy:e,errorOrDestroy:i},ki}var Di={},Mo;function zt(){if(Mo)return Di;Mo=1;function s(a,l){a.prototype=Object.create(l.prototype),a.prototype.constructor=a,a.__proto__=l}var t={};function r(a,l,c){c||(c=Error);function o(u,h,v){return typeof l=="string"?l:l(u,h,v)}var d=(function(u){s(h,u);function h(v,w,A){return u.call(this,o(v,w,A))||this}return h})(c);d.prototype.name=c.name,d.prototype.code=a,t[a]=d}function e(a,l){if(Array.isArray(a)){var c=a.length;return a=a.map(function(o){return String(o)}),c>2?"one of ".concat(l," ").concat(a.slice(0,c-1).join(", "),", or ")+a[c-1]:c===2?"one of ".concat(l," ").concat(a[0]," or ").concat(a[1]):"of ".concat(l," ").concat(a[0])}else return"of ".concat(l," ").concat(String(a))}function n(a,l,c){return a.substr(0,l.length)===l}function i(a,l,c){return(c===void 0||c>a.length)&&(c=a.length),a.substring(c-l.length,c)===l}function f(a,l,c){return typeof c!="number"&&(c=0),c+l.length>a.length?!1:a.indexOf(l,c)!==-1}return r("ERR_INVALID_OPT_VALUE",function(a,l){return'The value "'+l+'" is invalid for option "'+a+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(a,l,c){var o;typeof l=="string"&&n(l,"not ")?(o="must not be",l=l.replace(/^not /,"")):o="must be";var d;if(i(a," argument"))d="The ".concat(a," ").concat(o," ").concat(e(l,"type"));else{var u=f(a,".")?"property":"argument";d='The "'.concat(a,'" ').concat(u," ").concat(o," ").concat(e(l,"type"))}return d+=". Received type ".concat(typeof c),d},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(a){return"The "+a+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(a){return"Cannot call "+a+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(a){return"Unknown encoding: "+a},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Di.codes=t,Di}var Li,Co;function cl(){if(Co)return Li;Co=1;var s=zt().codes.ERR_INVALID_OPT_VALUE;function t(e,n,i){return e.highWaterMark!=null?e.highWaterMark:n?e[i]:null}function r(e,n,i,f){var a=t(n,f,i);if(a!=null){if(!(isFinite(a)&&Math.floor(a)===a)||a<0){var l=f?i:"highWaterMark";throw new s(l,a)}return Math.floor(a)}return e.objectMode?16:16*1024}return Li={getHighWaterMark:r},Li}var Oi,Ro;function F0(){if(Ro)return Oi;Ro=1,Oi=s;function s(r,e){if(t("noDeprecation"))return r;var n=!1;function i(){if(!n){if(t("throwDeprecation"))throw new Error(e);t("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return r.apply(this,arguments)}return i}function t(r){try{if(!It.localStorage)return!1}catch{return!1}var e=It.localStorage[r];return e==null?!1:String(e).toLowerCase()==="true"}return Oi}var Ni,ko;function ll(){if(ko)return Ni;ko=1,Ni=D;function s(N){var U=this;this.next=null,this.entry=null,this.finish=function(){W(U,N)}}var t;D.WritableState=B;var r={deprecate:F0()},e=Zc(),n=Er().Buffer,i=(typeof It<"u"?It:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function f(N){return n.from(N)}function a(N){return n.isBuffer(N)||N instanceof i}var l=ol(),c=cl(),o=c.getHighWaterMark,d=zt().codes,u=d.ERR_INVALID_ARG_TYPE,h=d.ERR_METHOD_NOT_IMPLEMENTED,v=d.ERR_MULTIPLE_CALLBACK,w=d.ERR_STREAM_CANNOT_PIPE,A=d.ERR_STREAM_DESTROYED,_=d.ERR_STREAM_NULL_VALUES,E=d.ERR_STREAM_WRITE_AFTER_END,x=d.ERR_UNKNOWN_ENCODING,g=l.errorOrDestroy;kt()(D,e);function S(){}function B(N,U,K){t=t||Gt(),N=N||{},typeof K!="boolean"&&(K=U instanceof t),this.objectMode=!!N.objectMode,K&&(this.objectMode=this.objectMode||!!N.writableObjectMode),this.highWaterMark=o(this,N,"writableHighWaterMark",K),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var ee=N.decodeStrings===!1;this.decodeStrings=!ee,this.defaultEncoding=N.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(te){he(U,te)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=N.emitClose!==!1,this.autoDestroy=!!N.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}B.prototype.getBuffer=function(){for(var U=this.bufferedRequest,K=[];U;)K.push(U),U=U.next;return K},(function(){try{Object.defineProperty(B.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var k;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(k=Function.prototype[Symbol.hasInstance],Object.defineProperty(D,Symbol.hasInstance,{value:function(U){return k.call(this,U)?!0:this!==D?!1:U&&U._writableState instanceof B}})):k=function(U){return U instanceof this};function D(N){t=t||Gt();var U=this instanceof t;if(!U&&!k.call(D,this))return new D(N);this._writableState=new B(N,this,U),this.writable=!0,N&&(typeof N.write=="function"&&(this._write=N.write),typeof N.writev=="function"&&(this._writev=N.writev),typeof N.destroy=="function"&&(this._destroy=N.destroy),typeof N.final=="function"&&(this._final=N.final)),e.call(this)}D.prototype.pipe=function(){g(this,new w)};function $(N,U){var K=new E;g(N,K),xe.nextTick(U,K)}function j(N,U,K,ee){var te;return K===null?te=new _:typeof K!="string"&&!U.objectMode&&(te=new u("chunk",["string","Buffer"],K)),te?(g(N,te),xe.nextTick(ee,te),!1):!0}D.prototype.write=function(N,U,K){var ee=this._writableState,te=!1,I=!ee.objectMode&&a(N);return I&&!n.isBuffer(N)&&(N=f(N)),typeof U=="function"&&(K=U,U=null),I?U="buffer":U||(U=ee.defaultEncoding),typeof K!="function"&&(K=S),ee.ending?$(this,K):(I||j(this,ee,N,K))&&(ee.pendingcb++,te=L(this,ee,I,N,U,K)),te},D.prototype.cork=function(){this._writableState.corked++},D.prototype.uncork=function(){var N=this._writableState;N.corked&&(N.corked--,!N.writing&&!N.corked&&!N.bufferProcessing&&N.bufferedRequest&&be(this,N))},D.prototype.setDefaultEncoding=function(U){if(typeof U=="string"&&(U=U.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((U+"").toLowerCase())>-1))throw new x(U);return this._writableState.defaultEncoding=U,this},Object.defineProperty(D.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function Q(N,U,K){return!N.objectMode&&N.decodeStrings!==!1&&typeof U=="string"&&(U=n.from(U,K)),U}Object.defineProperty(D.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function L(N,U,K,ee,te,I){if(!K){var M=Q(U,ee,te);ee!==M&&(K=!0,te="buffer",ee=M)}var Y=U.objectMode?1:ee.length;U.length+=Y;var ne=U.length<U.highWaterMark;if(ne||(U.needDrain=!0),U.writing||U.corked){var de=U.lastBufferedRequest;U.lastBufferedRequest={chunk:ee,encoding:te,isBuf:K,callback:I,next:null},de?de.next=U.lastBufferedRequest:U.bufferedRequest=U.lastBufferedRequest,U.bufferedRequestCount+=1}else ie(N,U,!1,Y,ee,te,I);return ne}function ie(N,U,K,ee,te,I,M){U.writelen=ee,U.writecb=M,U.writing=!0,U.sync=!0,U.destroyed?U.onwrite(new A("write")):K?N._writev(te,U.onwrite):N._write(te,I,U.onwrite),U.sync=!1}function ue(N,U,K,ee,te){--U.pendingcb,K?(xe.nextTick(te,ee),xe.nextTick(q,N,U),N._writableState.errorEmitted=!0,g(N,ee)):(te(ee),N._writableState.errorEmitted=!0,g(N,ee),q(N,U))}function fe(N){N.writing=!1,N.writecb=null,N.length-=N.writelen,N.writelen=0}function he(N,U){var K=N._writableState,ee=K.sync,te=K.writecb;if(typeof te!="function")throw new v;if(fe(K),U)ue(N,K,ee,U,te);else{var I=ce(K)||N.destroyed;!I&&!K.corked&&!K.bufferProcessing&&K.bufferedRequest&&be(N,K),ee?xe.nextTick(ve,N,K,I,te):ve(N,K,I,te)}}function ve(N,U,K,ee){K||oe(N,U),U.pendingcb--,ee(),q(N,U)}function oe(N,U){U.length===0&&U.needDrain&&(U.needDrain=!1,N.emit("drain"))}function be(N,U){U.bufferProcessing=!0;var K=U.bufferedRequest;if(N._writev&&K&&K.next){var ee=U.bufferedRequestCount,te=new Array(ee),I=U.corkedRequestsFree;I.entry=K;for(var M=0,Y=!0;K;)te[M]=K,K.isBuf||(Y=!1),K=K.next,M+=1;te.allBuffers=Y,ie(N,U,!0,U.length,te,"",I.finish),U.pendingcb++,U.lastBufferedRequest=null,I.next?(U.corkedRequestsFree=I.next,I.next=null):U.corkedRequestsFree=new s(U),U.bufferedRequestCount=0}else{for(;K;){var ne=K.chunk,de=K.encoding,ae=K.callback,me=U.objectMode?1:ne.length;if(ie(N,U,!1,me,ne,de,ae),K=K.next,U.bufferedRequestCount--,U.writing)break}K===null&&(U.lastBufferedRequest=null)}U.bufferedRequest=K,U.bufferProcessing=!1}D.prototype._write=function(N,U,K){K(new h("_write()"))},D.prototype._writev=null,D.prototype.end=function(N,U,K){var ee=this._writableState;return typeof N=="function"?(K=N,N=null,U=null):typeof U=="function"&&(K=U,U=null),N!=null&&this.write(N,U),ee.corked&&(ee.corked=1,this.uncork()),ee.ending||z(this,ee,K),this},Object.defineProperty(D.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function ce(N){return N.ending&&N.length===0&&N.bufferedRequest===null&&!N.finished&&!N.writing}function pe(N,U){N._final(function(K){U.pendingcb--,K&&g(N,K),U.prefinished=!0,N.emit("prefinish"),q(N,U)})}function _e(N,U){!U.prefinished&&!U.finalCalled&&(typeof N._final=="function"&&!U.destroyed?(U.pendingcb++,U.finalCalled=!0,xe.nextTick(pe,N,U)):(U.prefinished=!0,N.emit("prefinish")))}function q(N,U){var K=ce(U);if(K&&(_e(N,U),U.pendingcb===0&&(U.finished=!0,N.emit("finish"),U.autoDestroy))){var ee=N._readableState;(!ee||ee.autoDestroy&&ee.endEmitted)&&N.destroy()}return K}function z(N,U,K){U.ending=!0,q(N,U),K&&(U.finished?xe.nextTick(K):N.once("finish",K)),U.ended=!0,N.writable=!1}function W(N,U,K){var ee=N.entry;for(N.entry=null;ee;){var te=ee.callback;U.pendingcb--,te(K),ee=ee.next}U.corkedRequestsFree.next=N}return Object.defineProperty(D.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(U){this._writableState&&(this._writableState.destroyed=U)}}),D.prototype.destroy=l.destroy,D.prototype._undestroy=l.undestroy,D.prototype._destroy=function(N,U){U(N)},Ni}var Pi,Do;function Gt(){if(Do)return Pi;Do=1;var s=Object.keys||function(c){var o=[];for(var d in c)o.push(d);return o};Pi=f;var t=ul(),r=ll();kt()(f,t);for(var e=s(r.prototype),n=0;n<e.length;n++){var i=e[n];f.prototype[i]||(f.prototype[i]=r.prototype[i])}function f(c){if(!(this instanceof f))return new f(c);t.call(this,c),r.call(this,c),this.allowHalfOpen=!0,c&&(c.readable===!1&&(this.readable=!1),c.writable===!1&&(this.writable=!1),c.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",a)))}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(f.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function a(){this._writableState.ended||xe.nextTick(l,this)}function l(c){c.end()}return Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(o){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=o,this._writableState.destroyed=o)}}),Pi}var Ui,Lo;function Fa(){if(Lo)return Ui;Lo=1;var s=zt().codes.ERR_STREAM_PREMATURE_CLOSE;function t(i){var f=!1;return function(){if(!f){f=!0;for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];i.apply(this,l)}}}function r(){}function e(i){return i.setHeader&&typeof i.abort=="function"}function n(i,f,a){if(typeof f=="function")return n(i,null,f);f||(f={}),a=t(a||r);var l=f.readable||f.readable!==!1&&i.readable,c=f.writable||f.writable!==!1&&i.writable,o=function(){i.writable||u()},d=i._writableState&&i._writableState.finished,u=function(){c=!1,d=!0,l||a.call(i)},h=i._readableState&&i._readableState.endEmitted,v=function(){l=!1,h=!0,c||a.call(i)},w=function(x){a.call(i,x)},A=function(){var x;if(l&&!h)return(!i._readableState||!i._readableState.ended)&&(x=new s),a.call(i,x);if(c&&!d)return(!i._writableState||!i._writableState.ended)&&(x=new s),a.call(i,x)},_=function(){i.req.on("finish",u)};return e(i)?(i.on("complete",u),i.on("abort",A),i.req?_():i.on("request",_)):c&&!i._writableState&&(i.on("end",o),i.on("close",o)),i.on("end",v),i.on("finish",u),f.error!==!1&&i.on("error",w),i.on("close",A),function(){i.removeListener("complete",u),i.removeListener("abort",A),i.removeListener("request",_),i.req&&i.req.removeListener("finish",u),i.removeListener("end",o),i.removeListener("close",o),i.removeListener("finish",u),i.removeListener("end",v),i.removeListener("error",w),i.removeListener("close",A)}}return Ui=n,Ui}var Hi,Oo;function B0(){if(Oo)return Hi;Oo=1;var s;function t(x,g,S){return g=r(g),g in x?Object.defineProperty(x,g,{value:S,enumerable:!0,configurable:!0,writable:!0}):x[g]=S,x}function r(x){var g=e(x,"string");return typeof g=="symbol"?g:String(g)}function e(x,g){if(typeof x!="object"||x===null)return x;var S=x[Symbol.toPrimitive];if(S!==void 0){var B=S.call(x,g);if(typeof B!="object")return B;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(x)}var n=Fa(),i=Symbol("lastResolve"),f=Symbol("lastReject"),a=Symbol("error"),l=Symbol("ended"),c=Symbol("lastPromise"),o=Symbol("handlePromise"),d=Symbol("stream");function u(x,g){return{value:x,done:g}}function h(x){var g=x[i];if(g!==null){var S=x[d].read();S!==null&&(x[c]=null,x[i]=null,x[f]=null,g(u(S,!1)))}}function v(x){xe.nextTick(h,x)}function w(x,g){return function(S,B){x.then(function(){if(g[l]){S(u(void 0,!0));return}g[o](S,B)},B)}}var A=Object.getPrototypeOf(function(){}),_=Object.setPrototypeOf((s={get stream(){return this[d]},next:function(){var g=this,S=this[a];if(S!==null)return Promise.reject(S);if(this[l])return Promise.resolve(u(void 0,!0));if(this[d].destroyed)return new Promise(function($,j){xe.nextTick(function(){g[a]?j(g[a]):$(u(void 0,!0))})});var B=this[c],k;if(B)k=new Promise(w(B,this));else{var D=this[d].read();if(D!==null)return Promise.resolve(u(D,!1));k=new Promise(this[o])}return this[c]=k,k}},t(s,Symbol.asyncIterator,function(){return this}),t(s,"return",function(){var g=this;return new Promise(function(S,B){g[d].destroy(null,function(k){if(k){B(k);return}S(u(void 0,!0))})})}),s),A),E=function(g){var S,B=Object.create(_,(S={},t(S,d,{value:g,writable:!0}),t(S,i,{value:null,writable:!0}),t(S,f,{value:null,writable:!0}),t(S,a,{value:null,writable:!0}),t(S,l,{value:g._readableState.endEmitted,writable:!0}),t(S,o,{value:function(D,$){var j=B[d].read();j?(B[c]=null,B[i]=null,B[f]=null,D(u(j,!1))):(B[i]=D,B[f]=$)},writable:!0}),S));return B[c]=null,n(g,function(k){if(k&&k.code!=="ERR_STREAM_PREMATURE_CLOSE"){var D=B[f];D!==null&&(B[c]=null,B[i]=null,B[f]=null,D(k)),B[a]=k;return}var $=B[i];$!==null&&(B[c]=null,B[i]=null,B[f]=null,$(u(void 0,!0))),B[l]=!0}),g.on("readable",v.bind(null,B)),B};return Hi=E,Hi}var ji,No;function I0(){return No||(No=1,ji=function(){throw new Error("Readable.from is not available in the browser")}),ji}var qi,Po;function ul(){if(Po)return qi;Po=1,qi=$;var s;$.ReadableState=D,Ea().EventEmitter;var t=function(M,Y){return M.listeners(Y).length},r=Zc(),e=Er().Buffer,n=(typeof It<"u"?It:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function i(I){return e.from(I)}function f(I){return e.isBuffer(I)||I instanceof n}var a=sl(),l;a&&a.debuglog?l=a.debuglog("stream"):l=function(){};var c=T0(),o=ol(),d=cl(),u=d.getHighWaterMark,h=zt().codes,v=h.ERR_INVALID_ARG_TYPE,w=h.ERR_STREAM_PUSH_AFTER_EOF,A=h.ERR_METHOD_NOT_IMPLEMENTED,_=h.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,E,x,g;kt()($,r);var S=o.errorOrDestroy,B=["error","close","destroy","pause","resume"];function k(I,M,Y){if(typeof I.prependListener=="function")return I.prependListener(M,Y);!I._events||!I._events[M]?I.on(M,Y):Array.isArray(I._events[M])?I._events[M].unshift(Y):I._events[M]=[Y,I._events[M]]}function D(I,M,Y){s=s||Gt(),I=I||{},typeof Y!="boolean"&&(Y=M instanceof s),this.objectMode=!!I.objectMode,Y&&(this.objectMode=this.objectMode||!!I.readableObjectMode),this.highWaterMark=u(this,I,"readableHighWaterMark",Y),this.buffer=new c,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=I.emitClose!==!1,this.autoDestroy=!!I.autoDestroy,this.destroyed=!1,this.defaultEncoding=I.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,I.encoding&&(E||(E=Vr().StringDecoder),this.decoder=new E(I.encoding),this.encoding=I.encoding)}function $(I){if(s=s||Gt(),!(this instanceof $))return new $(I);var M=this instanceof s;this._readableState=new D(I,this,M),this.readable=!0,I&&(typeof I.read=="function"&&(this._read=I.read),typeof I.destroy=="function"&&(this._destroy=I.destroy)),r.call(this)}Object.defineProperty($.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(M){this._readableState&&(this._readableState.destroyed=M)}}),$.prototype.destroy=o.destroy,$.prototype._undestroy=o.undestroy,$.prototype._destroy=function(I,M){M(I)},$.prototype.push=function(I,M){var Y=this._readableState,ne;return Y.objectMode?ne=!0:typeof I=="string"&&(M=M||Y.defaultEncoding,M!==Y.encoding&&(I=e.from(I,M),M=""),ne=!0),j(this,I,M,!1,ne)},$.prototype.unshift=function(I){return j(this,I,null,!0,!1)};function j(I,M,Y,ne,de){l("readableAddChunk",M);var ae=I._readableState;if(M===null)ae.reading=!1,he(I,ae);else{var me;if(de||(me=L(ae,M)),me)S(I,me);else if(ae.objectMode||M&&M.length>0)if(typeof M!="string"&&!ae.objectMode&&Object.getPrototypeOf(M)!==e.prototype&&(M=i(M)),ne)ae.endEmitted?S(I,new _):Q(I,ae,M,!0);else if(ae.ended)S(I,new w);else{if(ae.destroyed)return!1;ae.reading=!1,ae.decoder&&!Y?(M=ae.decoder.write(M),ae.objectMode||M.length!==0?Q(I,ae,M,!1):be(I,ae)):Q(I,ae,M,!1)}else ne||(ae.reading=!1,be(I,ae))}return!ae.ended&&(ae.length<ae.highWaterMark||ae.length===0)}function Q(I,M,Y,ne){M.flowing&&M.length===0&&!M.sync?(M.awaitDrain=0,I.emit("data",Y)):(M.length+=M.objectMode?1:Y.length,ne?M.buffer.unshift(Y):M.buffer.push(Y),M.needReadable&&ve(I)),be(I,M)}function L(I,M){var Y;return!f(M)&&typeof M!="string"&&M!==void 0&&!I.objectMode&&(Y=new v("chunk",["string","Buffer","Uint8Array"],M)),Y}$.prototype.isPaused=function(){return this._readableState.flowing===!1},$.prototype.setEncoding=function(I){E||(E=Vr().StringDecoder);var M=new E(I);this._readableState.decoder=M,this._readableState.encoding=this._readableState.decoder.encoding;for(var Y=this._readableState.buffer.head,ne="";Y!==null;)ne+=M.write(Y.data),Y=Y.next;return this._readableState.buffer.clear(),ne!==""&&this._readableState.buffer.push(ne),this._readableState.length=ne.length,this};var ie=1073741824;function ue(I){return I>=ie?I=ie:(I--,I|=I>>>1,I|=I>>>2,I|=I>>>4,I|=I>>>8,I|=I>>>16,I++),I}function fe(I,M){return I<=0||M.length===0&&M.ended?0:M.objectMode?1:I!==I?M.flowing&&M.length?M.buffer.head.data.length:M.length:(I>M.highWaterMark&&(M.highWaterMark=ue(I)),I<=M.length?I:M.ended?M.length:(M.needReadable=!0,0))}$.prototype.read=function(I){l("read",I),I=parseInt(I,10);var M=this._readableState,Y=I;if(I!==0&&(M.emittedReadable=!1),I===0&&M.needReadable&&((M.highWaterMark!==0?M.length>=M.highWaterMark:M.length>0)||M.ended))return l("read: emitReadable",M.length,M.ended),M.length===0&&M.ended?K(this):ve(this),null;if(I=fe(I,M),I===0&&M.ended)return M.length===0&&K(this),null;var ne=M.needReadable;l("need readable",ne),(M.length===0||M.length-I<M.highWaterMark)&&(ne=!0,l("length less than watermark",ne)),M.ended||M.reading?(ne=!1,l("reading or ended",ne)):ne&&(l("do read"),M.reading=!0,M.sync=!0,M.length===0&&(M.needReadable=!0),this._read(M.highWaterMark),M.sync=!1,M.reading||(I=fe(Y,M)));var de;return I>0?de=U(I,M):de=null,de===null?(M.needReadable=M.length<=M.highWaterMark,I=0):(M.length-=I,M.awaitDrain=0),M.length===0&&(M.ended||(M.needReadable=!0),Y!==I&&M.ended&&K(this)),de!==null&&this.emit("data",de),de};function he(I,M){if(l("onEofChunk"),!M.ended){if(M.decoder){var Y=M.decoder.end();Y&&Y.length&&(M.buffer.push(Y),M.length+=M.objectMode?1:Y.length)}M.ended=!0,M.sync?ve(I):(M.needReadable=!1,M.emittedReadable||(M.emittedReadable=!0,oe(I)))}}function ve(I){var M=I._readableState;l("emitReadable",M.needReadable,M.emittedReadable),M.needReadable=!1,M.emittedReadable||(l("emitReadable",M.flowing),M.emittedReadable=!0,xe.nextTick(oe,I))}function oe(I){var M=I._readableState;l("emitReadable_",M.destroyed,M.length,M.ended),!M.destroyed&&(M.length||M.ended)&&(I.emit("readable"),M.emittedReadable=!1),M.needReadable=!M.flowing&&!M.ended&&M.length<=M.highWaterMark,N(I)}function be(I,M){M.readingMore||(M.readingMore=!0,xe.nextTick(ce,I,M))}function ce(I,M){for(;!M.reading&&!M.ended&&(M.length<M.highWaterMark||M.flowing&&M.length===0);){var Y=M.length;if(l("maybeReadMore read 0"),I.read(0),Y===M.length)break}M.readingMore=!1}$.prototype._read=function(I){S(this,new A("_read()"))},$.prototype.pipe=function(I,M){var Y=this,ne=this._readableState;switch(ne.pipesCount){case 0:ne.pipes=I;break;case 1:ne.pipes=[ne.pipes,I];break;default:ne.pipes.push(I);break}ne.pipesCount+=1,l("pipe count=%d opts=%j",ne.pipesCount,M);var de=(!M||M.end!==!1)&&I!==xe.stdout&&I!==xe.stderr,ae=de?Le:We;ne.endEmitted?xe.nextTick(ae):Y.once("end",ae),I.on("unpipe",me);function me(Pe,Ue){l("onunpipe"),Pe===Y&&Ue&&Ue.hasUnpiped===!1&&(Ue.hasUnpiped=!0,Ge())}function Le(){l("onend"),I.end()}var X=pe(Y);I.on("drain",X);var He=!1;function Ge(){l("cleanup"),I.removeListener("close",qe),I.removeListener("finish",Oe),I.removeListener("drain",X),I.removeListener("error",Be),I.removeListener("unpipe",me),Y.removeListener("end",Le),Y.removeListener("end",We),Y.removeListener("data",Ae),He=!0,ne.awaitDrain&&(!I._writableState||I._writableState.needDrain)&&X()}Y.on("data",Ae);function Ae(Pe){l("ondata");var Ue=I.write(Pe);l("dest.write",Ue),Ue===!1&&((ne.pipesCount===1&&ne.pipes===I||ne.pipesCount>1&&te(ne.pipes,I)!==-1)&&!He&&(l("false write response, pause",ne.awaitDrain),ne.awaitDrain++),Y.pause())}function Be(Pe){l("onerror",Pe),We(),I.removeListener("error",Be),t(I,"error")===0&&S(I,Pe)}k(I,"error",Be);function qe(){I.removeListener("finish",Oe),We()}I.once("close",qe);function Oe(){l("onfinish"),I.removeListener("close",qe),We()}I.once("finish",Oe);function We(){l("unpipe"),Y.unpipe(I)}return I.emit("pipe",Y),ne.flowing||(l("pipe resume"),Y.resume()),I};function pe(I){return function(){var Y=I._readableState;l("pipeOnDrain",Y.awaitDrain),Y.awaitDrain&&Y.awaitDrain--,Y.awaitDrain===0&&t(I,"data")&&(Y.flowing=!0,N(I))}}$.prototype.unpipe=function(I){var M=this._readableState,Y={hasUnpiped:!1};if(M.pipesCount===0)return this;if(M.pipesCount===1)return I&&I!==M.pipes?this:(I||(I=M.pipes),M.pipes=null,M.pipesCount=0,M.flowing=!1,I&&I.emit("unpipe",this,Y),this);if(!I){var ne=M.pipes,de=M.pipesCount;M.pipes=null,M.pipesCount=0,M.flowing=!1;for(var ae=0;ae<de;ae++)ne[ae].emit("unpipe",this,{hasUnpiped:!1});return this}var me=te(M.pipes,I);return me===-1?this:(M.pipes.splice(me,1),M.pipesCount-=1,M.pipesCount===1&&(M.pipes=M.pipes[0]),I.emit("unpipe",this,Y),this)},$.prototype.on=function(I,M){var Y=r.prototype.on.call(this,I,M),ne=this._readableState;return I==="data"?(ne.readableListening=this.listenerCount("readable")>0,ne.flowing!==!1&&this.resume()):I==="readable"&&!ne.endEmitted&&!ne.readableListening&&(ne.readableListening=ne.needReadable=!0,ne.flowing=!1,ne.emittedReadable=!1,l("on readable",ne.length,ne.reading),ne.length?ve(this):ne.reading||xe.nextTick(q,this)),Y},$.prototype.addListener=$.prototype.on,$.prototype.removeListener=function(I,M){var Y=r.prototype.removeListener.call(this,I,M);return I==="readable"&&xe.nextTick(_e,this),Y},$.prototype.removeAllListeners=function(I){var M=r.prototype.removeAllListeners.apply(this,arguments);return(I==="readable"||I===void 0)&&xe.nextTick(_e,this),M};function _e(I){var M=I._readableState;M.readableListening=I.listenerCount("readable")>0,M.resumeScheduled&&!M.paused?M.flowing=!0:I.listenerCount("data")>0&&I.resume()}function q(I){l("readable nexttick read 0"),I.read(0)}$.prototype.resume=function(){var I=this._readableState;return I.flowing||(l("resume"),I.flowing=!I.readableListening,z(this,I)),I.paused=!1,this};function z(I,M){M.resumeScheduled||(M.resumeScheduled=!0,xe.nextTick(W,I,M))}function W(I,M){l("resume",M.reading),M.reading||I.read(0),M.resumeScheduled=!1,I.emit("resume"),N(I),M.flowing&&!M.reading&&I.read(0)}$.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function N(I){var M=I._readableState;for(l("flow",M.flowing);M.flowing&&I.read()!==null;);}$.prototype.wrap=function(I){var M=this,Y=this._readableState,ne=!1;I.on("end",function(){if(l("wrapped end"),Y.decoder&&!Y.ended){var me=Y.decoder.end();me&&me.length&&M.push(me)}M.push(null)}),I.on("data",function(me){if(l("wrapped data"),Y.decoder&&(me=Y.decoder.write(me)),!(Y.objectMode&&me==null)&&!(!Y.objectMode&&(!me||!me.length))){var Le=M.push(me);Le||(ne=!0,I.pause())}});for(var de in I)this[de]===void 0&&typeof I[de]=="function"&&(this[de]=(function(Le){return function(){return I[Le].apply(I,arguments)}})(de));for(var ae=0;ae<B.length;ae++)I.on(B[ae],this.emit.bind(this,B[ae]));return this._read=function(me){l("wrapped _read",me),ne&&(ne=!1,I.resume())},this},typeof Symbol=="function"&&($.prototype[Symbol.asyncIterator]=function(){return x===void 0&&(x=B0()),x(this)}),Object.defineProperty($.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty($.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty($.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(M){this._readableState&&(this._readableState.flowing=M)}}),$._fromList=U,Object.defineProperty($.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function U(I,M){if(M.length===0)return null;var Y;return M.objectMode?Y=M.buffer.shift():!I||I>=M.length?(M.decoder?Y=M.buffer.join(""):M.buffer.length===1?Y=M.buffer.first():Y=M.buffer.concat(M.length),M.buffer.clear()):Y=M.buffer.consume(I,M.decoder),Y}function K(I){var M=I._readableState;l("endReadable",M.endEmitted),M.endEmitted||(M.ended=!0,xe.nextTick(ee,M,I))}function ee(I,M){if(l("endReadableNT",I.endEmitted,I.length),!I.endEmitted&&I.length===0&&(I.endEmitted=!0,M.readable=!1,M.emit("end"),I.autoDestroy)){var Y=M._writableState;(!Y||Y.autoDestroy&&Y.finished)&&M.destroy()}}typeof Symbol=="function"&&($.from=function(I,M){return g===void 0&&(g=I0()),g($,I,M)});function te(I,M){for(var Y=0,ne=I.length;Y<ne;Y++)if(I[Y]===M)return Y;return-1}return qi}var $i,Uo;function fl(){if(Uo)return $i;Uo=1,$i=a;var s=zt().codes,t=s.ERR_METHOD_NOT_IMPLEMENTED,r=s.ERR_MULTIPLE_CALLBACK,e=s.ERR_TRANSFORM_ALREADY_TRANSFORMING,n=s.ERR_TRANSFORM_WITH_LENGTH_0,i=Gt();kt()(a,i);function f(o,d){var u=this._transformState;u.transforming=!1;var h=u.writecb;if(h===null)return this.emit("error",new r);u.writechunk=null,u.writecb=null,d!=null&&this.push(d),h(o);var v=this._readableState;v.reading=!1,(v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}function a(o){if(!(this instanceof a))return new a(o);i.call(this,o),this._transformState={afterTransform:f.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,o&&(typeof o.transform=="function"&&(this._transform=o.transform),typeof o.flush=="function"&&(this._flush=o.flush)),this.on("prefinish",l)}function l(){var o=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(d,u){c(o,d,u)}):c(this,null,null)}a.prototype.push=function(o,d){return this._transformState.needTransform=!1,i.prototype.push.call(this,o,d)},a.prototype._transform=function(o,d,u){u(new t("_transform()"))},a.prototype._write=function(o,d,u){var h=this._transformState;if(h.writecb=u,h.writechunk=o,h.writeencoding=d,!h.transforming){var v=this._readableState;(h.needTransform||v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}},a.prototype._read=function(o){var d=this._transformState;d.writechunk!==null&&!d.transforming?(d.transforming=!0,this._transform(d.writechunk,d.writeencoding,d.afterTransform)):d.needTransform=!0},a.prototype._destroy=function(o,d){i.prototype._destroy.call(this,o,function(u){d(u)})};function c(o,d,u){if(d)return o.emit("error",d);if(u!=null&&o.push(u),o._writableState.length)throw new n;if(o._transformState.transforming)throw new e;return o.push(null)}return $i}var Gi,Ho;function M0(){if(Ho)return Gi;Ho=1,Gi=t;var s=fl();kt()(t,s);function t(r){if(!(this instanceof t))return new t(r);s.call(this,r)}return t.prototype._transform=function(r,e,n){n(null,r)},Gi}var Wi,jo;function C0(){if(jo)return Wi;jo=1;var s;function t(u){var h=!1;return function(){h||(h=!0,u.apply(void 0,arguments))}}var r=zt().codes,e=r.ERR_MISSING_ARGS,n=r.ERR_STREAM_DESTROYED;function i(u){if(u)throw u}function f(u){return u.setHeader&&typeof u.abort=="function"}function a(u,h,v,w){w=t(w);var A=!1;u.on("close",function(){A=!0}),s===void 0&&(s=Fa()),s(u,{readable:h,writable:v},function(E){if(E)return w(E);A=!0,w()});var _=!1;return function(E){if(!A&&!_){if(_=!0,f(u))return u.abort();if(typeof u.destroy=="function")return u.destroy();w(E||new n("pipe"))}}}function l(u){u()}function c(u,h){return u.pipe(h)}function o(u){return!u.length||typeof u[u.length-1]!="function"?i:u.pop()}function d(){for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];var w=o(h);if(Array.isArray(h[0])&&(h=h[0]),h.length<2)throw new e("streams");var A,_=h.map(function(E,x){var g=x<h.length-1,S=x>0;return a(E,g,S,function(B){A||(A=B),B&&_.forEach(l),!g&&(_.forEach(l),w(A))})});return h.reduce(c)}return Wi=d,Wi}var zi,qo;function Qr(){if(qo)return zi;qo=1,zi=r;var s=Ea().EventEmitter,t=kt();t(r,s),r.Readable=ul(),r.Writable=ll(),r.Duplex=Gt(),r.Transform=fl(),r.PassThrough=M0(),r.finished=Fa(),r.pipeline=C0(),r.Stream=r;function r(){s.call(this)}return r.prototype.pipe=function(e,n){var i=this;function f(h){e.writable&&e.write(h)===!1&&i.pause&&i.pause()}i.on("data",f);function a(){i.readable&&i.resume&&i.resume()}e.on("drain",a),!e._isStdio&&(!n||n.end!==!1)&&(i.on("end",c),i.on("close",o));var l=!1;function c(){l||(l=!0,e.end())}function o(){l||(l=!0,typeof e.destroy=="function"&&e.destroy())}function d(h){if(u(),s.listenerCount(this,"error")===0)throw h}i.on("error",d),e.on("error",d);function u(){i.removeListener("data",f),e.removeListener("drain",a),i.removeListener("end",c),i.removeListener("close",o),i.removeListener("error",d),e.removeListener("error",d),i.removeListener("end",u),i.removeListener("close",u),e.removeListener("close",u)}return i.on("end",u),i.on("close",u),e.on("close",u),e.emit("pipe",i),e},zi}var $o;function R0(){return $o||($o=1,(function(s){var t=Ze().Buffer,r=Su(),e=s.exports;e.encodings=null,e.defaultCharUnicode="",e.defaultCharSingleByte="?",e.encode=function(f,a,l){f=""+(f||"");var c=e.getEncoder(a,l),o=c.write(f),d=c.end();return d&&d.length>0?t.concat([o,d]):o},e.decode=function(f,a,l){typeof f=="string"&&(e.skipDecodeWarning||(console.error("Iconv-lite warning: decode()-ing strings is deprecated. Refer to https://github.com/ashtuchkin/iconv-lite/wiki/Use-Buffers-when-decoding"),e.skipDecodeWarning=!0),f=t.from(""+(f||""),"binary"));var c=e.getDecoder(a,l),o=c.write(f),d=c.end();return d?o+d:o},e.encodingExists=function(f){try{return e.getCodec(f),!0}catch{return!1}},e.toEncoding=e.encode,e.fromEncoding=e.decode,e._codecDataCache={},e.getCodec=function(f){e.encodings||(e.encodings=$u());for(var a=e._canonicalizeEncoding(f),l={};;){var c=e._codecDataCache[a];if(c)return c;var o=e.encodings[a];switch(typeof o){case"string":a=o;break;case"object":for(var d in o)l[d]=o[d];l.encodingName||(l.encodingName=a),a=o.type;break;case"function":return l.encodingName||(l.encodingName=a),c=new o(l,e),e._codecDataCache[l.encodingName]=c,c;default:throw new Error("Encoding not recognized: '"+f+"' (searched as: '"+a+"')")}}},e._canonicalizeEncoding=function(i){return(""+i).toLowerCase().replace(/:\d{4}$|[^0-9a-z]/g,"")},e.getEncoder=function(f,a){var l=e.getCodec(f),c=new l.encoder(a,l);return l.bomAware&&a&&a.addBOM&&(c=new r.PrependBOM(c,a)),c},e.getDecoder=function(f,a){var l=e.getCodec(f),c=new l.decoder(a,l);return l.bomAware&&!(a&&a.stripBOM===!1)&&(c=new r.StripBOM(c,a)),c},e.enableStreamingAPI=function(f){if(!e.supportsStreams){var a=Gu()(f);e.IconvLiteEncoderStream=a.IconvLiteEncoderStream,e.IconvLiteDecoderStream=a.IconvLiteDecoderStream,e.encodeStream=function(c,o){return new e.IconvLiteEncoderStream(e.getEncoder(c,o),o)},e.decodeStream=function(c,o){return new e.IconvLiteDecoderStream(e.getDecoder(c,o),o)},e.supportsStreams=!0}};var n;try{n=Qr()}catch{}n&&n.Transform?e.enableStreamingAPI(n):e.encodeStream=e.decodeStream=function(){throw new Error("iconv-lite Streaming API is not enabled. Use iconv.enableStreamingAPI(require('stream')); to enable it.")}})(bn)),bn.exports}var Go;function en(){if(Go)return Cr;Go=1,Object.defineProperty(Cr,"__esModule",{value:!0});var s=R0(),t=(function(){function r(e,n,i){if(this._dynamicSize=!0,this._byteLength=0,this.failurePosition=0,this._byteOffset=n||0,e instanceof ArrayBuffer)this.buffer=e;else if(e instanceof DataView)this.dataView=e;else if(e&&e.buffer instanceof ArrayBuffer)this._byteOffset+=e.byteOffset,this._buffer=e.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._dataView.byteLength+this._byteOffset;else throw new Error("Unknown arrayBuffer");this.position=0,this.endianness=i??r.LITTLE_ENDIAN}return r.prototype.save=function(e){var n=new Blob([this.buffer]),i=window.webkitURL||window.URL;if(i&&i.createObjectURL){var f=i.createObjectURL(n),a=document.createElement("a");a.setAttribute("href",f),a.setAttribute("download",e),a.click(),i.revokeObjectURL(f)}else throw"DataStream.save: Can't create object URL."},Object.defineProperty(r.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(e){e||this._trimAlloc(),this._dynamicSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(e){this._buffer=e,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(e){this._byteOffset=e,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dataView",{get:function(){return this._dataView},set:function(e){this._byteOffset=e.byteOffset,this._buffer=e.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+e.byteLength},enumerable:!1,configurable:!0}),r.prototype._realloc=function(e){if(this._dynamicSize){var n=this._byteOffset+this.position+e,i=this._buffer.byteLength;if(n<=i){n>this._byteLength&&(this._byteLength=n);return}for(i<1&&(i=1);n>i;)i*=2;var f=new ArrayBuffer(i),a=new Uint8Array(this._buffer),l=new Uint8Array(f,0,a.length);l.set(a),this.buffer=f,this._byteLength=n}},r.prototype._trimAlloc=function(){if(this._byteLength!=this._buffer.byteLength){var e=new ArrayBuffer(this._byteLength),n=new Uint8Array(e),i=new Uint8Array(this._buffer,0,n.length);n.set(i),this.buffer=e}},r.prototype.seek=function(e){var n=Math.max(0,Math.min(this.byteLength,e));this.position=isNaN(n)||!isFinite(n)?0:n},r.prototype.isEof=function(){return this.position>=this.byteLength},r.prototype.mapInt32Array=function(e,n){this._realloc(e*4);var i=new Int32Array(this._buffer,this.byteOffset+this.position,e);return r.arrayToNative(i,n??this.endianness),this.position+=e*4,i},r.prototype.mapInt16Array=function(e,n){this._realloc(e*2);var i=new Int16Array(this._buffer,this.byteOffset+this.position,e);return r.arrayToNative(i,n??this.endianness),this.position+=e*2,i},r.prototype.mapInt8Array=function(e){this._realloc(e*1);var n=new Int8Array(this._buffer,this.byteOffset+this.position,e);return this.position+=e*1,n},r.prototype.mapUint32Array=function(e,n){this._realloc(e*4);var i=new Uint32Array(this._buffer,this.byteOffset+this.position,e);return r.arrayToNative(i,n??this.endianness),this.position+=e*4,i},r.prototype.mapUint16Array=function(e,n){this._realloc(e*2);var i=new Uint16Array(this._buffer,this.byteOffset+this.position,e);return r.arrayToNative(i,n??this.endianness),this.position+=e*2,i},r.prototype.mapUint8Array=function(e){this._realloc(e*1);var n=new Uint8Array(this._buffer,this.byteOffset+this.position,e);return this.position+=e*1,n},r.prototype.mapFloat64Array=function(e,n){this._realloc(e*8);var i=new Float64Array(this._buffer,this.byteOffset+this.position,e);return r.arrayToNative(i,n??this.endianness),this.position+=e*8,i},r.prototype.mapFloat32Array=function(e,n){this._realloc(e*4);var i=new Float32Array(this._buffer,this.byteOffset+this.position,e);return r.arrayToNative(i,n??this.endianness),this.position+=e*4,i},r.prototype.readInt32Array=function(e,n){e=e??(this.byteLength-this.position)/4;var i=new Int32Array(e);return r.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,e*i.BYTES_PER_ELEMENT),r.arrayToNative(i,n??this.endianness),this.position+=i.byteLength,i},r.prototype.readInt16Array=function(e,n){e=e??(this.byteLength-this.position)/2;var i=new Int16Array(e);return r.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,e*i.BYTES_PER_ELEMENT),r.arrayToNative(i,n??this.endianness),this.position+=i.byteLength,i},r.prototype.readInt8Array=function(e){e=e??this.byteLength-this.position;var n=new Int8Array(e);return r.memcpy(n.buffer,0,this.buffer,this.byteOffset+this.position,e*n.BYTES_PER_ELEMENT),this.position+=n.byteLength,n},r.prototype.readUint32Array=function(e,n){e=e??(this.byteLength-this.position)/4;var i=new Uint32Array(e);return r.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,e*i.BYTES_PER_ELEMENT),r.arrayToNative(i,n??this.endianness),this.position+=i.byteLength,i},r.prototype.readUint16Array=function(e,n){e=e??(this.byteLength-this.position)/2;var i=new Uint16Array(e);return r.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,e*i.BYTES_PER_ELEMENT),r.arrayToNative(i,n??this.endianness),this.position+=i.byteLength,i},r.prototype.readUint8Array=function(e){e=e??this.byteLength-this.position;var n=new Uint8Array(e);return r.memcpy(n.buffer,0,this.buffer,this.byteOffset+this.position,e*n.BYTES_PER_ELEMENT),this.position+=n.byteLength,n},r.prototype.readToUint8Array=function(e,n,i){e=e??this.byteLength-this.position,r.memcpy(n.buffer,i,this.buffer,this.byteOffset+this.position,e*n.BYTES_PER_ELEMENT),this.position+=n.byteLength},r.prototype.readFloat64Array=function(e,n){e=e??(this.byteLength-this.position)/8;var i=new Float64Array(e);return r.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,e*i.BYTES_PER_ELEMENT),r.arrayToNative(i,n??this.endianness),this.position+=i.byteLength,i},r.prototype.readFloat32Array=function(e,n){e=e??(this.byteLength-this.position)/4;var i=new Float32Array(e);return r.memcpy(i.buffer,0,this.buffer,this.byteOffset+this.position,e*i.BYTES_PER_ELEMENT),r.arrayToNative(i,n??this.endianness),this.position+=i.byteLength,i},r.prototype.writeInt32Array=function(e,n){if(this._realloc(e.length*4),e instanceof Int32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt32Array(e.length,n);else for(var i=0;i<e.length;i++)this.writeInt32(e[i],n)},r.prototype.writeInt16Array=function(e,n){if(this._realloc(e.length*2),e instanceof Int16Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt16Array(e.length,n);else for(var i=0;i<e.length;i++)this.writeInt16(e[i],n)},r.prototype.writeInt8Array=function(e){if(this._realloc(e.length*1),e instanceof Int8Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt8Array(e.length);else for(var n=0;n<e.length;n++)this.writeInt8(e[n])},r.prototype.writeUint32Array=function(e,n){if(this._realloc(e.length*4),e instanceof Uint32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint32Array(e.length,n);else for(var i=0;i<e.length;i++)this.writeUint32(e[i],n)},r.prototype.writeUint16Array=function(e,n){if(this._realloc(e.length*2),e instanceof Uint16Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint16Array(e.length,n);else for(var i=0;i<e.length;i++)this.writeUint16(e[i],n)},r.prototype.writeUint8Array=function(e){if(this._realloc(e.length*1),e instanceof Uint8Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint8Array(e.length);else for(var n=0;n<e.length;n++)this.writeUint8(e[n])},r.prototype.writeFloat64Array=function(e,n){if(this._realloc(e.length*8),e instanceof Float64Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapFloat64Array(e.length,n);else for(var i=0;i<e.length;i++)this.writeFloat64(e[i],n)},r.prototype.writeFloat32Array=function(e,n){if(this._realloc(e.length*4),e instanceof Float32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapFloat32Array(e.length,n);else for(var i=0;i<e.length;i++)this.writeFloat32(e[i],n)},r.prototype.readInt32=function(e){var n=this._dataView.getInt32(this.position,e??this.endianness);return this.position+=4,n},r.prototype.readInt=function(e){return this.seek(e),this.readInt32()},r.prototype.readInt16=function(e){var n=this._dataView.getInt16(this.position,e??this.endianness);return this.position+=2,n},r.prototype.readShort=function(e){return this.seek(e),this.readInt16()},r.prototype.readInt8=function(){var e=this._dataView.getInt8(this.position);return this.position+=1,e},r.prototype.readByte=function(e){return this.seek(e),this.readInt8()},r.prototype.readUint32=function(e){var n=this._dataView.getUint32(this.position,e??this.endianness);return this.position+=4,n},r.prototype.readUint16=function(e){var n=this._dataView.getUint16(this.position,e??this.endianness);return this.position+=2,n},r.prototype.readUint8=function(){var e=this._dataView.getUint8(this.position);return this.position+=1,e},r.prototype.readFloat32=function(e){var n=this._dataView.getFloat32(this.position,e??this.endianness);return this.position+=4,n},r.prototype.readFloat64=function(e){var n=this._dataView.getFloat64(this.position,e??this.endianness);return this.position+=8,n},r.prototype.writeInt32=function(e,n){this._realloc(4),this._dataView.setInt32(this.position,e,n??this.endianness),this.position+=4},r.prototype.writeInt16=function(e,n){this._realloc(2),this._dataView.setInt16(this.position,e,n??this.endianness),this.position+=2},r.prototype.writeInt8=function(e){this._realloc(1),this._dataView.setInt8(this.position,e),this.position+=1},r.prototype.writeUint32=function(e,n){this._realloc(4),this._dataView.setUint32(this.position,e,n??this.endianness),this.position+=4},r.prototype.writeUint16=function(e,n){this._realloc(2),this._dataView.setUint16(this.position,e,n??this.endianness),this.position+=2},r.prototype.writeUint8=function(e){this._realloc(1),this._dataView.setUint8(this.position,e),this.position+=1},r.prototype.writeFloat32=function(e,n){this._realloc(4),this._dataView.setFloat32(this.position,e,n??this.endianness),this.position+=4},r.prototype.writeFloat64=function(e,n){this._realloc(8),this._dataView.setFloat64(this.position,e,n??this.endianness),this.position+=8},r.memcpy=function(e,n,i,f,a){var l=new Uint8Array(e,n,a),c=new Uint8Array(i,f,a);l.set(c)},r.arrayToNative=function(e,n){return n==this.endianness?e:this.flipArrayEndianness(e)},r.nativeToEndian=function(e,n){return this.endianness==n?e:this.flipArrayEndianness(e)},r.flipArrayEndianness=function(e){for(var n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),i=0;i<e.byteLength;i+=e.BYTES_PER_ELEMENT)for(var f=i+e.BYTES_PER_ELEMENT-1,a=i;f>a;f--,a++){var l=n[a];n[a]=n[f],n[f]=l}return e},r.createStringFromArray=function(e){for(var n="",i=0;i<e.length;i++)n+=String.fromCharCode(e[i]);return n},r.prototype.readStruct=function(e){for(var n={},i,f,a=this.position,l=0;l<e.length;l+=2){if(i=e[l+1],f=this.readType(i,n),f==null)return this.failurePosition==0&&(this.failurePosition=this.position),this.position=a,null;n[e[l]]=f}return n},r.prototype.readUCS2String=function(e,n){return r.createStringFromArray(this.readUint16Array(e,n))},r.prototype.readStringAt=function(e,n){return this.seek(e),this.readUCS2String(n)},r.prototype.writeUCS2String=function(e,n,i){i==null&&(i=e.length);for(var f=0;f<e.length&&f<i;f++)this.writeUint16(e.charCodeAt(f),n);for(;f<i;f++)this.writeUint16(0,n)},r.prototype.readString=function(e,n){return n==null||n=="ASCII"?r.createStringFromArray(this.mapUint8Array(e??this.byteLength-this.position)):s.decode(this.mapUint8Array(e),n)},r.prototype.writeString=function(e,n,i){if(n==null||n=="ASCII")if(i!=null){var f=0,a=Math.min(e.length,i);for(f=0;f<a;f++)this.writeUint8(e.charCodeAt(f));for(;f<i;f++)this.writeUint8(0)}else for(var f=0;f<e.length;f++)this.writeUint8(e.charCodeAt(f));else this.writeUint8Array(s.encode(e.substring(0,i),n))},r.prototype.readCString=function(e){var n=this.byteLength-this.position,i=new Uint8Array(this._buffer,this._byteOffset+this.position),f=n;e!=null&&(f=Math.min(e,n));for(var a=0;a<f&&i[a]!=0;a++);var l=r.createStringFromArray(this.mapUint8Array(a));return e!=null?this.position+=f-a:a!=n&&(this.position+=1),l},r.prototype.writeCString=function(e,n){if(n!=null){var i=0,f=Math.min(e.length,n);for(i=0;i<f;i++)this.writeUint8(e.charCodeAt(i));for(;i<n;i++)this.writeUint8(0)}else{for(var i=0;i<e.length;i++)this.writeUint8(e.charCodeAt(i));this.writeUint8(0)}},r.prototype.readType=function(e,n){if(typeof e=="function")return e(this,n);if(typeof e=="object"&&!(e instanceof Array))return e.get(this,n);if(e instanceof Array&&e.length!=3)return this.readStruct(e);var i=null,f=null,a="ASCII",l=this.position,c;if(typeof e=="string"&&/:/.test(e)){var o=e.split(":");e=o[0],c=o[1],n[c]!=null?f=parseInt(n[c]):f=parseInt(o[1])}if(typeof e=="string"&&/,/.test(e)){var o=e.split(",");e=o[0],a=parseInt(o[1]).toString()}switch(e){case"uint8":i=this.readUint8();break;case"int8":i=this.readInt8();break;case"uint16":i=this.readUint16(this.endianness);break;case"int16":i=this.readInt16(this.endianness);break;case"uint32":i=this.readUint32(this.endianness);break;case"int32":i=this.readInt32(this.endianness);break;case"float32":i=this.readFloat32(this.endianness);break;case"float64":i=this.readFloat64(this.endianness);break;case"uint16be":i=this.readUint16(r.BIG_ENDIAN);break;case"int16be":i=this.readInt16(r.BIG_ENDIAN);break;case"uint32be":i=this.readUint32(r.BIG_ENDIAN);break;case"int32be":i=this.readInt32(r.BIG_ENDIAN);break;case"float32be":i=this.readFloat32(r.BIG_ENDIAN);break;case"float64be":i=this.readFloat64(r.BIG_ENDIAN);break;case"uint16le":i=this.readUint16(r.LITTLE_ENDIAN);break;case"int16le":i=this.readInt16(r.LITTLE_ENDIAN);break;case"uint32le":i=this.readUint32(r.LITTLE_ENDIAN);break;case"int32le":i=this.readInt32(r.LITTLE_ENDIAN);break;case"float32le":i=this.readFloat32(r.LITTLE_ENDIAN);break;case"float64le":i=this.readFloat64(r.LITTLE_ENDIAN);break;case"cstring":i=this.readCString(f);break;case"string":i=this.readString(f,a);break;case"u16string":i=this.readUCS2String(f,this.endianness);break;case"u16stringle":i=this.readUCS2String(f,r.LITTLE_ENDIAN);break;case"u16stringbe":i=this.readUCS2String(f,r.BIG_ENDIAN);break;default:if(e.length==3){var d=e[1],c=e[2],u=0;if(typeof c=="function"?u=c(n,this,e):typeof c=="string"&&n[c]!=null?u=parseInt(n[c]):u=parseInt(c),typeof d=="string"){var h=d.replace(/(le|be)$/,""),v=null;switch(/le$/.test(d)?v=r.LITTLE_ENDIAN:/be$/.test(d)&&(v=r.BIG_ENDIAN),c=="*"&&(u=null),h){case"uint8":i=this.readUint8Array(u);break;case"uint16":i=this.readUint16Array(u,v);break;case"uint32":i=this.readUint32Array(u,v);break;case"int8":i=this.readInt8Array(u);break;case"int16":i=this.readInt16Array(u,v);break;case"int32":i=this.readInt32Array(u,v);break;case"float32":i=this.readFloat32Array(u,v);break;case"float64":i=this.readFloat64Array(u,v);break;case"cstring":case"utf16string":case"string":if(u==null)for(i=[];!this.isEof();){var w=this.readType(d,n);if(w==null)break;i.push(w)}else{i=new Array(u);for(var A=0;A<u;A++)i[A]=this.readType(d,n)}break}}else if(c=="*")for(i=[],this.buffer;;){var _=this.position;try{var E=this.readType(d,n);if(E==null){this.position=_;break}i.push(E)}catch{this.position=_;break}}else{i=new Array(u);for(var A=0;A<u;A++){var w=this.readType(d,n);if(w==null)return null;i[A]=w}}break}}return f!=null&&(this.position=l+f),i},r.prototype.writeStruct=function(e,n){for(var i=0;i<e.length;i+=2){var f=e[i+1];this.writeType(f,n[e[i]],n)}},r.prototype.writeType=function(e,n,i){if(typeof e=="function")return e(this,n);if(typeof e=="object"&&!(e instanceof Array))return e.set(this,n,i);var f=null,a="ASCII",l=this.position;if(typeof e=="string"&&/:/.test(e)){var c=e.split(":");e=c[0],f=parseInt(c[1])}if(typeof e=="string"&&/,/.test(e)){var c=e.split(",");e=c[0],a=parseInt(c[1]).toString()}switch(e){case"uint8":this.writeUint8(n);break;case"int8":this.writeInt8(n);break;case"uint16":this.writeUint16(n,this.endianness);break;case"int16":this.writeInt16(n,this.endianness);break;case"uint32":this.writeUint32(n,this.endianness);break;case"int32":this.writeInt32(n,this.endianness);break;case"float32":this.writeFloat32(n,this.endianness);break;case"float64":this.writeFloat64(n,this.endianness);break;case"uint16be":this.writeUint16(n,r.BIG_ENDIAN);break;case"int16be":this.writeInt16(n,r.BIG_ENDIAN);break;case"uint32be":this.writeUint32(n,r.BIG_ENDIAN);break;case"int32be":this.writeInt32(n,r.BIG_ENDIAN);break;case"float32be":this.writeFloat32(n,r.BIG_ENDIAN);break;case"float64be":this.writeFloat64(n,r.BIG_ENDIAN);break;case"uint16le":this.writeUint16(n,r.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(n,r.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(n,r.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(n,r.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(n,r.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(n,r.LITTLE_ENDIAN);break;case"cstring":this.writeCString(n,f);break;case"string":this.writeString(n,a,f);break;case"u16string":this.writeUCS2String(n,this.endianness,f);break;case"u16stringle":this.writeUCS2String(n,r.LITTLE_ENDIAN,f);break;case"u16stringbe":this.writeUCS2String(n,r.BIG_ENDIAN,f);break;default:if(e.length==3){for(var o=e[1],d=0;d<n.length;d++)this.writeType(o,n[d],e[2]);break}else{this.writeStruct(e,n);break}}f!=null&&(this.position=l,this._realloc(f),this.position=l+f)},r.BIG_ENDIAN=!1,r.LITTLE_ENDIAN=!0,r.endianness=new Int8Array(new Int16Array([1]).buffer)[0]>0,r})();return Cr.default=t,Uint8Array.prototype.BYTES_PER_ELEMENT===void 0&&(Object.defineProperties(Uint8Array.prototype,{BYTES_PER_ELEMENT:{value:Uint8Array.BYTES_PER_ELEMENT}}),Object.defineProperties(Int8Array.prototype,{BYTES_PER_ELEMENT:{value:Int8Array.BYTES_PER_ELEMENT}}),Object.defineProperties(Uint8ClampedArray.prototype,{BYTES_PER_ELEMENT:{value:Uint8ClampedArray.BYTES_PER_ELEMENT}}),Object.defineProperties(Uint16Array.prototype,{BYTES_PER_ELEMENT:{value:Uint16Array.BYTES_PER_ELEMENT}}),Object.defineProperties(Int16Array.prototype,{BYTES_PER_ELEMENT:{value:Int16Array.BYTES_PER_ELEMENT}}),Object.defineProperties(Uint32Array.prototype,{BYTES_PER_ELEMENT:{value:Uint32Array.BYTES_PER_ELEMENT}}),Object.defineProperties(Int32Array.prototype,{BYTES_PER_ELEMENT:{value:Int32Array.BYTES_PER_ELEMENT}}),Object.defineProperties(Float64Array.prototype,{BYTES_PER_ELEMENT:{value:Float64Array.BYTES_PER_ELEMENT}})),Cr}var xt={},Wo;function dl(){if(Wo)return xt;Wo=1;var s=xt&&xt.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(xt,"__esModule",{value:!0}),xt.Reader=xt.TypeEnum=void 0;var t=s(en()),r=xr(),e=s(xa()),n;(function(f){f[f.DIRECTORY=1]="DIRECTORY",f[f.DOCUMENT=2]="DOCUMENT",f[f.ROOT=5]="ROOT"})(n||(xt.TypeEnum=n={}));var i=(function(){function f(a){this.ds=new t.default(a,0,t.default.LITTLE_ENDIAN)}return f.prototype.isMSGFile=function(){return this.ds.seek(0),(0,r.arraysEqual)(e.default.FILE_HEADER,this.ds.readInt8Array(e.default.FILE_HEADER.length))},f.prototype.headerData=function(){this.bigBlockSize=this.ds.readByte(30)==e.default.MSG.L_BIG_BLOCK_MARK?e.default.MSG.L_BIG_BLOCK_SIZE:e.default.MSG.S_BIG_BLOCK_SIZE,this.bigBlockLength=this.bigBlockSize/4,this.xBlockLength=this.bigBlockLength-1,this.batCount=this.ds.readInt(e.default.MSG.HEADER.BAT_COUNT_OFFSET),this.propertyStart=this.ds.readInt(e.default.MSG.HEADER.PROPERTY_START_OFFSET),this.sbatStart=this.ds.readInt(e.default.MSG.HEADER.SBAT_START_OFFSET),this.sbatCount=this.ds.readInt(e.default.MSG.HEADER.SBAT_COUNT_OFFSET),this.xbatStart=this.ds.readInt(e.default.MSG.HEADER.XBAT_START_OFFSET),this.xbatCount=this.ds.readInt(e.default.MSG.HEADER.XBAT_COUNT_OFFSET)},f.prototype.convertName=function(a){var l=this.ds.readShort(a+e.default.MSG.PROP.NAME_SIZE_OFFSET);return l<1?"":this.ds.readStringAt(a,l/2).split("\0")[0]},f.prototype.convertProperty=function(a){return{type:this.ds.readByte(a+e.default.MSG.PROP.TYPE_OFFSET),name:this.convertName(a),previousProperty:this.ds.readInt(a+e.default.MSG.PROP.PREVIOUS_PROPERTY_OFFSET),nextProperty:this.ds.readInt(a+e.default.MSG.PROP.NEXT_PROPERTY_OFFSET),childProperty:this.ds.readInt(a+e.default.MSG.PROP.CHILD_PROPERTY_OFFSET),startBlock:this.ds.readInt(a+e.default.MSG.PROP.START_BLOCK_OFFSET),sizeBlock:this.ds.readInt(a+e.default.MSG.PROP.SIZE_OFFSET)}},f.prototype.convertBlockToProperties=function(a,l){for(var c=this.bigBlockSize/e.default.MSG.PROP.PROPERTY_SIZE,o=this.getBlockOffsetAt(a),d=0;d<c&&!(this.ds.byteLength<o+e.default.MSG.PROP.TYPE_OFFSET);d++){var u=this.ds.readByte(o+e.default.MSG.PROP.TYPE_OFFSET);switch(u){case e.default.MSG.PROP.TYPE_ENUM.ROOT:case e.default.MSG.PROP.TYPE_ENUM.DIRECTORY:case e.default.MSG.PROP.TYPE_ENUM.DOCUMENT:l.push(this.convertProperty(o));break}o+=e.default.MSG.PROP.PROPERTY_SIZE}},f.prototype.createPropertyHierarchy=function(a,l){if(!(!l||l.childProperty==e.default.MSG.PROP.NO_INDEX)){l.children=[];for(var c=[{currentMode:"walk",currentIndex:l.childProperty}];c.length!=0;){var o=c.pop(),d=o.currentMode,u=o.currentIndex,h=a[u];d==="push"?l.children.push(u):(h.type==e.default.MSG.PROP.TYPE_ENUM.DIRECTORY&&this.createPropertyHierarchy(a,h),h.nextProperty!=e.default.MSG.PROP.NO_INDEX&&c.push({currentMode:"walk",currentIndex:h.nextProperty}),c.push({currentMode:"push",currentIndex:u}),h.previousProperty!=e.default.MSG.PROP.NO_INDEX&&c.push({currentMode:"walk",currentIndex:h.previousProperty}))}}},f.prototype.propertyDataReader=function(a){for(var l=[],c=a;c!=e.default.MSG.END_OF_CHAIN;)this.convertBlockToProperties(c,l),c=this.getNextBlock(c);return this.createPropertyHierarchy(l,l[0]),l},f.prototype.parse=function(){this.headerData(),this.batData=this.batDataReader(),this.xbatCount>0&&this.xbatDataReader(),this.sbatData=this.sbatDataReader(),this.propertyData=this.propertyDataReader(this.propertyStart),this.bigBlockTable=this.readBigBlockTable()},f.prototype.batCountInHeader=function(){var a=(e.default.MSG.S_BIG_BLOCK_SIZE-e.default.MSG.HEADER.BAT_START_OFFSET)/4;return Math.min(this.batCount,a)},f.prototype.batDataReader=function(){var a=new Array(this.batCountInHeader());this.ds.seek(e.default.MSG.HEADER.BAT_START_OFFSET);for(var l=0;l<a.length;l++)a[l]=this.ds.readInt32();return a},f.prototype.getBlockOffsetAt=function(a){return(a+1)*this.bigBlockSize},f.prototype.getBlockAt=function(a){var l=this.getBlockOffsetAt(a);return this.ds.seek(l),this.ds.readInt32Array(this.bigBlockLength)},f.prototype.getBlockValueAt=function(a,l){var c=this.getBlockOffsetAt(a);return this.ds.seek(c+4*l),this.ds.readInt32()},f.prototype.getNextBlockInner=function(a,l){var c=Math.floor(a/this.bigBlockLength),o=a%this.bigBlockLength,d=l[c];return typeof d>"u"?e.default.MSG.END_OF_CHAIN:this.getBlockValueAt(d,o)},f.prototype.getNextBlock=function(a){return this.getNextBlockInner(a,this.batData)},f.prototype.sbatDataReader=function(){for(var a=[],l=this.sbatStart,c=0;c<this.sbatCount&&l&&l!=e.default.MSG.END_OF_CHAIN;c++)a.push(l),l=this.getNextBlock(l);return a},f.prototype.xbatDataReader=function(){for(var a=this.batCountInHeader(),l=this.batCount,c=l-a,o=this.xbatStart,d=0;d<this.xbatCount;d++){for(var u=this.getBlockAt(o),h=Math.min(c,this.xBlockLength),v=0;v<h;v++){var w=u[v];if(w==e.default.MSG.UNUSED_BLOCK||w==e.default.MSG.END_OF_CHAIN)break;this.batData.push(w)}if(c-=h,o=u[this.xBlockLength],o==e.default.MSG.UNUSED_BLOCK||o==e.default.MSG.END_OF_CHAIN)break}},f.prototype.getNextBlockSmall=function(a){return this.getNextBlockInner(a,this.sbatData)},f.prototype.getChainByBlockSmall=function(a){for(var l=[],c=a.startBlock;c!=e.default.MSG.END_OF_CHAIN;)l.push(c),c=this.getNextBlockSmall(c);return l},f.prototype.readBigBlockTable=function(){for(var a=this.propertyData[0],l=[],c=a.startBlock,o=0;c!=e.default.MSG.END_OF_CHAIN;o++)l.push(c),c=this.getNextBlock(c);return l},f.prototype.readDataByBlockSmall=function(a,l,c,o){var d=a*e.default.MSG.SMALL_BLOCK_SIZE,u=Math.floor(d/this.bigBlockSize),h=d%this.bigBlockSize,v=this.bigBlockTable[u],w=this.getBlockOffsetAt(v);return this.ds.seek(w+h),this.ds.readToUint8Array(l,c,o)},f.prototype.readChainDataByBlockSmall=function(a,l){for(var c=new Uint8Array(a.sizeBlock),o=0,d=0;o<l.length;o++){var u=c.length<d+e.default.MSG.SMALL_BLOCK_SIZE?c.length-d:e.default.MSG.SMALL_BLOCK_SIZE;this.readDataByBlockSmall(l[o],u,c,d),d+=u}return c},f.prototype.readProperty=function(a){if(a.sizeBlock)if(a.sizeBlock<e.default.MSG.BIG_BLOCK_MIN_DOC_SIZE){var l=this.getChainByBlockSmall(a);if(l.length==1){var c=new Uint8Array(a.sizeBlock);return this.readDataByBlockSmall(a.startBlock,a.sizeBlock,c,0),c}else if(l.length>1)return this.readChainDataByBlockSmall(a,l);return new Uint8Array(0)}else{for(var o=a.startBlock,d=a.sizeBlock,u=0,c=new Uint8Array(a.sizeBlock);1<=d;){var h=this.getBlockOffsetAt(o);this.ds.seek(h);var v=Math.min(d,this.bigBlockSize),w=this.ds.readUint8Array(v);c.set(w,u),u+=v,d-=v,o=this.getNextBlock(o)}return c}else return new Uint8Array(0)},f.prototype.readFileOf=function(a){return this.readProperty(this.propertyData[a])},f.prototype.folderOf=function(a){var l=this,c=this.propertyData;if(!c)return null;var o=c[a];return{dataId:a,name:o.name,fileNames:function(){var d=o.children;return d?d.map(function(u){return c[u]}).filter(function(u){return u.type===n.DOCUMENT}).map(function(u){return u.name}):[]},fileNameSets:function(){var d=o.children;return d?d.map(function(u){return{subIndex:u,entry:c[u]}}).filter(function(u){return u.entry.type===n.DOCUMENT}).map(function(u){return{name:u.entry.name,length:u.entry.sizeBlock,dataId:u.subIndex,provider:function(){return l.readProperty(u.entry)}}}):[]},subFolders:function(){var d=o.children;return d?d.filter(function(u){return c[u].type==n.DIRECTORY}).map(function(u){return l.folderOf(u)}):[]},readFile:function(d){var u=o.children;if(u)for(var h=0,v=u;h<v.length;h++){var w=v[h],A=c[w];if(A&&A.type===n.DOCUMENT&&A.name===d)return l.readProperty(A)}return null}}},f.prototype.rootFolder=function(){return this.folderOf(0)},f})();return xt.Reader=i,xt}var Nt={},zo;function k0(){if(zo)return Nt;zo=1;var s=Nt&&Nt.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.burn=l;var t=dl(),r=s(en()),e=s(xa());function n(c){return c+511&-512}function i(c){return c+63&-64}var f=(function(){function c(o){this.sectors=o}return c.prototype.allocate=function(o){for(var d=this.sectors.length,u=0;u<o;u++){var h=u+1===o?-2:d+u+1;this.sectors.push(h)}return d},c.prototype.allocateAs=function(o,d){for(var u=this.sectors.length,h=0;h<o;h++)this.sectors.push(d);return u},c.prototype.finalize=function(o,d){for(var u=(o-this.sectors.length%o)%o;u>=1;u-=1)this.sectors.push(d);return this},c.prototype.count=function(){return this.sectors.length},c})(),a=(function(){function c(o){this.fat=new f([]),this.miniFat=new f([]),this.liteEnts=o.map(function(W){return{entry:W,left:-1,right:-1,child:-1,firstSector:0,isMini:W.length<4096,isRed:!1}}),this.buildTree(0);for(var d=this.fat.allocate(n(128*this.liteEnts.length)/512),u=0,h=this.liteEnts.filter(function(W){return W.entry.type==t.TypeEnum.DOCUMENT&&W.isMini===!1});u<h.length;u++){var v=h[u];v.firstSector=v.entry.length===0?-2:this.fat.allocate(n(v.entry.length)/512)}for(var w=0,A=this.liteEnts.filter(function(W){return W.entry.type==t.TypeEnum.DOCUMENT&&W.isMini===!0});w<A.length;w++){var v=A[w];v.firstSector=v.entry.length===0?-2:this.miniFat.allocate(i(v.entry.length)/64)}var _=n(4*this.miniFat.count())/512,E=_!==0?this.fat.allocate(_):-2,x=64*this.miniFat.count(),g=this.fat.allocate(n(x)/512);this.liteEnts[0].firstSector=g;var S=this.fat.allocateAs(n(4*(this.fat.count()+this.fat.count()/128+this.fat.count()/13952))/512,-3),B=this.fat.count()-S,k=B>109?n(4*Math.floor((B-109)/127*128))/512:0,D=k!==0?this.fat.allocateAs(k,-4):-2,$=new ArrayBuffer(512*(1+this.fat.count())),j=new r.default($,0,r.default.LITTLE_ENDIAN);j.dynamicSize=!1,this.miniFat.finalize(512/4,-1);var Q=[],L=[];{for(var ie=0;ie<109&&ie<B;ie++)Q.push(S+ie);for(var ue=D+1;ie<B;ie++){L.push(S+ie);var fe=L.length&127;fe===127&&(L.push(ue),ue++)}for(;;){var fe=L.length&127;if(fe===0)break;L.push(fe===127?-2:-1)}}{j.seek(0),j.writeUint8Array(e.default.FILE_HEADER),j.seek(24),j.writeUint16(62),j.writeUint16(3),j.writeUint16(65534),j.writeUint16(9),j.writeUint16(6),j.seek(44),j.writeInt32(B),j.writeInt32(d),j.seek(56),j.writeInt32(4096),j.writeInt32(E),j.writeInt32(_),j.writeInt32(D),j.writeInt32(k);for(var ie=0;ie<Q.length;ie++)j.writeInt32(Q[ie]);for(;ie<109;ie++)j.writeInt32(-1)}for(var ie=0;ie<this.liteEnts.length;ie++){var v=this.liteEnts[ie],he=512*(1+d)+128*ie;j.seek(he),j.writeUCS2String(v.entry.name,null,null);var ve=j.position-he;j.seek(he+64),j.writeUint16(Math.min(64,ve+2)),j.writeUint8(v.entry.type),j.writeUint8(v.isRed?0:1),j.writeInt32(v.left),j.writeInt32(v.right),j.writeInt32(v.child),ie===0&&(j.seek(he+80),j.writeUint8Array([11,13,2,0,0,0,0,0,192,0,0,0,0,0,0,70]));var oe=ie===0?x:v.entry.length,be=oe!==0?v.firstSector:v.entry.type===t.TypeEnum.DIRECTORY?0:-2;j.seek(he+116),j.writeInt32(be),j.writeInt32(oe)}for(var ce=0,pe=this.liteEnts.filter(function(W){return W.entry.type==t.TypeEnum.DOCUMENT&&W.isMini===!1});ce<pe.length;ce++){var v=pe[ce],_e=v.entry.binaryProvider();j.seek(512*(1+v.firstSector)),j.writeUint8Array(_e)}for(var q=0,z=this.liteEnts.filter(function(W){return W.entry.type==t.TypeEnum.DOCUMENT&&W.isMini===!0});q<z.length;q++){var v=z[q],_e=v.entry.binaryProvider();j.seek(512*(1+g)+64*v.firstSector),j.writeUint8Array(_e)}j.seek(512*(1+E)),j.writeInt32Array(this.miniFat.sectors),this.fat.finalize(512/4,-1),j.seek(512*(1+S)),j.writeInt32Array(this.fat.sectors),k>=1&&(j.seek(512*(1+D)),j.writeInt32Array(L)),this.array=$}return c.prototype.compareName=function(o,d){var u=o.length-d.length;if(u===0){var h=o.toUpperCase(),v=d.toUpperCase();h>v?u=1:h<v&&(u=-1)}return u},c.prototype.buildTree=function(o){var d=this,u=this.liteEnts,h=u[o];if(h.entry.type===t.TypeEnum.DOCUMENT)throw new Error("It must be a storage!");var v=h.entry.children.concat();if(1<=v.length){v.sort(function(g,S){return d.compareName(u[g].entry.name,u[S].entry.name)});var w=function(g,S,B){if(g<S){var k=Math.floor((g+S)/2),D=v[k],$=u[D];return $.isRed=B,$.left=w(g,k,!B),$.right=w(k+1,S,!B),D}else return-1},A=function(){var g=Math.floor(v.length/2),S=v[g],B=u[S];return B.isRed=!1,B.left=w(0,g,!0),B.right=w(g+1,v.length,!0),S};h.child=A();for(var _=0,E=v.filter(function(g){return u[g].entry.type===t.TypeEnum.DIRECTORY});_<E.length;_++){var x=E[_];this.buildTree(x)}}},c})();function l(c){return new Uint8Array(new a(c).array)}return Nt}var Pt={},Vo;function D0(){if(Vo)return Pt;Vo=1;var s=Pt&&Pt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.parse=r;var t=s(en());function r(e){for(var n=new t.default(e,0,t.default.LITTLE_ENDIAN),i=[];!n.isEof();){var f=n.readUint32(),a=n.readUint16(),l=n.readUint16();i.push({key:f,isStringProperty:(a&1)!=0,guidIndex:a>>1&32767,propertyIndex:l})}return i}return Pt}var Nr={},Yo;function L0(){if(Yo)return Nr;Yo=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.parse=s;function s(t){for(var r=[],e=0;!t.isEof();){var n=t.readUint16();if(n===258){e=t.readUint16(),t.readUint16();for(var i=0;i<e;i+=1){var f=t.readInt32(),a=t.readUint8(),l=t.readString(a),c=t.readUint8();t.readString(c);var o=t.readUint8();t.readString(o);var d=t.readUint8();t.readString(d),t.readInt32(),t.readUint8(),t.readInt32(),t.readInt32(),t.readInt32(),t.readInt32(),t.readInt32(),t.readInt32(),r.push({VerbType:f,DisplayName:l})}}else if(n===260)for(var i=0;i<e;i+=1){var a=t.readUint8(),l=t.readUCS2String(a),d=t.readUint8();t.readUCS2String(d),r[i].DisplayName=l}}return r.filter(function(u){return u.VerbType===4}).map(function(u){return u.DisplayName}).join(";")}return Nr}var Pr={},Ko;function O0(){if(Ko)return Pr;Ko=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.parse=e;var s=xr(),t=1,r=2;function e(n){var i={rules:[]};if(!n.isEof()){var f=n.readUint8();if(f!==2)throw new Error("TZDEFINITION major version not supported");if(n.readUint8(),f<1)throw new Error("TZDEFINITION minor version not supported");var a=n.readUint16(),l=n.readUint16();if(l&t&&(n.readInt32(),n.readInt32(),n.readInt32(),n.readInt32()),l&r){var c=n.readUint16();i.keyName=n.readUCS2String(c)}var o=n.readUint16();n.seek(4+a);for(var d=0;d<o;d++){var u=n.readUint8();if(u!==2||(n.readUint8(),u<1))break;var h=n.readUint16(),v=n.position,w=n.readUint16(),A=(0,s.readSystemTime)(n),_=n.readInt32(),E=n.readInt32(),x=n.readInt32(),g=(0,s.readTransitionSystemTime)(n),S=(0,s.readTransitionSystemTime)(n),B=Object.assign({},{flags:w,start:A?.toUTCString()||null,bias:_,standardBias:E,daylightBias:x,standardDate:g,daylightDate:S});i.rules.push(B),n.seek(v+h)}}return i}return Pr}var Ur={},Zo;function N0(){if(Zo)return Ur;Zo=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.parse=t;var s=xr();function t(r){if(!r.isEof()){var e=r.readInt32(),n=r.readInt32(),i=r.readInt32(),f=r.readUint16(),a=(0,s.readTransitionSystemTime)(r),l=r.readUint16(),c=(0,s.readTransitionSystemTime)(r);return Object.assign({},{bias:e,standardBias:n,daylightBias:i,standardYear:f,standardDate:a,daylightYear:l,daylightDate:c})}return null}return Ur}var nt={},Xo;function Jo(){if(Xo)return nt;Xo=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.OverrideFlags=nt.EndType=nt.CalendarType=nt.PatternType=nt.RecurFrequency=void 0,nt.parse=f;var s;(function(a){a[a.Daily=8202]="Daily",a[a.Weekly=8203]="Weekly",a[a.Monthly=8204]="Monthly",a[a.Yearly=8205]="Yearly"})(s||(nt.RecurFrequency=s={}));var t;(function(a){a[a.Day=0]="Day",a[a.Week=1]="Week",a[a.Month=2]="Month",a[a.MonthEnd=4]="MonthEnd",a[a.MonthNth=3]="MonthNth",a[a.HjMonth=10]="HjMonth",a[a.HjMonthNth=11]="HjMonthNth",a[a.HjMonthEnd=12]="HjMonthEnd"})(t||(nt.PatternType=t={}));var r;(function(a){a[a.Default=0]="Default",a[a.CAL_GREGORIAN=1]="CAL_GREGORIAN",a[a.CAL_GREGORIAN_US=2]="CAL_GREGORIAN_US",a[a.CAL_JAPAN=3]="CAL_JAPAN",a[a.CAL_TAIWAN=4]="CAL_TAIWAN",a[a.CAL_KOREA=5]="CAL_KOREA",a[a.CAL_HIJRI=6]="CAL_HIJRI",a[a.CAL_THAI=7]="CAL_THAI",a[a.CAL_HEBREW=8]="CAL_HEBREW",a[a.CAL_GREGORIAN_ME_FRENCH=9]="CAL_GREGORIAN_ME_FRENCH",a[a.CAL_GREGORIAN_ARABIC=10]="CAL_GREGORIAN_ARABIC",a[a.CAL_GREGORIAN_XLIT_ENGLISH=11]="CAL_GREGORIAN_XLIT_ENGLISH",a[a.CAL_GREGORIAN_XLIT_FRENCH=12]="CAL_GREGORIAN_XLIT_FRENCH",a[a.CAL_LUNAR_JAPANESE=14]="CAL_LUNAR_JAPANESE",a[a.CAL_CHINESE_LUNAR=15]="CAL_CHINESE_LUNAR",a[a.CAL_SAKA=16]="CAL_SAKA",a[a.CAL_LUNAR_ETO_CHN=17]="CAL_LUNAR_ETO_CHN",a[a.CAL_LUNAR_ETO_KOR=18]="CAL_LUNAR_ETO_KOR",a[a.CAL_LUNAR_ROKUYOU=19]="CAL_LUNAR_ROKUYOU",a[a.CAL_LUNAR_KOREAN=20]="CAL_LUNAR_KOREAN",a[a.CAL_UMALQURA=23]="CAL_UMALQURA"})(r||(nt.CalendarType=r={}));var e;(function(a){a[a.EndAfterDate=8225]="EndAfterDate",a[a.EndAfterNOccurrences=8226]="EndAfterNOccurrences",a[a.NeverEnd=8227]="NeverEnd",a[a.NeverEnd2=4294967295]="NeverEnd2"})(e||(nt.EndType=e={}));var n;(function(a){a[a.ARO_SUBJECT=1]="ARO_SUBJECT",a[a.ARO_MEETINGTYPE=2]="ARO_MEETINGTYPE",a[a.ARO_REMINDERDELTA=4]="ARO_REMINDERDELTA",a[a.ARO_REMINDER=8]="ARO_REMINDER",a[a.ARO_LOCATION=16]="ARO_LOCATION",a[a.ARO_BUSYSTATUS=32]="ARO_BUSYSTATUS",a[a.ARO_ATTACHMENT=64]="ARO_ATTACHMENT",a[a.ARO_SUBTYPE=128]="ARO_SUBTYPE",a[a.ARO_APPTCOLOR=256]="ARO_APPTCOLOR",a[a.ARO_EXCEPTIONAL_BODY=512]="ARO_EXCEPTIONAL_BODY"})(n||(nt.OverrideFlags=n={}));function i(a){var l=a.readUint16();if(l!==12292)throw new Error("ReaderVersion not supported");var c=a.readUint16();if(c!==12292)throw new Error("WriterVersion not supported");var o=a.readUint16(),d=a.readUint16(),u=a.readUint16(),h=a.readUint32(),v=a.readUint32(),w=a.readUint32(),A=void 0,_=void 0,E=void 0;d===t.Week?A={dayOfWeekBits:a.readUint32()}:d===t.Month||d===t.MonthEnd||d===t.HjMonth||d===t.HjMonthEnd?_={day:a.readUint32()}:(d===t.MonthNth||d===t.HjMonthNth)&&(E={dayOfWeekBits:a.readUint32(),n:a.readUint32()});var x=a.readUint32(),g=a.readUint32(),S=a.readUint32(),B=a.readUint32(),k=Array.from(a.readUint32Array(B)),D=a.readUint32(),$=Array.from(a.readUint32Array(D)),j=a.readUint32(),Q=a.readUint32();return Object.assign({recurFrequency:o,patternType:d,calendarType:u,firstDateTime:h,period:v,slidingFlag:w,endType:x,occurrenceCount:g,firstDOW:S,deletedInstanceDates:k,modifiedInstanceDates:$,startDate:j,endDate:Q},A?{patternTypeWeek:A}:{},_?{patternTypeMonth:_}:{},E?{patternTypeMonthNth:E}:{})}function f(a,l){var c=i(a),o=a.readUint32();if(o!==12294)throw new Error("ReaderVersion2 not supported");var d=a.readUint32();if(d<12294)throw new Error("WriterVersion2 not supported");for(var u=a.readUint32(),h=a.readUint32(),v=a.readUint16(),w=[],A=0;A<v;A++){var _=a.readUint32(),E=a.readUint32(),x=a.readUint32(),g=a.readUint16(),S=void 0;if(g&n.ARO_SUBJECT){var B=a.readUint16(),k=a.readUint16();if(B-1!==k)throw new Error("subjectLength ".concat(B," and subjectLength2 ").concat(k," are not close!"));S=a.readString(k,l)}var D=void 0;g&n.ARO_MEETINGTYPE&&(D=a.readUint32());var $=void 0;g&n.ARO_REMINDERDELTA&&($=a.readUint32());var j=void 0;g&n.ARO_REMINDER&&(j=a.readUint32());var Q=void 0;if(g&n.ARO_LOCATION){var L=a.readUint16(),ie=a.readUint16();if(L-1!==ie)throw new Error("locationLength ".concat(L," and locationLength2 ").concat(ie," are not close!"));Q=a.readString(ie,l)}var ue=void 0;g&n.ARO_BUSYSTATUS&&(ue=a.readUint32());var fe=void 0;g&n.ARO_ATTACHMENT&&(fe=a.readUint32());var he=void 0;g&n.ARO_SUBTYPE&&(he=a.readUint32());var ve=void 0;g&n.ARO_APPTCOLOR&&(ve=a.readUint32()),w.push(Object.assign({startDateTime:_,endDateTime:E,originalStartTime:x,overrideFlags:g},S?{subject:S}:{},D?{meetingType:D}:{},$?{reminderDelta:$}:{},j?{reminderSet:j}:{},Q?{location:Q}:{},ue?{busyStatus:ue}:{},fe?{attachment:fe}:{},he?{subType:he}:{},ve?{appointmentColor:ve}:{}))}var oe=a.readUint32();if(oe!==0)throw new Error("reservedBlock1Size ".concat(oe," is not zero, AppointmentRecur is broken"));for(var A=0;A<v;A++){var be=w[A];if(12297<=d){var ce=a.readUint32();be.changeHighlight=a.readUint32(),a.position+=ce-4}var pe=a.readUint32();if(pe!==0)throw new Error("reservedBlockEE1Size ".concat(pe," is not zero, AppointmentRecur is broken"));if(be.overrideFlags&(n.ARO_SUBJECT|n.ARO_LOCATION)){var _=a.readUint32(),E=a.readUint32();if(a.readUint32(),be.overrideFlags&n.ARO_SUBJECT){var _e=a.readUint16();be.subject=a.readUCS2String(_e)}if(be.overrideFlags&n.ARO_LOCATION){var q=a.readUint16();be.location=a.readUCS2String(q)}var z=a.readUint32();if(z!==0)throw new Error("reservedBlockEE2Size ".concat(z," is not zero, AppointmentRecur is broken"))}}var W=a.readUint32();if(W!==0)throw new Error("reservedBlock2Size ".concat(W," is not zero, AppointmentRecur is broken"));return{recurrencePattern:c,startTimeOffset:u,endTimeOffset:h,exceptionInfo:w}}return nt}var Qo;function ec(){return Qo||(Qo=1,(function(s){var t=Qt&&Qt.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(s,"__esModule",{value:!0}),s.OverrideFlags=s.EndType=s.CalendarType=s.PatternType=s.RecurFrequency=void 0;var r=t(xa()),e=t(en()),n=dl(),i=k0(),f=xr(),a=D0(),l=L0(),c=O0(),o=N0(),d=Jo(),u=Jo();Object.defineProperty(s,"RecurFrequency",{enumerable:!0,get:function(){return u.RecurFrequency}}),Object.defineProperty(s,"PatternType",{enumerable:!0,get:function(){return u.PatternType}}),Object.defineProperty(s,"CalendarType",{enumerable:!0,get:function(){return u.CalendarType}}),Object.defineProperty(s,"EndType",{enumerable:!0,get:function(){return u.EndType}}),Object.defineProperty(s,"OverrideFlags",{enumerable:!0,get:function(){return u.OverrideFlags}});var h;(function(E){E[E.DIRECTORY=1]="DIRECTORY",E[E.DOCUMENT=2]="DOCUMENT",E[E.ROOT=5]="ROOT"})(h||(h={}));var v;(function(E){E[E.root=0]="root",E[E.toSub=1]="toSub",E[E.named=2]="named"})(v||(v={}));function w(E){return(E-116444736e9)/1e4}function A(E){var x=E.indexOf("\0");return x!==-1?E.substring(0,x):E}var _=(function(){function E(x){this.reader=new n.Reader(x)}return E.prototype.decodeField=function(x,g,S,B,k){var D=S(),$=new e.default(D,0,e.default.LITTLE_ENDIAN),j=r.default.MSG.FIELD.FULL_NAME_MAPPING["".concat(x).concat(g)]||r.default.MSG.FIELD.NAME_MAPPING[x],Q=v.root,L=void 0,ie=void 0,ue=parseInt("0x".concat(x));if(ue>=32768){var fe=this.privatePidToKeyed[ue];if(fe)if(fe.useName)j=fe.name,Q=v.named;else{L=fe.propertySet,ie=(0,f.toHex4)(fe.propertyLid);var he=r.default.MSG.FIELD.PIDLID_MAPPING[fe.propertySet];if(he!==void 0){var ve=he[fe.propertyLid];ve!==void 0&&(ve.dispid!==void 0?(j=ve.dispid,Q=v.root):(j=ve.id,Q=v.toSub))}}}var oe=D,be=!1,ce=r.default.MSG.FIELD.TYPE_MAPPING[g];if(ce==="string")oe=A($.readString(D.length,B)),be=k;else if(ce==="unicode")oe=A($.readUCS2String(D.length/2)),be=k;else if(ce==="binary")be=k;else if(ce==="integer")oe=$.readUint32();else if(ce==="boolean")oe=!!$.readUint16();else if(ce==="time"){var pe=$.readUint32(),_e=pe+4294967296*$.readUint32();oe=new Date(w(_e)).toUTCString()}if(be&&(j=void 0),j==="PidLidVerbStream")j="votingOptions",Q=v.root,oe=(0,l.parse)($);else if(j==="apptTZDefStartDisplay"||j==="apptTZDefEndDisplay"||j==="apptTZDefRecur")Q=v.root,oe=(0,c.parse)($);else if(j==="timeZoneStruct")oe=(0,o.parse)($);else if(j==="apptRecur")try{oe=(0,d.parse)($,B)}catch(U){console.debug(U),j=void 0}else if(j==="recipType"){var q=1,z=2,W=3;oe===q?oe="to":oe===z?oe="cc":oe===W&&(oe="bcc")}else j==="globalAppointmentID"&&(oe=(0,f.bin2HexUpper)($));var N="".concat(x).concat(g);return{key:j,keyType:Q,value:oe,notForRawProp:be,propertyTag:N,propertySet:L,propertyLid:ie}},E.prototype.fieldsDataDocument=function(x,g,S){var B=g.name.substring(12).toLowerCase(),k=B.substring(0,4),D=B.substring(4,8);x.propertyObserver&&x.propertyObserver(S,parseInt(B.substring(0,8),16),g.provider()),k==r.default.MSG.FIELD.CLASS_MAPPING.ATTACHMENT_DATA?(S.dataId=g.dataId,S.contentLength=g.length):this.setDecodedFieldTo(x,S,this.decodeField(k,D,g.provider,x.ansiEncoding,!1))},E.prototype.setDecodedFieldTo=function(x,g,S){var B=S.key,k=S.keyType,D=S.value;B!==void 0&&k===v.root&&(g[B]=D),x.includeRawProps===!0&&(g.rawProps=g.rawProps||[],S.notForRawProp||g.rawProps.push({propertyTag:S.propertyTag,propertySet:S.propertySet,propertyLid:S.propertyLid,propertyName:S.keyType===v.named?S.key:void 0,value:D}))},E.prototype.getFieldType=function(x){var g=x.name.substring(12).toLowerCase();return g.substring(4,8)},E.prototype.fieldsDataDirInner=function(x,g,S,B){var k=this;if(g.name.indexOf(r.default.MSG.FIELD.PREFIX.ATTACHMENT)==0){var D={dataType:"attachment"};B.attachments.push(D),this.fieldsDataDir(x,g,S,D,"attachment")}else if(g.name.indexOf(r.default.MSG.FIELD.PREFIX.RECIPIENT)==0){var $={dataType:"recipient"};B.recipients.push($),this.fieldsDataDir(x,g,S,$,"recip")}else if(g.name.indexOf(r.default.MSG.FIELD.PREFIX.NAMEID)==0)this.fieldsNameIdDir(x,g,S,B);else{var j=this.getFieldType(g);if(j==r.default.MSG.FIELD.DIR_TYPE.INNER_MSG){var Q={dataType:"msg",attachments:[],recipients:[]};this.fieldsDataDir(x,g,S,Q,"sub"),B.innerMsgContentFields=Q,B.innerMsgContent=!0,B.folderId=g.dataId,this.innerMsgBurners[g.dataId]=function(){return k.burnMsg(g,S)}}}},E.prototype.burnMsg=function(x,g){var S=[{name:"Root Entry",type:h.ROOT,children:[],length:0}];return this.registerFolder(S,0,x,g,0),(0,i.burn)(S)},E.prototype.registerFolder=function(x,g,S,B,k){for(var D=function(ce){var pe=ce.provider,_e=ce.length;if(k===0&&ce.name==="__properties_version1.0"){var q=pe(),z=new Uint8Array(q.length+8);z.set(q.subarray(0,24),0),z.set(q.subarray(24),32),pe=function(){return z},_e=z.length}var W=x.length;x[g].children.push(W),x.push({name:ce.name,type:h.DOCUMENT,binaryProvider:pe,length:_e})},$=0,j=S.fileNameSets();$<j.length;$++){var Q=j[$];D(Q)}if(k===0)for(var L=B.subFolders().filter(function(ce){return ce.name===r.default.MSG.FIELD.PREFIX.NAMEID}),ie=0,ue=L;ie<ue.length;ie++){var fe=ue[ie],he=x.length;x[g].children.push(he),x.push({name:fe.name,type:h.DIRECTORY,children:[],length:0}),this.registerFolder(x,he,fe,B,k+1)}for(var ve=0,oe=S.subFolders();ve<oe.length;ve++){var be=oe[ve],he=x.length;x[g].children.push(he),x.push({name:be.name,type:h.DIRECTORY,children:[],length:0}),this.registerFolder(x,he,be,B,k+1)}},E.prototype.fieldsRecipAndAttachmentProperties=function(x,g,S){var B=g.provider(),k=new e.default(B,8,e.default.LITTLE_ENDIAN);this.importPropertiesFromFile(x,k,S)},E.prototype.importPropertiesFromFile=function(x,g,S){for(var B=function(){var $=g.readUint32();if($===0)return"break";g.readUint32();var j=g.readUint8Array(8);x.propertyObserver(S,$,j);var Q=(0,f.toHex2)($/65536&65535),L=(0,f.toHex2)($&65535);k.setDecodedFieldTo(x,S,k.decodeField(Q,L,function(){return j},x.ansiEncoding,!0))},k=this;!g.isEof();){var D=B();if(D==="break")break}},E.prototype.fieldsRootProperties=function(x,g,S){var B=g.provider(),k=new e.default(B,32,e.default.LITTLE_ENDIAN);this.importPropertiesFromFile(x,k,S)},E.prototype.fieldsDataDir=function(x,g,S,B,k){for(var D=0,$=g.subFolders();D<$.length;D++){var j=$[D];this.fieldsDataDirInner(x,j,S,B)}for(var Q=0,L=g.fileNameSets();Q<L.length;Q++){var ie=L[Q];ie.name.indexOf(r.default.MSG.FIELD.PREFIX.DOCUMENT)==0?this.fieldsDataDocument(x,ie,B):ie.name==="__properties_version1.0"&&(k==="recip"||k==="attachment"||k==="sub"?this.fieldsRecipAndAttachmentProperties(x,ie,B):k==="root"&&this.fieldsRootProperties(x,ie,B))}},E.prototype.fieldsNameIdDir=function(x,g,S,B){for(var k=void 0,D=void 0,$=void 0,j=0,Q=g.fileNameSets();j<Q.length;j++){var L=Q[j];if(L.name.indexOf(r.default.MSG.FIELD.PREFIX.DOCUMENT)==0){var ie=L.name.substring(12).toLowerCase(),ue=ie.substring(0,4),fe=ie.substring(4,8);ue==="0002"&&fe==="0102"?k=L.provider():ue==="0003"&&fe==="0102"?$=L.provider():ue==="0004"&&fe==="0102"&&(D=L.provider())}}if(k!==void 0&&D!==void 0&&$!==void 0)for(var he=(0,a.parse)($),ve=new e.default(D,0,e.default.LITTLE_ENDIAN),oe=0,be=he;oe<be.length;oe++){var ce=be[oe];if(ce.isStringProperty){ve.seek(ce.key);var pe=ve.readUint32();this.privatePidToKeyed[32768|ce.propertyIndex]={useName:!0,name:ve.readUCS2String(pe/2)}}else this.privatePidToKeyed[32768|ce.propertyIndex]={useName:!1,propertySet:ce.guidIndex===1?"00020328-00000-0000-C000-00000000046":ce.guidIndex===2?"00020329-00000-0000-C000-00000000046":(0,f.msftUuidStringify)(k,16*(ce.guidIndex-3)),propertyLid:ce.key}}},E.prototype.fieldsDataReader=function(x){var g={dataType:"msg",attachments:[],recipients:[]};return this.fieldsDataDir(x,this.reader.rootFolder(),this.reader.rootFolder(),g,"root"),g},E.prototype.parseMsgData=function(x){return this.reader.parse(),this.fieldsDataReader(x)},E.prototype.getFileData=function(){var x,g,S;if(this.fieldsData===void 0){if(!this.reader.isMSGFile())return{dataType:null,error:"Unsupported file type!"};this.innerMsgBurners={},this.privatePidToKeyed={},this.fieldsData=this.parseMsgData({propertyObserver:((x=this.parserConfig)===null||x===void 0?void 0:x.propertyObserver)||(function(){}),includeRawProps:!!(!((g=this.parserConfig)===null||g===void 0)&&g.includeRawProps),ansiEncoding:(0,f.emptyToNull)((S=this.parserConfig)===null||S===void 0?void 0:S.ansiEncoding)})}return this.fieldsData},E.prototype.getAttachment=function(x){var g=typeof x=="number"?this.fieldsData.attachments[x]:x;if(g.innerMsgContent===!0&&typeof g.folderId=="number")return{fileName:g.name+".msg",content:this.innerMsgBurners[g.folderId]()};var S=this.reader.readFileOf(g.dataId);return{fileName:g.fileName,content:S}},E})();s.default=_})(Qt)),Qt}var tc;function P0(){return tc||(tc=1,(function(s){var t=vt&&vt.__createBinding||(Object.create?(function(i,f,a,l){l===void 0&&(l=a);var c=Object.getOwnPropertyDescriptor(f,a);(!c||("get"in c?!f.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return f[a]}}),Object.defineProperty(i,l,c)}):(function(i,f,a,l){l===void 0&&(l=a),i[l]=f[a]})),r=vt&&vt.__exportStar||function(i,f){for(var a in i)a!=="default"&&!Object.prototype.hasOwnProperty.call(f,a)&&t(f,i,a)},e=vt&&vt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(s,"__esModule",{value:!0});var n=e(ec());r(ec(),s),s.default=n.default})(vt)),vt}var U0=P0();const tr=va(U0);var rr={},rc;function H0(){if(rc)return rr;rc=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.decompressRTF=void 0;var s=(function(){function r(e){this.buf=e}return r.prototype.readInt32LE=function(e){var n=this.buf[e]&255|(this.buf[e+1]&255)<<8|(this.buf[e+2]&255)<<16|(this.buf[e+3]&255)<<24;return n},r.prototype.readUInt16BE=function(e){var n=(this.buf[e]&255)<<8|this.buf[e+1]&255;return n},r.prototype.readUInt8=function(e){var n=this.buf[e]&255;return n},r.prototype.writeUInt8=function(e,n){this.buf[n]=e&255},r})();function t(r){if(r.length<16)throw new Error("At least 16 bytes");var e=new s(r),n=e.readInt32LE(0),i=e.readInt32LE(4),f=e.readInt32LE(8);e.readInt32LE(12);var a=1967544908,l=1095517517;if(f==a){for(var c=`{\\rtf1\\ansi\\mac\\deff0\\deftab720{\\fonttbl;}{\\f0\\fnil \\froman \\fswiss \\fmodern \\fscript \\fdecor MS Sans SerifSymbolArialTimes New RomanCourier{\\colortbl\\red0\\green0\\blue0\r
\\par \\pard\\plain\\f0\\fs20\\b\\i\\u\\tab\\tx`,o=[],d=new s(o),u=0,h=16,v=void 0,w=0;w<c.length;w+=1)d.writeUInt8(c.charCodeAt(w),u),u+=1;for(var A=n+4,_=0;h<A;_=_+1&7)if(_==0&&(v=e.readUInt8(h),h+=1),(1<<_&v)!=0){var E=e.readUInt16BE(h);h+=2;var x=E>>4,g=(E&15)+2,S=(u&-4096)+x;if(S==u)break;S>u&&(S-=4096);for(var w=0;w<g;w+=1){var B=d.readUInt8(S);d.writeUInt8(B,u),S+=1,u+=1}}else{var B=e.readUInt8(h);d.writeUInt8(B,u),h+=1,u+=1}return o.slice(c.length)}else{if(f==l)return r.slice(16,16+i);throw new Error("Either COMPRESSED or UNCOMPRESSED")}}return rr.decompressRTF=t,rr}var j0=H0(),Ba={},tn={};tn.byteLength=G0;tn.toByteArray=z0;tn.fromByteArray=K0;var mt=[],st=[],q0=typeof Uint8Array<"u"?Uint8Array:Array,Vi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Ut=0,$0=Vi.length;Ut<$0;++Ut)mt[Ut]=Vi[Ut],st[Vi.charCodeAt(Ut)]=Ut;st[45]=62;st[95]=63;function hl(s){var t=s.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=s.indexOf("=");r===-1&&(r=t);var e=r===t?0:4-r%4;return[r,e]}function G0(s){var t=hl(s),r=t[0],e=t[1];return(r+e)*3/4-e}function W0(s,t,r){return(t+r)*3/4-r}function z0(s){var t,r=hl(s),e=r[0],n=r[1],i=new q0(W0(s,e,n)),f=0,a=n>0?e-4:e,l;for(l=0;l<a;l+=4)t=st[s.charCodeAt(l)]<<18|st[s.charCodeAt(l+1)]<<12|st[s.charCodeAt(l+2)]<<6|st[s.charCodeAt(l+3)],i[f++]=t>>16&255,i[f++]=t>>8&255,i[f++]=t&255;return n===2&&(t=st[s.charCodeAt(l)]<<2|st[s.charCodeAt(l+1)]>>4,i[f++]=t&255),n===1&&(t=st[s.charCodeAt(l)]<<10|st[s.charCodeAt(l+1)]<<4|st[s.charCodeAt(l+2)]>>2,i[f++]=t>>8&255,i[f++]=t&255),i}function V0(s){return mt[s>>18&63]+mt[s>>12&63]+mt[s>>6&63]+mt[s&63]}function Y0(s,t,r){for(var e,n=[],i=t;i<r;i+=3)e=(s[i]<<16&16711680)+(s[i+1]<<8&65280)+(s[i+2]&255),n.push(V0(e));return n.join("")}function K0(s){for(var t,r=s.length,e=r%3,n=[],i=16383,f=0,a=r-e;f<a;f+=i)n.push(Y0(s,f,f+i>a?a:f+i));return e===1?(t=s[r-1],n.push(mt[t>>2]+mt[t<<4&63]+"==")):e===2&&(t=(s[r-2]<<8)+s[r-1],n.push(mt[t>>10]+mt[t>>4&63]+mt[t<<2&63]+"=")),n.join("")}var Ia={};Ia.read=function(s,t,r,e,n){var i,f,a=n*8-e-1,l=(1<<a)-1,c=l>>1,o=-7,d=r?n-1:0,u=r?-1:1,h=s[t+d];for(d+=u,i=h&(1<<-o)-1,h>>=-o,o+=a;o>0;i=i*256+s[t+d],d+=u,o-=8);for(f=i&(1<<-o)-1,i>>=-o,o+=e;o>0;f=f*256+s[t+d],d+=u,o-=8);if(i===0)i=1-c;else{if(i===l)return f?NaN:(h?-1:1)*(1/0);f=f+Math.pow(2,e),i=i-c}return(h?-1:1)*f*Math.pow(2,i-e)};Ia.write=function(s,t,r,e,n,i){var f,a,l,c=i*8-n-1,o=(1<<c)-1,d=o>>1,u=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=e?0:i-1,v=e?1:-1,w=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,f=o):(f=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-f))<1&&(f--,l*=2),f+d>=1?t+=u/l:t+=u*Math.pow(2,1-d),t*l>=2&&(f++,l/=2),f+d>=o?(a=0,f=o):f+d>=1?(a=(t*l-1)*Math.pow(2,n),f=f+d):(a=t*Math.pow(2,d-1)*Math.pow(2,n),f=0));n>=8;s[r+h]=a&255,h+=v,a/=256,n-=8);for(f=f<<n|a,c+=n;c>0;s[r+h]=f&255,h+=v,f/=256,c-=8);s[r+h-v]|=w*128};(function(s){const t=tn,r=Ia,e=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;s.Buffer=o,s.SlowBuffer=S,s.INSPECT_MAX_BYTES=50;const n=2147483647;s.kMaxLength=n;const{Uint8Array:i,ArrayBuffer:f,SharedArrayBuffer:a}=globalThis;o.TYPED_ARRAY_SUPPORT=l(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const T=new i(1),p={foo:function(){return 42}};return Object.setPrototypeOf(p,i.prototype),Object.setPrototypeOf(T,p),T.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function c(T){if(T>n)throw new RangeError('The value "'+T+'" is invalid for option "size"');const p=new i(T);return Object.setPrototypeOf(p,o.prototype),p}function o(T,p,b){if(typeof T=="number"){if(typeof p=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(T)}return d(T,p,b)}o.poolSize=8192;function d(T,p,b){if(typeof T=="string")return w(T,p);if(f.isView(T))return _(T);if(T==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T);if(Oe(T,f)||T&&Oe(T.buffer,f)||typeof a<"u"&&(Oe(T,a)||T&&Oe(T.buffer,a)))return E(T,p,b);if(typeof T=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const C=T.valueOf&&T.valueOf();if(C!=null&&C!==T)return o.from(C,p,b);const P=x(T);if(P)return P;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof T[Symbol.toPrimitive]=="function")return o.from(T[Symbol.toPrimitive]("string"),p,b);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T)}o.from=function(T,p,b){return d(T,p,b)},Object.setPrototypeOf(o.prototype,i.prototype),Object.setPrototypeOf(o,i);function u(T){if(typeof T!="number")throw new TypeError('"size" argument must be of type number');if(T<0)throw new RangeError('The value "'+T+'" is invalid for option "size"')}function h(T,p,b){return u(T),T<=0?c(T):p!==void 0?typeof b=="string"?c(T).fill(p,b):c(T).fill(p):c(T)}o.alloc=function(T,p,b){return h(T,p,b)};function v(T){return u(T),c(T<0?0:g(T)|0)}o.allocUnsafe=function(T){return v(T)},o.allocUnsafeSlow=function(T){return v(T)};function w(T,p){if((typeof p!="string"||p==="")&&(p="utf8"),!o.isEncoding(p))throw new TypeError("Unknown encoding: "+p);const b=B(T,p)|0;let C=c(b);const P=C.write(T,p);return P!==b&&(C=C.slice(0,P)),C}function A(T){const p=T.length<0?0:g(T.length)|0,b=c(p);for(let C=0;C<p;C+=1)b[C]=T[C]&255;return b}function _(T){if(Oe(T,i)){const p=new i(T);return E(p.buffer,p.byteOffset,p.byteLength)}return A(T)}function E(T,p,b){if(p<0||T.byteLength<p)throw new RangeError('"offset" is outside of buffer bounds');if(T.byteLength<p+(b||0))throw new RangeError('"length" is outside of buffer bounds');let C;return p===void 0&&b===void 0?C=new i(T):b===void 0?C=new i(T,p):C=new i(T,p,b),Object.setPrototypeOf(C,o.prototype),C}function x(T){if(o.isBuffer(T)){const p=g(T.length)|0,b=c(p);return b.length===0||T.copy(b,0,0,p),b}if(T.length!==void 0)return typeof T.length!="number"||We(T.length)?c(0):A(T);if(T.type==="Buffer"&&Array.isArray(T.data))return A(T.data)}function g(T){if(T>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return T|0}function S(T){return+T!=T&&(T=0),o.alloc(+T)}o.isBuffer=function(p){return p!=null&&p._isBuffer===!0&&p!==o.prototype},o.compare=function(p,b){if(Oe(p,i)&&(p=o.from(p,p.offset,p.byteLength)),Oe(b,i)&&(b=o.from(b,b.offset,b.byteLength)),!o.isBuffer(p)||!o.isBuffer(b))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(p===b)return 0;let C=p.length,P=b.length;for(let G=0,J=Math.min(C,P);G<J;++G)if(p[G]!==b[G]){C=p[G],P=b[G];break}return C<P?-1:P<C?1:0},o.isEncoding=function(p){switch(String(p).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(p,b){if(!Array.isArray(p))throw new TypeError('"list" argument must be an Array of Buffers');if(p.length===0)return o.alloc(0);let C;if(b===void 0)for(b=0,C=0;C<p.length;++C)b+=p[C].length;const P=o.allocUnsafe(b);let G=0;for(C=0;C<p.length;++C){let J=p[C];if(Oe(J,i))G+J.length>P.length?(o.isBuffer(J)||(J=o.from(J)),J.copy(P,G)):i.prototype.set.call(P,J,G);else if(o.isBuffer(J))J.copy(P,G);else throw new TypeError('"list" argument must be an Array of Buffers');G+=J.length}return P};function B(T,p){if(o.isBuffer(T))return T.length;if(f.isView(T)||Oe(T,f))return T.byteLength;if(typeof T!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof T);const b=T.length,C=arguments.length>2&&arguments[2]===!0;if(!C&&b===0)return 0;let P=!1;for(;;)switch(p){case"ascii":case"latin1":case"binary":return b;case"utf8":case"utf-8":return He(T).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b*2;case"hex":return b>>>1;case"base64":return Be(T).length;default:if(P)return C?-1:He(T).length;p=(""+p).toLowerCase(),P=!0}}o.byteLength=B;function k(T,p,b){let C=!1;if((p===void 0||p<0)&&(p=0),p>this.length||((b===void 0||b>this.length)&&(b=this.length),b<=0)||(b>>>=0,p>>>=0,b<=p))return"";for(T||(T="utf8");;)switch(T){case"hex":return _e(this,p,b);case"utf8":case"utf-8":return ve(this,p,b);case"ascii":return ce(this,p,b);case"latin1":case"binary":return pe(this,p,b);case"base64":return he(this,p,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,p,b);default:if(C)throw new TypeError("Unknown encoding: "+T);T=(T+"").toLowerCase(),C=!0}}o.prototype._isBuffer=!0;function D(T,p,b){const C=T[p];T[p]=T[b],T[b]=C}o.prototype.swap16=function(){const p=this.length;if(p%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let b=0;b<p;b+=2)D(this,b,b+1);return this},o.prototype.swap32=function(){const p=this.length;if(p%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let b=0;b<p;b+=4)D(this,b,b+3),D(this,b+1,b+2);return this},o.prototype.swap64=function(){const p=this.length;if(p%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let b=0;b<p;b+=8)D(this,b,b+7),D(this,b+1,b+6),D(this,b+2,b+5),D(this,b+3,b+4);return this},o.prototype.toString=function(){const p=this.length;return p===0?"":arguments.length===0?ve(this,0,p):k.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(p){if(!o.isBuffer(p))throw new TypeError("Argument must be a Buffer");return this===p?!0:o.compare(this,p)===0},o.prototype.inspect=function(){let p="";const b=s.INSPECT_MAX_BYTES;return p=this.toString("hex",0,b).replace(/(.{2})/g,"$1 ").trim(),this.length>b&&(p+=" ... "),"<Buffer "+p+">"},e&&(o.prototype[e]=o.prototype.inspect),o.prototype.compare=function(p,b,C,P,G){if(Oe(p,i)&&(p=o.from(p,p.offset,p.byteLength)),!o.isBuffer(p))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof p);if(b===void 0&&(b=0),C===void 0&&(C=p?p.length:0),P===void 0&&(P=0),G===void 0&&(G=this.length),b<0||C>p.length||P<0||G>this.length)throw new RangeError("out of range index");if(P>=G&&b>=C)return 0;if(P>=G)return-1;if(b>=C)return 1;if(b>>>=0,C>>>=0,P>>>=0,G>>>=0,this===p)return 0;let J=G-P,ye=C-b;const Se=Math.min(J,ye),Ie=this.slice(P,G),Fe=p.slice(b,C);for(let Ee=0;Ee<Se;++Ee)if(Ie[Ee]!==Fe[Ee]){J=Ie[Ee],ye=Fe[Ee];break}return J<ye?-1:ye<J?1:0};function $(T,p,b,C,P){if(T.length===0)return-1;if(typeof b=="string"?(C=b,b=0):b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),b=+b,We(b)&&(b=P?0:T.length-1),b<0&&(b=T.length+b),b>=T.length){if(P)return-1;b=T.length-1}else if(b<0)if(P)b=0;else return-1;if(typeof p=="string"&&(p=o.from(p,C)),o.isBuffer(p))return p.length===0?-1:j(T,p,b,C,P);if(typeof p=="number")return p=p&255,typeof i.prototype.indexOf=="function"?P?i.prototype.indexOf.call(T,p,b):i.prototype.lastIndexOf.call(T,p,b):j(T,[p],b,C,P);throw new TypeError("val must be string, number or Buffer")}function j(T,p,b,C,P){let G=1,J=T.length,ye=p.length;if(C!==void 0&&(C=String(C).toLowerCase(),C==="ucs2"||C==="ucs-2"||C==="utf16le"||C==="utf-16le")){if(T.length<2||p.length<2)return-1;G=2,J/=2,ye/=2,b/=2}function Se(Fe,Ee){return G===1?Fe[Ee]:Fe.readUInt16BE(Ee*G)}let Ie;if(P){let Fe=-1;for(Ie=b;Ie<J;Ie++)if(Se(T,Ie)===Se(p,Fe===-1?0:Ie-Fe)){if(Fe===-1&&(Fe=Ie),Ie-Fe+1===ye)return Fe*G}else Fe!==-1&&(Ie-=Ie-Fe),Fe=-1}else for(b+ye>J&&(b=J-ye),Ie=b;Ie>=0;Ie--){let Fe=!0;for(let Ee=0;Ee<ye;Ee++)if(Se(T,Ie+Ee)!==Se(p,Ee)){Fe=!1;break}if(Fe)return Ie}return-1}o.prototype.includes=function(p,b,C){return this.indexOf(p,b,C)!==-1},o.prototype.indexOf=function(p,b,C){return $(this,p,b,C,!0)},o.prototype.lastIndexOf=function(p,b,C){return $(this,p,b,C,!1)};function Q(T,p,b,C){b=Number(b)||0;const P=T.length-b;C?(C=Number(C),C>P&&(C=P)):C=P;const G=p.length;C>G/2&&(C=G/2);let J;for(J=0;J<C;++J){const ye=parseInt(p.substr(J*2,2),16);if(We(ye))return J;T[b+J]=ye}return J}function L(T,p,b,C){return qe(He(p,T.length-b),T,b,C)}function ie(T,p,b,C){return qe(Ge(p),T,b,C)}function ue(T,p,b,C){return qe(Be(p),T,b,C)}function fe(T,p,b,C){return qe(Ae(p,T.length-b),T,b,C)}o.prototype.write=function(p,b,C,P){if(b===void 0)P="utf8",C=this.length,b=0;else if(C===void 0&&typeof b=="string")P=b,C=this.length,b=0;else if(isFinite(b))b=b>>>0,isFinite(C)?(C=C>>>0,P===void 0&&(P="utf8")):(P=C,C=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const G=this.length-b;if((C===void 0||C>G)&&(C=G),p.length>0&&(C<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");P||(P="utf8");let J=!1;for(;;)switch(P){case"hex":return Q(this,p,b,C);case"utf8":case"utf-8":return L(this,p,b,C);case"ascii":case"latin1":case"binary":return ie(this,p,b,C);case"base64":return ue(this,p,b,C);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,p,b,C);default:if(J)throw new TypeError("Unknown encoding: "+P);P=(""+P).toLowerCase(),J=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function he(T,p,b){return p===0&&b===T.length?t.fromByteArray(T):t.fromByteArray(T.slice(p,b))}function ve(T,p,b){b=Math.min(T.length,b);const C=[];let P=p;for(;P<b;){const G=T[P];let J=null,ye=G>239?4:G>223?3:G>191?2:1;if(P+ye<=b){let Se,Ie,Fe,Ee;switch(ye){case 1:G<128&&(J=G);break;case 2:Se=T[P+1],(Se&192)===128&&(Ee=(G&31)<<6|Se&63,Ee>127&&(J=Ee));break;case 3:Se=T[P+1],Ie=T[P+2],(Se&192)===128&&(Ie&192)===128&&(Ee=(G&15)<<12|(Se&63)<<6|Ie&63,Ee>2047&&(Ee<55296||Ee>57343)&&(J=Ee));break;case 4:Se=T[P+1],Ie=T[P+2],Fe=T[P+3],(Se&192)===128&&(Ie&192)===128&&(Fe&192)===128&&(Ee=(G&15)<<18|(Se&63)<<12|(Ie&63)<<6|Fe&63,Ee>65535&&Ee<1114112&&(J=Ee))}}J===null?(J=65533,ye=1):J>65535&&(J-=65536,C.push(J>>>10&1023|55296),J=56320|J&1023),C.push(J),P+=ye}return be(C)}const oe=4096;function be(T){const p=T.length;if(p<=oe)return String.fromCharCode.apply(String,T);let b="",C=0;for(;C<p;)b+=String.fromCharCode.apply(String,T.slice(C,C+=oe));return b}function ce(T,p,b){let C="";b=Math.min(T.length,b);for(let P=p;P<b;++P)C+=String.fromCharCode(T[P]&127);return C}function pe(T,p,b){let C="";b=Math.min(T.length,b);for(let P=p;P<b;++P)C+=String.fromCharCode(T[P]);return C}function _e(T,p,b){const C=T.length;(!p||p<0)&&(p=0),(!b||b<0||b>C)&&(b=C);let P="";for(let G=p;G<b;++G)P+=Pe[T[G]];return P}function q(T,p,b){const C=T.slice(p,b);let P="";for(let G=0;G<C.length-1;G+=2)P+=String.fromCharCode(C[G]+C[G+1]*256);return P}o.prototype.slice=function(p,b){const C=this.length;p=~~p,b=b===void 0?C:~~b,p<0?(p+=C,p<0&&(p=0)):p>C&&(p=C),b<0?(b+=C,b<0&&(b=0)):b>C&&(b=C),b<p&&(b=p);const P=this.subarray(p,b);return Object.setPrototypeOf(P,o.prototype),P};function z(T,p,b){if(T%1!==0||T<0)throw new RangeError("offset is not uint");if(T+p>b)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(p,b,C){p=p>>>0,b=b>>>0,C||z(p,b,this.length);let P=this[p],G=1,J=0;for(;++J<b&&(G*=256);)P+=this[p+J]*G;return P},o.prototype.readUintBE=o.prototype.readUIntBE=function(p,b,C){p=p>>>0,b=b>>>0,C||z(p,b,this.length);let P=this[p+--b],G=1;for(;b>0&&(G*=256);)P+=this[p+--b]*G;return P},o.prototype.readUint8=o.prototype.readUInt8=function(p,b){return p=p>>>0,b||z(p,1,this.length),this[p]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(p,b){return p=p>>>0,b||z(p,2,this.length),this[p]|this[p+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(p,b){return p=p>>>0,b||z(p,2,this.length),this[p]<<8|this[p+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(p,b){return p=p>>>0,b||z(p,4,this.length),(this[p]|this[p+1]<<8|this[p+2]<<16)+this[p+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(p,b){return p=p>>>0,b||z(p,4,this.length),this[p]*16777216+(this[p+1]<<16|this[p+2]<<8|this[p+3])},o.prototype.readBigUInt64LE=Ue(function(p){p=p>>>0,ae(p,"offset");const b=this[p],C=this[p+7];(b===void 0||C===void 0)&&me(p,this.length-8);const P=b+this[++p]*2**8+this[++p]*2**16+this[++p]*2**24,G=this[++p]+this[++p]*2**8+this[++p]*2**16+C*2**24;return BigInt(P)+(BigInt(G)<<BigInt(32))}),o.prototype.readBigUInt64BE=Ue(function(p){p=p>>>0,ae(p,"offset");const b=this[p],C=this[p+7];(b===void 0||C===void 0)&&me(p,this.length-8);const P=b*2**24+this[++p]*2**16+this[++p]*2**8+this[++p],G=this[++p]*2**24+this[++p]*2**16+this[++p]*2**8+C;return(BigInt(P)<<BigInt(32))+BigInt(G)}),o.prototype.readIntLE=function(p,b,C){p=p>>>0,b=b>>>0,C||z(p,b,this.length);let P=this[p],G=1,J=0;for(;++J<b&&(G*=256);)P+=this[p+J]*G;return G*=128,P>=G&&(P-=Math.pow(2,8*b)),P},o.prototype.readIntBE=function(p,b,C){p=p>>>0,b=b>>>0,C||z(p,b,this.length);let P=b,G=1,J=this[p+--P];for(;P>0&&(G*=256);)J+=this[p+--P]*G;return G*=128,J>=G&&(J-=Math.pow(2,8*b)),J},o.prototype.readInt8=function(p,b){return p=p>>>0,b||z(p,1,this.length),this[p]&128?(255-this[p]+1)*-1:this[p]},o.prototype.readInt16LE=function(p,b){p=p>>>0,b||z(p,2,this.length);const C=this[p]|this[p+1]<<8;return C&32768?C|4294901760:C},o.prototype.readInt16BE=function(p,b){p=p>>>0,b||z(p,2,this.length);const C=this[p+1]|this[p]<<8;return C&32768?C|4294901760:C},o.prototype.readInt32LE=function(p,b){return p=p>>>0,b||z(p,4,this.length),this[p]|this[p+1]<<8|this[p+2]<<16|this[p+3]<<24},o.prototype.readInt32BE=function(p,b){return p=p>>>0,b||z(p,4,this.length),this[p]<<24|this[p+1]<<16|this[p+2]<<8|this[p+3]},o.prototype.readBigInt64LE=Ue(function(p){p=p>>>0,ae(p,"offset");const b=this[p],C=this[p+7];(b===void 0||C===void 0)&&me(p,this.length-8);const P=this[p+4]+this[p+5]*2**8+this[p+6]*2**16+(C<<24);return(BigInt(P)<<BigInt(32))+BigInt(b+this[++p]*2**8+this[++p]*2**16+this[++p]*2**24)}),o.prototype.readBigInt64BE=Ue(function(p){p=p>>>0,ae(p,"offset");const b=this[p],C=this[p+7];(b===void 0||C===void 0)&&me(p,this.length-8);const P=(b<<24)+this[++p]*2**16+this[++p]*2**8+this[++p];return(BigInt(P)<<BigInt(32))+BigInt(this[++p]*2**24+this[++p]*2**16+this[++p]*2**8+C)}),o.prototype.readFloatLE=function(p,b){return p=p>>>0,b||z(p,4,this.length),r.read(this,p,!0,23,4)},o.prototype.readFloatBE=function(p,b){return p=p>>>0,b||z(p,4,this.length),r.read(this,p,!1,23,4)},o.prototype.readDoubleLE=function(p,b){return p=p>>>0,b||z(p,8,this.length),r.read(this,p,!0,52,8)},o.prototype.readDoubleBE=function(p,b){return p=p>>>0,b||z(p,8,this.length),r.read(this,p,!1,52,8)};function W(T,p,b,C,P,G){if(!o.isBuffer(T))throw new TypeError('"buffer" argument must be a Buffer instance');if(p>P||p<G)throw new RangeError('"value" argument is out of bounds');if(b+C>T.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(p,b,C,P){if(p=+p,b=b>>>0,C=C>>>0,!P){const ye=Math.pow(2,8*C)-1;W(this,p,b,C,ye,0)}let G=1,J=0;for(this[b]=p&255;++J<C&&(G*=256);)this[b+J]=p/G&255;return b+C},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(p,b,C,P){if(p=+p,b=b>>>0,C=C>>>0,!P){const ye=Math.pow(2,8*C)-1;W(this,p,b,C,ye,0)}let G=C-1,J=1;for(this[b+G]=p&255;--G>=0&&(J*=256);)this[b+G]=p/J&255;return b+C},o.prototype.writeUint8=o.prototype.writeUInt8=function(p,b,C){return p=+p,b=b>>>0,C||W(this,p,b,1,255,0),this[b]=p&255,b+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(p,b,C){return p=+p,b=b>>>0,C||W(this,p,b,2,65535,0),this[b]=p&255,this[b+1]=p>>>8,b+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(p,b,C){return p=+p,b=b>>>0,C||W(this,p,b,2,65535,0),this[b]=p>>>8,this[b+1]=p&255,b+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(p,b,C){return p=+p,b=b>>>0,C||W(this,p,b,4,4294967295,0),this[b+3]=p>>>24,this[b+2]=p>>>16,this[b+1]=p>>>8,this[b]=p&255,b+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(p,b,C){return p=+p,b=b>>>0,C||W(this,p,b,4,4294967295,0),this[b]=p>>>24,this[b+1]=p>>>16,this[b+2]=p>>>8,this[b+3]=p&255,b+4};function N(T,p,b,C,P){de(p,C,P,T,b,7);let G=Number(p&BigInt(4294967295));T[b++]=G,G=G>>8,T[b++]=G,G=G>>8,T[b++]=G,G=G>>8,T[b++]=G;let J=Number(p>>BigInt(32)&BigInt(4294967295));return T[b++]=J,J=J>>8,T[b++]=J,J=J>>8,T[b++]=J,J=J>>8,T[b++]=J,b}function U(T,p,b,C,P){de(p,C,P,T,b,7);let G=Number(p&BigInt(4294967295));T[b+7]=G,G=G>>8,T[b+6]=G,G=G>>8,T[b+5]=G,G=G>>8,T[b+4]=G;let J=Number(p>>BigInt(32)&BigInt(4294967295));return T[b+3]=J,J=J>>8,T[b+2]=J,J=J>>8,T[b+1]=J,J=J>>8,T[b]=J,b+8}o.prototype.writeBigUInt64LE=Ue(function(p,b=0){return N(this,p,b,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=Ue(function(p,b=0){return U(this,p,b,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(p,b,C,P){if(p=+p,b=b>>>0,!P){const Se=Math.pow(2,8*C-1);W(this,p,b,C,Se-1,-Se)}let G=0,J=1,ye=0;for(this[b]=p&255;++G<C&&(J*=256);)p<0&&ye===0&&this[b+G-1]!==0&&(ye=1),this[b+G]=(p/J>>0)-ye&255;return b+C},o.prototype.writeIntBE=function(p,b,C,P){if(p=+p,b=b>>>0,!P){const Se=Math.pow(2,8*C-1);W(this,p,b,C,Se-1,-Se)}let G=C-1,J=1,ye=0;for(this[b+G]=p&255;--G>=0&&(J*=256);)p<0&&ye===0&&this[b+G+1]!==0&&(ye=1),this[b+G]=(p/J>>0)-ye&255;return b+C},o.prototype.writeInt8=function(p,b,C){return p=+p,b=b>>>0,C||W(this,p,b,1,127,-128),p<0&&(p=255+p+1),this[b]=p&255,b+1},o.prototype.writeInt16LE=function(p,b,C){return p=+p,b=b>>>0,C||W(this,p,b,2,32767,-32768),this[b]=p&255,this[b+1]=p>>>8,b+2},o.prototype.writeInt16BE=function(p,b,C){return p=+p,b=b>>>0,C||W(this,p,b,2,32767,-32768),this[b]=p>>>8,this[b+1]=p&255,b+2},o.prototype.writeInt32LE=function(p,b,C){return p=+p,b=b>>>0,C||W(this,p,b,4,2147483647,-2147483648),this[b]=p&255,this[b+1]=p>>>8,this[b+2]=p>>>16,this[b+3]=p>>>24,b+4},o.prototype.writeInt32BE=function(p,b,C){return p=+p,b=b>>>0,C||W(this,p,b,4,2147483647,-2147483648),p<0&&(p=4294967295+p+1),this[b]=p>>>24,this[b+1]=p>>>16,this[b+2]=p>>>8,this[b+3]=p&255,b+4},o.prototype.writeBigInt64LE=Ue(function(p,b=0){return N(this,p,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=Ue(function(p,b=0){return U(this,p,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function K(T,p,b,C,P,G){if(b+C>T.length)throw new RangeError("Index out of range");if(b<0)throw new RangeError("Index out of range")}function ee(T,p,b,C,P){return p=+p,b=b>>>0,P||K(T,p,b,4),r.write(T,p,b,C,23,4),b+4}o.prototype.writeFloatLE=function(p,b,C){return ee(this,p,b,!0,C)},o.prototype.writeFloatBE=function(p,b,C){return ee(this,p,b,!1,C)};function te(T,p,b,C,P){return p=+p,b=b>>>0,P||K(T,p,b,8),r.write(T,p,b,C,52,8),b+8}o.prototype.writeDoubleLE=function(p,b,C){return te(this,p,b,!0,C)},o.prototype.writeDoubleBE=function(p,b,C){return te(this,p,b,!1,C)},o.prototype.copy=function(p,b,C,P){if(!o.isBuffer(p))throw new TypeError("argument should be a Buffer");if(C||(C=0),!P&&P!==0&&(P=this.length),b>=p.length&&(b=p.length),b||(b=0),P>0&&P<C&&(P=C),P===C||p.length===0||this.length===0)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if(C<0||C>=this.length)throw new RangeError("Index out of range");if(P<0)throw new RangeError("sourceEnd out of bounds");P>this.length&&(P=this.length),p.length-b<P-C&&(P=p.length-b+C);const G=P-C;return this===p&&typeof i.prototype.copyWithin=="function"?this.copyWithin(b,C,P):i.prototype.set.call(p,this.subarray(C,P),b),G},o.prototype.fill=function(p,b,C,P){if(typeof p=="string"){if(typeof b=="string"?(P=b,b=0,C=this.length):typeof C=="string"&&(P=C,C=this.length),P!==void 0&&typeof P!="string")throw new TypeError("encoding must be a string");if(typeof P=="string"&&!o.isEncoding(P))throw new TypeError("Unknown encoding: "+P);if(p.length===1){const J=p.charCodeAt(0);(P==="utf8"&&J<128||P==="latin1")&&(p=J)}}else typeof p=="number"?p=p&255:typeof p=="boolean"&&(p=Number(p));if(b<0||this.length<b||this.length<C)throw new RangeError("Out of range index");if(C<=b)return this;b=b>>>0,C=C===void 0?this.length:C>>>0,p||(p=0);let G;if(typeof p=="number")for(G=b;G<C;++G)this[G]=p;else{const J=o.isBuffer(p)?p:o.from(p,P),ye=J.length;if(ye===0)throw new TypeError('The value "'+p+'" is invalid for argument "value"');for(G=0;G<C-b;++G)this[G+b]=J[G%ye]}return this};const I={};function M(T,p,b){I[T]=class extends b{constructor(){super(),Object.defineProperty(this,"message",{value:p.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${T}]`,this.stack,delete this.name}get code(){return T}set code(P){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:P,writable:!0})}toString(){return`${this.name} [${T}]: ${this.message}`}}}M("ERR_BUFFER_OUT_OF_BOUNDS",function(T){return T?`${T} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),M("ERR_INVALID_ARG_TYPE",function(T,p){return`The "${T}" argument must be of type number. Received type ${typeof p}`},TypeError),M("ERR_OUT_OF_RANGE",function(T,p,b){let C=`The value of "${T}" is out of range.`,P=b;return Number.isInteger(b)&&Math.abs(b)>2**32?P=Y(String(b)):typeof b=="bigint"&&(P=String(b),(b>BigInt(2)**BigInt(32)||b<-(BigInt(2)**BigInt(32)))&&(P=Y(P)),P+="n"),C+=` It must be ${p}. Received ${P}`,C},RangeError);function Y(T){let p="",b=T.length;const C=T[0]==="-"?1:0;for(;b>=C+4;b-=3)p=`_${T.slice(b-3,b)}${p}`;return`${T.slice(0,b)}${p}`}function ne(T,p,b){ae(p,"offset"),(T[p]===void 0||T[p+b]===void 0)&&me(p,T.length-(b+1))}function de(T,p,b,C,P,G){if(T>b||T<p){const J=typeof p=="bigint"?"n":"";let ye;throw p===0||p===BigInt(0)?ye=`>= 0${J} and < 2${J} ** ${(G+1)*8}${J}`:ye=`>= -(2${J} ** ${(G+1)*8-1}${J}) and < 2 ** ${(G+1)*8-1}${J}`,new I.ERR_OUT_OF_RANGE("value",ye,T)}ne(C,P,G)}function ae(T,p){if(typeof T!="number")throw new I.ERR_INVALID_ARG_TYPE(p,"number",T)}function me(T,p,b){throw Math.floor(T)!==T?(ae(T,b),new I.ERR_OUT_OF_RANGE("offset","an integer",T)):p<0?new I.ERR_BUFFER_OUT_OF_BOUNDS:new I.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${p}`,T)}const Le=/[^+/0-9A-Za-z-_]/g;function X(T){if(T=T.split("=")[0],T=T.trim().replace(Le,""),T.length<2)return"";for(;T.length%4!==0;)T=T+"=";return T}function He(T,p){p=p||1/0;let b;const C=T.length;let P=null;const G=[];for(let J=0;J<C;++J){if(b=T.charCodeAt(J),b>55295&&b<57344){if(!P){if(b>56319){(p-=3)>-1&&G.push(239,191,189);continue}else if(J+1===C){(p-=3)>-1&&G.push(239,191,189);continue}P=b;continue}if(b<56320){(p-=3)>-1&&G.push(239,191,189),P=b;continue}b=(P-55296<<10|b-56320)+65536}else P&&(p-=3)>-1&&G.push(239,191,189);if(P=null,b<128){if((p-=1)<0)break;G.push(b)}else if(b<2048){if((p-=2)<0)break;G.push(b>>6|192,b&63|128)}else if(b<65536){if((p-=3)<0)break;G.push(b>>12|224,b>>6&63|128,b&63|128)}else if(b<1114112){if((p-=4)<0)break;G.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw new Error("Invalid code point")}return G}function Ge(T){const p=[];for(let b=0;b<T.length;++b)p.push(T.charCodeAt(b)&255);return p}function Ae(T,p){let b,C,P;const G=[];for(let J=0;J<T.length&&!((p-=2)<0);++J)b=T.charCodeAt(J),C=b>>8,P=b%256,G.push(P),G.push(C);return G}function Be(T){return t.toByteArray(X(T))}function qe(T,p,b,C){let P;for(P=0;P<C&&!(P+b>=p.length||P>=T.length);++P)p[P+b]=T[P];return P}function Oe(T,p){return T instanceof p||T!=null&&T.constructor!=null&&T.constructor.name!=null&&T.constructor.name===p.name}function We(T){return T!==T}const Pe=(function(){const T="0123456789abcdef",p=new Array(256);for(let b=0;b<16;++b){const C=b*16;for(let P=0;P<16;++P)p[C+P]=T[b]+T[P]}return p})();function Ue(T){return typeof BigInt>"u"?lt:T}function lt(){throw new Error("BigInt not supported")}})(Ba);const ot=Ba.Buffer,gt=Ba.Buffer;var nr={},Ht={},ir={},nc;function Z0(){return nc||(nc=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.checkVersion=void 0,ir.checkVersion={allTokenHandler:(s,t)=>{if(s._count===1&&t.type!==0)throw new Error('File should start with "{"');if(s._count===2&&(t.word!=="rtf"||t.param&&t.param!==1))throw new Error('File should start with "{\\rtf[0,1]"')},preStreamFlushHandler:s=>{if(s._count===0)throw new Error('File should start with "{"');if(s._count===1)throw new Error('File should start with "{\\rtf"')}}),ir}var ar={},ic;function X0(){return ic||(ic=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.countTokens=void 0,ar.countTokens={allTokenHandler:s=>{++s._count}}),ar}var sr={},Et={},ac;function Dt(){if(ac)return Et;ac=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.isNum=Et.isStr=Et.isDef=void 0;function s(e){return typeof e<"u"}Et.isDef=s;function t(e){return typeof e=="string"}Et.isStr=t;function r(e){return typeof e=="number"}return Et.isNum=r,Et}var sc;function J0(){if(sc)return sr;sc=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.handleCharacterSet=void 0;const s=Dt(),t={mac:()=>{throw new Error("Unsupported character set \\mac")},pc:()=>{throw new Error("Unsupported character set \\pc")},pca:()=>{throw new Error("Unsupported character set \\pca")},ansicpg:(r,e)=>{if(!(r._state.destination==="rtf"&&r._state.destDepth>1&&r._ansicpg)){if(r._ansicpg){r._options.warn("\\ansicpg already defined");return}if(!s.isNum(e.param)){r._options.warn("\\ansicpg with no param");return}r._ansicpg=!0,r._cpg=e.param}}};return sr.handleCharacterSet={controlHandlers:t},sr}var or={},cr={},oc;function Q0(){return oc||(oc=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.words=void 0,cr.words={"'":1,"-":1,"*":1,":":1,"\\":1,_:1,"{":1,"|":1,"}":1,"~":1,ab:2,absh:3,abslock:4,absnoovrlp:2,absw:3,acaps:2,acccircle:2,acccomma:2,accdot:2,accnone:2,accunderdot:2,acf:3,adeff:3,additive:4,adeflang:3,adjustright:4,adn:3,aenddoc:4,aendnotes:4,aexpnd:3,af:3,afelev:4,afs:3,aftnbj:4,aftncn:5,aftnnalc:4,aftnnar:4,aftnnauc:4,aftnnchi:4,aftnnchosung:4,aftnncnum:4,aftnndbar:4,aftnndbnum:4,aftnndbnumd:4,aftnndbnumk:4,aftnndbnumt:4,aftnnganada:4,aftnngbnum:4,aftnngbnumd:4,aftnngbnumk:4,aftnngbnuml:4,aftnnrlc:4,aftnnruc:4,aftnnzodiac:4,aftnnzodiacd:4,aftnnzodiacl:4,aftnrestart:4,aftnrstcont:4,aftnsep:5,aftnsepc:5,aftnstart:3,aftntj:4,ai:2,alang:3,allowfieldendsel:4,allprot:4,alntblind:4,alt:4,animtext:3,annotation:5,annotprot:4,ansi:4,ansicpg:3,aoutl:2,ApplyBrkRules:4,ascaps:2,ashad:2,asianbrkrule:4,aspalpha:2,aspnum:2,astrike:2,atnauthor:5,atndate:5,atnicn:5,atnid:5,atnparent:5,atnref:5,atntime:5,atrfend:5,atrfstart:5,aul:2,auld:2,auldb:2,aulnone:2,aulw:2,aup:3,author:5,autofmtoverride:4,b:2,background:5,bdbfhdr:4,bdrrlswsix:4,bgbdiag:4,bgcross:4,bgdcross:4,bgdkbdiag:4,bgdkcross:4,bgdkdcross:4,bgdkfdiag:4,bgdkhoriz:4,bgdkvert:4,bgfdiag:4,bghoriz:4,bgvert:4,bin:3,binfsxn:3,binsxn:3,bkmkcolf:3,bkmkcoll:3,bkmkend:5,bkmkpub:4,bkmkstart:5,bliptag:3,blipuid:5,blipupi:3,blue:3,bookfold:4,bookfoldrev:4,bookfoldsheets:3,box:4,brdrart:3,brdrb:4,brdrbar:4,brdrbtw:4,brdrcf:3,brdrdash:4,brdrdashd:4,brdrdashdd:4,brdrdashdot:4,brdrdashdotdot:4,brdrdashdotstr:4,brdrdashsm:4,brdrdb:4,brdrdot:4,brdremboss:4,brdrengrave:4,brdrframe:4,brdrhair:4,brdrinset:4,brdrl:4,brdrnil:4,brdrnone:4,brdroutset:4,brdrr:4,brdrs:4,brdrsh:4,brdrt:4,brdrtbl:4,brdrth:4,brdrthtnlg:4,brdrthtnmg:4,brdrthtnsg:4,brdrtnthlg:4,brdrtnthmg:4,brdrtnthsg:4,brdrtnthtnlg:4,brdrtnthtnmg:4,brdrtnthtnsg:4,brdrtriple:4,brdrw:3,brdrwavy:4,brdrwavydb:4,brkfrm:4,brsp:3,bullet:1,buptim:5,bxe:4,caccentfive:4,caccentfour:4,caccentone:4,caccentsix:4,caccentthree:4,caccenttwo:4,cachedcolbal:4,caps:2,category:5,cb:3,cbackgroundone:4,cbackgroundtwo:4,cbpat:3,cchs:3,cell:1,cellx:3,cf:3,cfollowedhyperlink:4,cfpat:3,cgrid:3,charrsid:3,charscalex:3,chatn:1,chbgbdiag:4,chbgcross:4,chbgdcross:4,chbgdkbdiag:4,chbgdkcross:4,chbgdkdcross:4,chbgdkfdiag:4,chbgdkhoriz:4,chbgdkvert:4,chbgfdiag:4,chbghoriz:4,chbgvert:4,chbrdr:4,chcbpat:3,chcfpat:3,chdate:1,chdpa:1,chdpl:1,chftn:1,chftnsep:1,chftnsepc:1,chpgn:1,chhres:3,chshdng:3,chtime:1,chyperlink:4,clbgbdiag:4,clbgcross:4,clbgdcross:4,clbgdkbdiag:4,clbgdkcross:4,clbgdkdcross:4,clbgdkfdiag:4,clbgdkhor:4,clbgdkvert:4,clbgfdiag:4,clbghoriz:4,clbgvert:4,clbrdrb:4,clbrdrl:4,clbrdrr:4,clbrdrt:4,clcbpat:3,clcbpatraw:3,clcfpat:3,clcfpatraw:3,cldel:4,cldelauth:3,cldeldttm:3,cldgll:4,cldglu:4,clFitText:4,clftsWidth:3,clhidemark:4,clins:4,clinsauth:3,clinsdttm:3,clmgf:4,clmrg:4,clmrgd:4,clmrgdauth:3,clmrgddttm:3,clmrgdr:4,clNoWrap:4,clpadb:3,clpadfb:3,clpadfl:3,clpadfr:3,clpadft:3,clpadl:3,clpadr:3,clpadt:3,clspb:3,clspfb:3,clspfl:3,clspfr:3,clspft:3,clspl:3,clspr:3,clspt:3,clshdng:3,clshdngraw:3,clshdrawnil:4,clsplit:4,clsplitr:4,cltxbtlr:4,cltxlrtb:4,cltxlrtbv:4,cltxtbrl:4,cltxtbrlv:4,clvertalb:4,clvertalc:4,clvertalt:4,clvmgf:4,clvmrg:4,clwWidth:3,cmaindarkone:4,cmaindarktwo:4,cmainlightone:4,cmainlighttwo:4,collapsed:4,colno:3,colorschememapping:5,colortbl:5,cols:3,colsr:3,colsx:3,column:1,colw:3,comment:5,company:5,contextualspace:4,cpg:3,crauth:3,crdate:3,creatim:5,cs:3,cshade:3,ctextone:4,ctexttwo:4,ctint:3,ctrl:4,cts:3,cufi:3,culi:3,curi:3,cvmme:4,datafield:5,datastore:5,date:4,dbch:4,defchp:5,deff:3,defformat:4,deflang:3,deflangfe:3,defpap:5,defshp:4,deftab:3,deleted:2,delrsid:3,dfrauth:3,dfrdate:3,dfrmtxtx:3,dfrmtxty:3,dfrstart:3,dfrstop:3,dfrxst:3,dghorigin:3,dghshow:3,dghspace:3,dgmargin:4,dgsnap:4,dgvorigin:3,dgvshow:3,dgvspace:3,dibitmap:3,disabled:2,dn:3,dntblnsbdb:4,do:5,dobxcolumn:4,dobxmargin:4,dobxpage:4,dobymargin:4,dobypage:4,dobypara:4,doccomm:5,doctemp:4,doctype:3,docvar:5,dodhgt:3,dolock:4,donotembedlingdata:3,donotembedsysfont:3,donotshowcomments:4,donotshowinsdel:4,donotshowmarkup:4,donotshowprops:4,dpaendhol:4,dpaendl:3,dpaendsol:4,dpaendw:3,dparc:4,dparcflipx:4,dparcflipy:4,dpastarthol:4,dpastartl:3,dpastartsol:4,dpastartw:3,dpcallout:4,dpcoa:3,dpcoaccent:4,dpcobestfit:4,dpcoborder:4,dpcodabs:4,dpcodbottom:4,dpcodcenter:4,dpcodescent:3,dpcodtop:4,dpcolength:3,dpcominusx:4,dpcominusy:4,dpcooffset:3,dpcosmarta:4,dpcotdouble:4,dpcotright:4,dpcotsingle:4,dpcottriple:4,dpcount:3,dpellipse:4,dpendgroup:4,dpfillbgcb:3,dpfillbgcg:3,dpfillbgcr:3,dpfillbggray:3,dpfillbgpal:4,dpfillfgcb:3,dpfillfgcg:3,dpfillfgcr:3,dpfillfggray:3,dpfillfgpal:4,dpfillpat:3,dpgroup:4,dpline:4,dplinecob:3,dplinecog:3,dplinecor:3,dplinedado:4,dplinedadodo:4,dplinedash:4,dplinedot:4,dplinegray:3,dplinehollow:4,dplinepal:4,dplinesolid:4,dplinew:3,dppolycount:3,dppolygon:4,dppolyline:4,dpptx:3,dppty:3,dprect:4,dproundr:4,dpshadow:4,dpshadx:3,dpshady:3,dptxbtlr:4,dptxbx:4,dptxbxmar:3,dptxbxtext:5,dptxlrtb:4,dptxlrtbv:4,dptxtbrl:4,dptxtbrlv:4,dpx:3,dpxsize:3,dpy:3,dpysize:3,dropcapli:3,dropcapt:3,ds:3,dxfrtext:3,dy:3,ebcend:5,ebcstart:5,edmins:3,embo:2,emdash:1,emfblip:4,emspace:1,endash:1,enddoc:4,endnhere:4,endnotes:4,enforceprot:3,enspace:1,expnd:3,expndtw:3,expshrtn:4,f:3,faauto:4,facenter:4,facingp:4,factoidname:5,fafixed:4,fahang:4,falt:5,faroman:4,favar:4,fbias:3,fbidi:4,fbidis:4,fbimajor:4,fbiminor:4,fchars:5,fcharset:3,fcs:3,fdbmajor:4,fdbminor:4,fdecor:4,felnbrelev:4,fet:3,fetch:4,ffdefres:3,ffdeftext:5,ffentrymcr:5,ffexitmcr:5,ffformat:5,ffhaslistbox:3,ffhelptext:5,ffhps:3,ffl:5,ffmaxlen:3,ffname:5,ffownhelp:3,ffownstat:3,ffprot:3,ffrecalc:3,ffres:3,ffsize:3,ffstattext:5,fftype:3,fftypetxt:3,fhimajor:4,fhiminor:4,fi:3,fid:3,field:5,file:5,filetbl:5,fittext:3,fjgothic:4,fjminchou:4,fldalt:4,flddirty:4,fldedit:4,fldinst:5,fldlock:4,fldpriv:4,fldrslt:5,fldtype:5,flomajor:4,flominor:4,fmodern:4,fn:3,fname:5,fnetwork:4,fnil:4,fnonfilesys:4,fontemb:5,fontfile:5,fonttbl:5,footer:5,footerf:5,footerl:5,footerr:5,footery:3,footnote:5,forceupgrade:4,formatConverter:5,formdisp:4,formfield:5,formprot:4,formshade:4,fosnum:3,fprq:3,fracwidth:4,frelative:3,frmtxbtlr:4,frmtxlrtb:4,frmtxlrtbv:4,frmtxtbrl:4,frmtxtbrlv:4,froman:4,fromhtml:3,fromtext:4,fs:3,fscript:4,fswiss:4,ftech:4,ftnalt:4,ftnbj:4,ftncn:5,ftnil:4,ftnlytwnine:4,ftnnalc:4,ftnnar:4,ftnnauc:4,ftnnchi:4,ftnnchosung:4,ftnncnum:4,ftnndbar:4,ftnndbnum:4,ftnndbnumd:4,ftnndbnumk:4,ftnndbnumt:4,ftnnganada:4,ftnngbnum:4,ftnngbnumd:4,ftnngbnumk:4,ftnngbnuml:4,ftnnrlc:4,ftnnruc:4,ftnnzodiac:4,ftnnzodiacd:4,ftnnzodiacl:4,ftnrestart:4,ftnrstcont:4,ftnrstpg:4,ftnsep:5,ftnsepc:5,ftnstart:3,ftntj:4,fttruetype:4,fvaliddos:4,fvalidhpfs:4,fvalidmac:4,fvalidntfs:4,g:5,gcw:3,generator:5,green:3,grfdocevents:3,gridtbl:5,gutter:3,gutterprl:4,guttersxn:3,header:5,headerf:5,headerl:5,headerr:5,headery:3,hich:4,highlight:3,hl:5,hlfr:5,hlinkbase:5,hlloc:5,hlsrc:5,horzdoc:4,horzsect:4,horzvert:3,hr:3,hres:3,hrule:4,hsv:5,htmautsp:4,htmlbase:4,htmlrtf:2,htmltag:5,hwelev:4,hyphauto:2,hyphcaps:2,hyphconsec:3,hyphhotz:3,hyphpar:2,i:2,id:3,ignoremixedcontent:3,ilfomacatclnup:3,ilvl:3,impr:2,indmirror:4,indrlsweleven:4,info:5,insrsid:3,intbl:4,ipgp:3,irowband:3,irow:3,itap:3,ixe:4,jcompress:4,jexpand:4,jis:4,jpegblip:4,jsksu:4,keep:4,keepn:4,kerning:3,keycode:5,keywords:5,krnprsnet:4,ksulang:3,jclisttab:4,landscape:4,lang:3,langfe:3,langfenp:3,langnp:3,lastrow:4,latentstyles:5,lbr:3,lchars:5,ldblquote:1,level:3,levelfollow:3,levelindent:3,leveljc:3,leveljcn:3,levellegal:3,levelnfc:3,levelnfcn:3,levelnorestart:3,levelnumbers:5,levelold:3,levelpicture:3,levelpicturenosize:4,levelprev:3,levelprevspace:3,levelspace:3,levelstartat:3,leveltemplateid:3,leveltext:5,lfolevel:5,li:3,line:1,linebetcol:4,linecont:4,linemod:3,lineppage:4,linerestart:4,linestart:3,linestarts:3,linex:3,linkself:4,linkstyles:4,linkval:5,lin:3,lisa:3,lisb:3,list:5,listhybrid:4,listid:3,listlevel:5,listname:5,listoverride:5,listoverridecount:3,listoverrideformat:3,listoverridestartat:4,listoverridetable:5,listpicture:5,listrestarthdn:3,listsimple:3,liststyleid:3,liststylename:5,listtable:5,listtemplateid:3,listtext:5,lnbrkrule:4,lndscpsxn:4,lnongrid:4,loch:4,lquote:1,ls:3,lsdlocked:3,lsdlockeddef:3,lsdlockedexcept:5,lsdpriority:3,lsdprioritydef:3,lsdqformat:3,lsdqformatdef:3,lsdsemihidden:3,lsdsemihiddendef:3,lsdstimax:3,lsdunhideused:3,lsdunhideuseddef:3,ltrch:4,ltrdoc:4,ltrmark:1,ltrpar:4,ltrrow:4,ltrsect:4,lvltentative:4,lytcalctblwd:4,lytexcttp:4,lytprtmet:4,lyttblrtgr:4,mac:4,macc:5,maccPr:5,macpict:4,mailmerge:5,makebackup:4,maln:5,malnScr:5,manager:5,margb:3,margbsxn:3,margl:3,marglsxn:3,margmirror:4,margmirsxn:4,margPr:5,margr:3,margrsxn:3,margSz:3,margt:3,margtsxn:3,mbar:5,mbarPr:5,mbaseJc:5,mbegChr:5,mborderBox:5,mborderBoxPr:5,mbox:5,mboxPr:5,mbrk:3,mbrkBin:3,mbrkBinSub:3,mcGp:3,mcGpRule:3,mchr:5,mcount:5,mcSp:3,mctrlPr:5,md:5,mdefJc:3,mdeg:5,mdegHide:5,mden:5,mdiff:5,mdiffSty:3,mdispDef:3,mdPr:5,me:5,mendChr:5,meqArr:5,meqArrPr:5,mf:5,mfName:5,mfPr:5,mfunc:5,mfuncPr:5,mgroupChr:5,mgroupChrPr:5,mgrow:5,mhideBot:5,mhideLeft:5,mhideRight:5,mhideTop:5,mhtmltag:5,min:3,minterSp:3,mintLim:3,mintraSp:3,mjc:3,mlim:5,mlimLoc:5,mlimLow:5,mlimLowPr:5,mlimUpp:5,mlimUppPr:5,mlit:4,mlMargin:3,mm:5,mmaddfieldname:5,mmath:5,mmathFont:3,mmathPict:5,mmathPr:5,mmattach:4,mmaxDist:5,mmblanklines:4,mmc:5,mmcJc:5,mmconnectstr:5,mmconnectstrdata:5,mmcPr:5,mmcs:5,mmdatasource:5,mmdatatypeaccess:4,mmdatatypeexcel:4,mmdatatypefile:4,mmdatatypeodbc:4,mmdatatypeodso:4,mmdatatypeqt:4,mmdefaultsql:4,mmdestemail:4,mmdestfax:4,mmdestnewdoc:4,mmdestprinter:4,mmerrors:3,mmfttypeaddress:4,mmfttypebarcode:4,mmfttypedbcolumn:4,mmfttypemapped:4,mmfttypenull:4,mmfttypesalutation:4,mmheadersource:5,mmjdsotype:3,mmlinktoquery:4,mmmailsubject:5,mmmaintypecatalog:4,mmmaintypeemail:4,mmmaintypeenvelopes:4,mmmaintypefax:4,mmmaintypelabels:4,mmmaintypeletters:4,mmodso:5,mmodsoactive:3,mmodsocoldelim:3,mmodsocolumn:3,mmodsodynaddr:3,mmodsofhdr:3,mmodsofilter:5,mmodsofldmpdata:5,mmodsofmcolumn:3,mmodsohash:3,mmodsolid:3,mmodsomappedname:5,mmodsoname:5,mmodsorecipdata:5,mmodsosort:5,mmodsosrc:5,mmodsotable:5,mmodsoudl:5,mmodsoudldata:5,mmodsouniquetag:5,mmPr:5,mmquery:5,mmr:5,mmreccur:3,mmshowdata:4,mnary:5,mnaryLim:3,mnaryPr:5,mnoBreak:5,mnor:4,mnum:5,mo:3,mobjDist:5,moMath:5,moMathPara:5,moMathParaPr:5,mopEmu:5,mphant:5,mphantPr:5,mplcHide:5,mpos:5,mpostSp:3,mpreSp:3,mr:5,mrad:5,mradPr:5,mrMargin:3,mrPr:5,mrSp:3,mrSpRule:3,mscr:3,msepChr:5,mshow:5,mshp:5,msmallFrac:3,msmcap:4,msPre:5,msPrePr:5,msSub:5,msSubPr:5,msSubSup:5,msSubSupPr:5,msSup:5,msSupPr:5,mstrikeBLTR:5,mstrikeH:5,mstrikeTLBR:5,mstrikeV:5,msty:3,msub:5,msubHide:5,msup:5,msupHide:5,mtransp:5,mtype:5,muser:4,mvauth:3,mvdate:3,mvertJc:5,mvf:4,mvfmf:5,mvfml:5,mvt:4,mvtof:5,mvtol:5,mwrapIndent:3,mwrapRight:3,mzeroAsc:5,mzeroDesc:5,mzeroWid:5,nestcell:1,nestrow:1,nesttableprops:5,newtblstyruls:4,nextfile:5,noafcnsttbl:4,nobrkwrptbl:4,nocolbal:4,nocompatoptions:4,nocwrap:4,nocxsptable:4,noextrasprl:4,nofchars:3,nofcharsws:3,nofeaturethrottle:4,nofpages:3,nofwords:3,nogrowautofit:4,noindnmbrts:4,nojkernpunct:4,nolead:4,noline:4,nolnhtadjtbl:4,nonesttables:5,nonshppict:5,nooverflow:4,noproof:4,noqfpromote:4,nosectexpand:4,nosnaplinegrid:4,nospaceforul:4,nosupersub:4,notabind:4,notbrkcnstfrctbl:4,notcvasp:4,notvatxbx:4,nouicompat:4,noultrlspc:4,nowidctlpar:4,nowrap:4,nowwrap:4,noxlattoyen:4,objalias:5,objalign:3,objattph:4,objautlink:4,objclass:5,objcropb:3,objcropl:3,objcropr:3,objcropt:3,objdata:5,object:5,objemb:4,objh:3,objhtml:4,objicemb:4,objlink:4,objlock:4,objname:5,objocx:4,objpub:4,objscalex:3,objscaley:3,objsect:5,objsetsize:4,objsub:4,objtime:5,objtransy:3,objupdate:4,objw:3,ogutter:3,oldas:4,oldcprops:5,oldlinewrap:4,oldpprops:5,oldsprops:5,oldtprops:5,oleclsid:5,operator:5,otblrul:4,outl:2,outlinelevel:3,overlay:4,page:1,pagebb:4,panose:5,paperh:3,paperw:3,par:1,pararsid:3,pard:4,password:5,passwordhash:5,pc:4,pca:4,pgbrdrb:4,pgbrdrfoot:4,pgbrdrhead:4,pgbrdrl:4,pgbrdropt:3,pgbrdrr:4,pgbrdrsnap:4,pgbrdrt:4,pghsxn:3,pgnbidia:4,pgnbidib:4,pgnchosung:4,pgncnum:4,pgncont:4,pgndbnum:4,pgndbnumd:4,pgndbnumk:4,pgndbnumt:4,pgndec:4,pgndecd:4,pgnganada:4,pgngbnum:4,pgngbnumd:4,pgngbnumk:4,pgngbnuml:4,pgnhindia:4,pgnhindib:4,pgnhindic:4,pgnhindid:4,pgnhn:3,pgnhnsc:4,pgnhnsh:4,pgnhnsm:4,pgnhnsn:4,pgnhnsp:4,pgnid:4,pgnlcltr:4,pgnlcrm:4,pgnrestart:4,pgnstart:3,pgnstarts:3,pgnthaia:4,pgnthaib:4,pgnthaic:4,pgnucltr:4,pgnucrm:4,pgnvieta:4,pgnx:3,pgny:3,pgnzodiac:4,pgnzodiacd:4,pgnzodiacl:4,pgp:5,pgptbl:5,pgwsxn:3,phcol:4,phmrg:4,phpg:4,picbmp:4,picbpp:3,piccropb:3,piccropl:3,piccropr:3,piccropt:3,pich:3,pichgoal:3,picprop:5,picscaled:4,picscalex:3,picscaley:3,pict:5,picw:3,picwgoal:3,pindtabqc:4,pindtabql:4,pindtabqr:4,plain:4,pmartabqc:4,pmartabql:4,pmartabqr:4,pmmetafile:3,pn:5,pnacross:4,pnaiu:4,pnaiud:4,pnaiueo:4,pnaiueod:4,pnb:2,pnbidia:4,pnbidib:4,pncaps:2,pncard:4,pncf:3,pnchosung:4,pncnum:4,pndbnum:4,pndbnumd:4,pndbnumk:4,pndbnuml:4,pndbnumt:4,pndec:4,pndecd:4,pnf:3,pnfs:3,pnganada:4,pngblip:4,pngbnum:4,pngbnumd:4,pngbnumk:4,pngbnuml:4,pnhang:4,pni:2,pnindent:3,pniroha:4,pnirohad:4,pnlcltr:4,pnlcrm:4,pnlvl:3,pnlvlblt:4,pnlvlbody:4,pnlvlcont:4,pnnumonce:4,pnord:4,pnordt:4,pnprev:4,pnqc:4,pnql:4,pnqr:4,pnrauth:3,pnrdate:3,pnrestart:4,pnrnfc:3,pnrnot:4,pnrpnbr:3,pnrrgb:3,pnrstart:3,pnrstop:3,pnrxst:3,pnscaps:2,pnseclvl:5,pnsp:3,pnstart:3,pnstrike:2,pntext:5,pntxta:5,pntxtb:5,pnucltr:4,pnucrm:4,pnul:2,pnuld:4,pnuldash:4,pnuldashd:4,pnuldashdd:4,pnuldb:4,pnulhair:4,pnulnone:4,pnulth:4,pnulw:4,pnulwave:4,pnzodiac:4,pnzodiacd:4,pnzodiacl:4,posnegx:3,posnegy:3,posx:3,posxc:4,posxi:4,posxl:4,posxo:4,posxr:4,posy:3,posyb:4,posyc:4,posyil:4,posyin:4,posyout:4,posyt:4,prauth:3,prcolbl:4,prdate:3,printdata:4,printim:5,private:5,propname:5,proptype:3,protect:2,protend:5,protlevel:3,protstart:5,protusertbl:5,psover:4,psz:3,ptabldot:4,ptablmdot:4,ptablminus:4,ptablnone:4,ptabluscore:4,pubauto:4,pvmrg:4,pvpara:4,pvpg:4,pwd:3,pxe:5,qc:4,qd:4,qj:4,qk:3,ql:4,qmspace:1,qr:4,qt:4,rawclbgdkbdiag:4,rawclbgbdiag:4,rawclbgcross:4,rawclbgdcross:4,rawclbgdkcross:4,rawclbgdkdcross:4,rawclbgdkfdiag:4,rawclbgdkhor:4,rawclbgdkvert:4,rawclbgfdiag:4,rawclbghoriz:4,rawclbgvert:4,rdblquote:1,readonlyrecommended:4,readprot:4,red:3,relyonvml:3,remdttm:4,rempersonalinfo:4,result:5,revauth:3,revauthdel:3,revbar:3,revdttm:3,revdttmdel:3,revised:2,revisions:4,revprop:3,revprot:4,revtbl:5,revtim:5,ri:3,rin:3,row:1,rquote:1,rsid:3,rsidroot:3,rsidtbl:5,rsltbmp:4,rslthtml:4,rsltmerge:4,rsltpict:4,rsltrtf:4,rslttxt:4,rtf:5,rtlch:4,rtldoc:4,rtlgutter:4,rtlmark:1,rtlpar:4,rtlrow:4,rtlsect:4,rxe:5,s:3,sa:3,saauto:2,saftnnalc:4,saftnnar:4,saftnnauc:4,saftnnchi:4,saftnnchosung:4,saftnncnum:4,saftnndbar:4,saftnndbnum:4,saftnndbnumd:4,saftnndbnumk:4,saftnndbnumt:4,saftnnganada:4,saftnngbnum:4,saftnngbnumd:4,saftnngbnumk:4,saftnngbnuml:4,saftnnrlc:4,saftnnruc:4,saftnnzodiac:4,saftnnzodiacd:4,saftnnzodiacl:4,saftnrestart:4,saftnrstcont:4,saftnstart:3,sautoupd:4,saveinvalidxml:4,saveprevpict:4,sb:3,sbasedon:3,sbauto:2,sbkcol:4,sbkeven:4,sbknone:4,sbkodd:4,sbkpage:4,sbys:4,scaps:2,scompose:4,sec:3,sect:1,sectd:4,sectdefaultcl:4,sectexpand:3,sectlinegrid:3,sectnum:1,sectrsid:3,sectspecifycl:4,sectspecifygen:4,sectspecifyl:4,sectunlocked:4,sftnbj:4,sftnnalc:4,sftnnar:4,sftnnauc:4,sftnnchi:4,sftnnchosung:4,sftnncnum:4,sftnndbar:4,sftnndbnum:4,sftnndbnumd:4,sftnndbnumk:4,sftnndbnumt:4,sftnnganada:4,sftnngbnum:4,sftnngbnumd:4,sftnngbnumk:4,sftnngbnuml:4,sftnnrlc:4,sftnnruc:4,sftnnzodiac:4,sftnnzodiacd:4,sftnnzodiacl:4,sftnrestart:4,sftnrstcont:4,sftnrstpg:4,sftnstart:3,sftntj:4,shad:2,shading:3,shidden:4,shift:4,showplaceholdtext:3,showxmlerrors:3,shp:5,shpbottom:3,shpbxcolumn:4,shpbxignore:4,shpbxmargin:4,shpbxpage:4,shpbyignore:4,shpbymargin:4,shpbypage:4,shpbypara:4,shpfblwtxt:3,shpfhdr:3,shpgrp:5,shpinst:5,shpleft:3,shplid:3,shplockanchor:4,shppict:5,shpright:3,shprslt:5,shptop:3,shptxt:5,shpwrk:3,shpwr:3,shpz:3,sl:3,slink:3,slmult:3,slocked:4,sn:5,snaptogridincell:4,snext:3,softcol:4,softlheight:3,softline:4,softpage:4,sp:5,spersonal:4,spltpgpar:4,splytwnine:4,spriority:3,sprsbsp:4,sprslnsp:4,sprsspbf:4,sprstsm:4,sprstsp:4,spv:4,sqformat:4,srauth:3,srdate:3,sreply:4,ssemihidden:3,staticval:5,stextflow:3,strike:2,striked:2,stshfbi:3,stshfdbch:3,stshfhich:3,stshfloch:3,stylelock:4,stylelockbackcomp:4,stylelockenforced:4,stylelockqfset:4,stylelocktheme:4,stylesheet:5,stylesortmethod:3,styrsid:3,sub:4,subdocument:3,subfontbysize:4,subject:5,sunhideused:3,super:4,sv:5,svb:5,swpbdr:4,tab:1,tabsnoovrlp:4,taprtl:4,tb:3,tblind:3,tblindtype:3,tbllkbestfit:4,tbllkborder:4,tbllkcolor:4,tbllkfont:4,tbllkhdrcols:4,tbllkhdrrows:4,tbllklastcol:4,tbllklastrow:4,tbllknocolband:4,tbllknorowband:4,tbllkshading:4,tblrsid:3,tc:5,tcelld:4,tcf:3,tcl:3,tcn:4,tdfrmtxtBottom:3,tdfrmtxtLeft:3,tdfrmtxtRight:3,tdfrmtxtTop:3,template:5,themedata:5,themelang:3,themelangcs:3,themelangfe:3,time:4,title:5,titlepg:4,tldot:4,tleq:4,tlhyph:4,tlmdot:4,tlth:4,tlul:4,toplinepunct:4,tphcol:4,tphmrg:4,tphpg:4,tposnegx:3,tposnegy:3,tposxc:4,tposxi:4,tposxl:4,tposx:3,tposxo:4,tposxr:4,tposy:3,tposyb:4,tposyc:4,tposyil:4,tposyin:4,tposyout:4,tposyt:4,tpvmrg:4,tpvpara:4,tpvpg:4,tqc:4,tqdec:4,tqr:4,trackformatting:3,trackmoves:3,transmf:4,trauth:3,trautofit:2,trbgbdiag:4,trbgcross:4,trbgdcross:4,trbgdkbdiag:4,trbgdkcross:4,trbgdkdcross:4,trbgdkfdiag:4,trbgdkhor:4,trbgdkvert:4,trbgfdiag:4,trbghoriz:4,trbgvert:4,trbrdrb:4,trbrdrh:4,trbrdrl:4,trbrdrr:4,trbrdrt:4,trbrdrv:4,trcbpat:3,trcfpat:3,trdate:3,trftsWidthA:3,trftsWidthB:3,trftsWidth:3,trgaph:3,trhdr:4,trkeep:4,trkeepfollow:4,trleft:3,trowd:4,trpaddb:3,trpaddfb:3,trpaddfl:3,trpaddfr:3,trpaddft:3,trpaddl:3,trpaddr:3,trpaddt:3,trpadob:3,trpadofb:3,trpadofl:3,trpadofr:3,trpadoft:3,trpadol:3,trpador:3,trpadot:3,trpat:3,trqc:4,trql:4,trqr:4,trrh:3,trshdng:3,trspdb:3,trspdfb:3,trspdfl:3,trspdfr:3,trspdft:3,trspdl:3,trspdr:3,trspdt:3,trspob:3,trspofb:3,trspofl:3,trspofr:3,trspoft:3,trspol:3,trspor:3,trspot:3,truncatefontheight:4,truncex:4,trwWidthA:3,trwWidthB:3,trwWidth:3,ts:3,tsbgbdiag:4,tsbgcross:4,tsbgdcross:4,tsbgdkbdiag:4,tsbgdkcross:4,tsbgdkdcross:4,tsbgdkfdiag:4,tsbgdkhor:4,tsbgdkvert:4,tsbgfdiag:4,tsbghoriz:4,tsbgvert:4,tsbrdrb:4,tsbrdrdgl:4,tsbrdrdgr:4,tsbrdrh:4,tsbrdrl:4,tsbrdrr:4,tsbrdrt:4,tsbrdrv:4,tscbandhorzeven:4,tscbandhorzodd:4,tscbandsh:3,tscbandsv:3,tscbandverteven:4,tscbandvertodd:4,tscellcbpat:3,tscellcfpat:3,tscellpaddb:3,tscellpaddfb:3,tscellpaddfl:3,tscellpaddfr:3,tscellpaddft:3,tscellpaddl:3,tscellpaddr:3,tscellpaddt:3,tscellpct:3,tscellwidth:3,tscellwidthfts:3,tscfirstcol:4,tscfirstrow:4,tsclastcol:4,tsclastrow:4,tscnecell:4,tscnwcell:4,tscsecell:4,tscswcell:4,tsd:4,tsnowrap:4,tsrowd:4,tsvertalb:4,tsvertalc:4,tsvertalt:4,twoinone:3,twoonone:4,tx:3,txbxtwalways:4,txbxtwfirst:4,txbxtwfirstlast:4,txbxtwlast:4,txbxtwno:4,txe:5,u:3,uc:3,ud:5,ul:2,ulc:3,uld:4,uldash:2,uldashd:2,uldashdd:2,uldb:2,ulhair:2,ulhwave:2,ulldash:2,ulnone:4,ulth:2,ulthd:2,ulthdash:2,ulthdashd:2,ulthdashdd:2,ulthldash:2,ululdbwave:2,ulw:4,ulwave:2,up:3,upr:5,urtf:3,useltbaln:4,usenormstyforlist:4,userprops:5,usexform:4,utinl:4,v:2,validatexml:3,vern:3,version:3,vertal:4,vertalb:4,vertalc:4,vertalj:4,vertalt:4,vertdoc:4,vertsect:4,viewbksp:3,viewkind:3,viewnobound:4,viewscale:3,viewzk:3,wbitmap:3,wbmbitspixel:3,wbmplanes:3,wbmwidthbytes:3,webhidden:4,wgrffmtfilter:5,widctlpar:4,widowctrl:4,windowcaption:5,wmetafile:3,wpeqn:4,wpjst:4,wpsp:4,wraparound:4,wrapdefault:4,wrapthrough:4,wraptight:4,wraptrsp:4,writereservation:5,writereservhash:5,wrppunct:4,xe:5,xef:3,xform:5,xmlattr:4,xmlattrname:5,xmlattrns:3,xmlattrvalue:5,xmlclose:5,xmlname:5,xmlns:3,xmlnstbl:5,xmlopen:5,xmlsdttcell:4,xmlsdttpara:4,xmlsdttregular:4,xmlsdttrow:4,xmlsdttunknown:4,yr:3,yts:3,yxe:4,zwbo:1,zwj:1,zwnbo:1,zwnj:1}),cr}var cc;function ef(){if(cc)return or;cc=1,Object.defineProperty(or,"__esModule",{value:!0}),or.handleControlsAndDestinations=void 0;const s=Q0();function t(e,n){e.destDepth=(e.destDepth||0)+1,e.destGroupDepth=e.groupDepth,e.allDestinations?e.allDestinations[n]||(e.allDestinations=Object.create(e.allDestinations),e.allDestinations[n]=!0):(e.allDestinations={},e.allDestinations[n]=!0)}const r={2:(e,n)=>{var i;n.word==="*"&&((i=e._lastToken)===null||i===void 0?void 0:i.type)!==0&&e._options.warn('Got control symbol "\\*" but not immediately after "{"');const f=s.words[n.word]||0;f===5?e._lastToken&&e._lastToken.type===0?(e._state.destination=n.word,e._state.destIgnorableImmediate=!1,t(e._state,n.word)):e._lastToken&&e._lastLastToken&&e._lastToken.type===2&&e._lastToken.word==="*"&&e._lastLastToken.type===0?(e._state.destination=n.word,e._state.destIgnorableImmediate=e._state.destIgnorable=!0,t(e._state,n.word)):e._options.warn('Got destination control word but not immediately after "{" or "{\\*": '+n.word):f===0&&e._lastToken&&e._lastLastToken&&e._lastToken.type===2&&e._lastToken.word==="*"&&e._lastLastToken.type===0&&(e._state.destination=n.word,e._state.destIgnorableImmediate=e._state.destIgnorable=!0,t(e._state,n.word))}};return or.handleControlsAndDestinations={tokenHandlers:r,allTokenHandler:(e,n)=>{e._lastLastToken=e._lastToken,e._lastToken=e._currToken,e._currToken=n}},or}var lr={},lc;function tf(){if(lc)return lr;lc=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.handleDeEncapsulation=void 0;function s(e){return e._options.mode==="html"?new Error("Not encapsulated HTML file"):e._options.mode==="text"?new Error("Not encapsulated text file"):new Error("Not encapsulated HTML or text file")}const t=(e,n)=>{if(!e._fromhtml&&!e._fromtext&&(n.type===3||e._count>10))throw s(e);if(e._state.htmlrtf&&e._options.outlookQuirksMode&&(n.type!==2||n.word!=="f"&&n.word!=="htmlrtf"))return!0},r={fromhtml:e=>{if(e._state.destination!=="rtf")throw new Error("\\fromhtml not at root group");if(e._fromhtml!==!1||e._fromtext!==!1)throw new Error("\\fromhtml or \\fromtext already defined");if(e._options.mode!=="html"&&e._options.mode!=="either")throw s(e);return e._fromhtml=!0,e._options.prefix&&e._pushOutput("html:"),!0},fromtext:e=>{if(e._state.destination!=="rtf")throw new Error("\\fromtext not at root group");if(e._fromhtml!==!1||e._fromtext!==!1)throw new Error("\\fromhtml or \\fromtext already defined");if(e._options.mode!=="text"&&e._options.mode!=="either")throw s(e);return e._fromtext=!0,e._options.prefix&&e._pushOutput("text:"),!0},htmlrtf:(e,n)=>{const i=n.param!==0;e._state.htmlrtf=i}};return lr.handleDeEncapsulation={allTokenHandler:t,controlHandlers:r,outputDataFilter:e=>{if(e._state.htmlrtf)return!0;const n=e._state.allDestinations||{},i=!!n.htmltag;if(!i&&e._state.destIgnorable||!i&&(n.fonttbl||n.colortbl||n.stylesheet||n.pntext))return!0},preStreamFlushHandler:e=>{if(!e._fromhtml&&!e._fromtext)throw s(e)}},lr}var ur={},uc;function rf(){if(uc)return ur;uc=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.handleFonts=void 0;const s=Dt(),t={0:1252,2:42,77:1e4,78:10001,79:10003,80:10008,81:10002,83:10005,84:10004,85:10006,86:10081,87:10021,88:10029,89:10007,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,254:437,255:850},r={20127:!0,28591:!0};for(const l in t){const c=t[l];r[c]=!0}const e=(l,c)=>{l._constructingFontTableEntry&&(l._constructingFontTableEntry.themeFont=c.word.slice(1))},n=(l,c)=>{l._constructingFontTableEntry&&(l._constructingFontTableEntry.fontFamily=c.word.slice(1))},i={0:l=>{l._constructingFontTable&&l._state.destination==="fonttbl"&&l._state.groupDepth===l._state.destGroupDepth+1&&(l._constructingFontTableEntry={})},1:l=>{if(l._constructingFontTable&&l._state.destination==="fonttbl"&&l._state.groupDepth===l._state.destGroupDepth){if(!l._constructingFontTableEntry||!l._constructingFontTableKey)throw new Error("Finished a font table group but no key?");l._fonttbl[l._constructingFontTableKey]=l._constructingFontTableEntry,l._constructingFontTableEntry=void 0,l._constructingFontTableKey=void 0}l._constructingFontTable&&l._state.destGroupDepth===1&&(l._constructingFontTable=!1)}},f={deff:(l,c)=>{if(!(l._state.destination==="rtf"&&l._state.destDepth>1&&typeof l._deff<"u")){if(l._state.destination!=="rtf"||l._state.destDepth!==1)throw new Error("\\deff not at root group");if(typeof l._deff<"u")throw new Error("\\deff already defined");l._deff=c.param+""}},fonttbl:l=>{if(l._fonttbl&&l._state.destGroupDepth>2){l._options.warn("Got additional \\fonttbl");return}if(l._fonttbl)throw new Error("fonttbl already created");if(l._state.destDepth!==2||l._state.destGroupDepth!==2)throw new Error("fonttbl not in header");l._constructingFontTable=!0,l._fonttbl={}},f:(l,c)=>{if(typeof c.param>"u")throw new Error("No param for \\f");const o=c.param+"";if(l._constructingFontTableEntry&&l._constructingFontTableKey)throw new Error("\\f control word in font group which already has \\f");l._constructingFontTableEntry?l._constructingFontTableKey=o:l._state.font=o},fcharset:(l,c)=>{if(l._constructingFontTableEntry){if(!s.isNum(c.param))throw new Error("fcharset with no param");if(c.param!==1){let o=t[c.param];!s.isNum(o)&&r[c.param]&&(o=c.param),s.isNum(o)?l._constructingFontTableEntry.fcharsetCpg=o:l._options.warn("No codepage for charset "+c.param)}}},cpg:(l,c)=>{if(!l._constructingFontTableEntry)return;const o=c.param;s.isNum(o)?l._constructingFontTableEntry.cpg=o:l._options.warn("No codepage given")},flomajor:e,fhimajor:e,fdbmajor:e,fbimajor:e,flominor:e,fhiminor:e,fdbminor:e,fbiminor:e,fnil:n,froman:n,fswiss:n,fmodern:n,fscript:n,fdecor:n,ftech:n,fbidi:n},a=(l,c)=>{if(l._constructingFontTableEntry){s.isStr(c)||(c=c.toString("latin1")),c=c.replace(/[^\x00-\x7F]/g,d=>{const u=d.charCodeAt(0).toString(16).toUpperCase();return"\\u"+"0000".slice(0,4-u.length)+u});let o=(l._constructingFontTableEntry.fontName||"")+c;return o.endsWith(";")&&(o=o.substr(0,o.length-1),o.length>2&&o.startsWith('"')&&o.endsWith('"')&&(o=o.substr(1,o.length-2))),l._constructingFontTableEntry.fontName=o,!0}};return ur.handleFonts={tokenHandlers:i,controlHandlers:f,outputDataFilter:a},ur}var fr={},fc;function nf(){if(fc)return fr;fc=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.handleGroupState=void 0;const s=(r,e)=>{if(r._done)return e.type===3&&e.data.length===1&&e.data[0]===0||r._options.warn("Additional tokens after final closing bracket"),!0},t={0:r=>{const e=r._state,n=Object.create(e);++n.groupDepth,r._state=n},1:r=>{r._state=Object.getPrototypeOf(r._state),r._state===r._rootState&&(r._done=!0)}};return fr.handleGroupState={allTokenHandler:s,tokenHandlers:t,preStreamFlushHandler:r=>{r._state!==r._rootState&&r._options.warn("Not enough matching closing brackets")}},fr}var dr={},dc;function af(){if(dc)return dr;dc=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.handleOutput=void 0;const s=Dt();function t(i){if(i._bufferedUnicodeOutput){const f=i._bufferedUnicodeOutput.join("");i._pushOutput(f),delete i._bufferedUnicodeOutput}i._bufferedBinaryOutput&&(i._pushOutput(ot.concat(i._bufferedBinaryOutput)),delete i._bufferedBinaryOutput)}const r=(i,f)=>{(i._bufferedUnicodeOutput&&(f.type!==2||f.word!=="uc"&&f.word!=="u")||i._bufferedBinaryOutput&&(f.type!==2||f.word!=="'"))&&t(i)},e={3:(i,f)=>{t(i),i._pushOutput(f.data)}},n={u:(i,f)=>{if(!s.isNum(f.param))throw new Error("Unicode control word with no param");const a=f.param<0?String.fromCodePoint(f.param+65536):String.fromCodePoint(f.param);i._bufferedUnicodeOutput=i._bufferedUnicodeOutput||[],i._bufferedUnicodeOutput.push(a)},"'":(i,f)=>{i._bufferedBinaryOutput=i._bufferedBinaryOutput||[],i._bufferedBinaryOutput.push(f.data)}};return dr.handleOutput={allTokenHandler:r,tokenHandlers:e,controlHandlers:n},dr}var hr={},hc;function sf(){if(hc)return hr;hc=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.handleUnicodeSkip=void 0;const s=(r,e)=>{switch(e.type){case 0:case 1:r._skip=0;break;case 2:if(r._skip>0)return r._skip--,!0;break;case 3:if(r._skip>=e.data.length)return r._skip-=e.data.length,!0;r._skip>0&&(e.data=e.data.slice(r._skip),r._skip=0);break}},t={uc:(r,e)=>{r._state.uc=e.param||0},u:r=>{r._skip=r._state.uc}};return hr.handleUnicodeSkip={allTokenHandler:s,controlHandlers:t},hr}var pr={},pc;function of(){return pc||(pc=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.handleTextEscapes=void 0,pr.handleTextEscapes={controlHandlers:{par:s=>s._pushOutput(`\r
`),line:s=>s._pushOutput(`\r
`),tab:s=>s._pushOutput("	"),lquote:s=>s._pushOutput(""),rquote:s=>s._pushOutput(""),ldblquote:s=>s._pushOutput(""),rdblquote:s=>s._pushOutput(""),bullet:s=>s._pushOutput(""),endash:s=>s._pushOutput(""),emdash:s=>s._pushOutput(""),"{":s=>s._pushOutput("{"),"}":s=>s._pushOutput("}"),"\\":s=>s._pushOutput("\\"),"~":s=>s._pushOutput(""),_:s=>s._pushOutput("")}}),pr}var Yi={},Ki={},mc;function cf(){return mc||(mc=1,(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.recodeSymbolFontText=s.fontToUnicode=void 0;const t=Dt();s.fontToUnicode={Wingdings:[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,128393,9986,9985,128083,128365,128366,128367,128383,9990,128386,128387,128234,128235,128236,128237,128193,128194,128196,128463,128464,128452,8987,128430,128432,128434,128435,128436,128427,128428,9991,9997,128398,9996,128076,128077,128078,9756,9758,9757,9759,128400,9786,128528,9785,128163,9760,127987,127985,9992,9788,128167,10052,128326,10014,128328,10016,10017,9770,9775,2384,9784,9800,9801,9802,9803,9804,9805,9806,9807,9808,9809,9810,9811,128624,128629,9679,128318,9632,9633,128912,10065,10066,11047,10731,9670,10070,11045,8999,11193,8984,127989,127990,128630,128631,32,9450,9312,9313,9314,9315,9316,9317,9318,9319,9320,9321,9471,10102,10103,10104,10105,10106,10107,10108,10109,10110,10111,128610,128608,128609,128611,128606,128604,128605,128607,183,8226,9642,9898,128902,128904,9673,9678,128319,9642,9723,128962,10022,9733,10038,10036,10041,10037,11216,8982,10209,8977,11217,10026,10032,128336,128337,128338,128339,128340,128341,128342,128343,128344,128345,128346,128347,11184,11185,11186,11187,11188,11189,11190,11191,128618,128619,128597,128596,128599,128598,128592,128593,128594,128595,9003,8998,11160,11162,11161,11163,11144,11146,11145,11147,129128,129130,129129,129131,129132,129133,129135,129134,129144,129146,129145,129147,129148,129149,129151,129150,8678,8680,8679,8681,11012,8691,11008,11009,11011,11010,129196,129197,128502,10004,128503,128505,8862],"Wingdings 2":[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,128394,128395,128396,128397,9988,9984,128382,128381,128453,128454,128455,128456,128457,128458,128459,128460,128461,128203,128465,128468,128437,128438,128439,128440,128429,128431,128433,128402,128403,128408,128409,128410,128411,128072,128073,128412,128413,128414,128415,128416,128417,128070,128071,128418,128419,128401,128500,10003,128501,9745,9746,9746,11198,11199,10680,10680,128625,128628,128626,128627,8253,128633,128634,128635,128614,128612,128613,128615,128602,128600,128601,128603,9450,9312,9313,9314,9315,9316,9317,9318,9319,9320,9321,9471,10102,10103,10104,10105,10106,10107,10108,10109,10110,10111,32,9737,127765,9789,9790,11839,10013,128327,128348,128349,128350,128351,128352,128353,128354,128355,128356,128357,128358,128359,128616,128617,8226,9679,9899,11044,128901,128902,128903,128904,128906,10687,9726,9632,9724,11035,11036,128913,128914,128915,128916,9635,128917,128918,128919,11049,11045,9670,9671,128922,9672,128923,128924,128925,11050,11047,10731,9674,128928,9686,9687,11210,11211,9724,11045,11039,11202,11043,11042,11203,11204,128929,128930,128931,128932,128933,128934,128935,128936,128937,128938,128939,128940,128941,128942,128943,128944,128945,128946,128947,128948,128949,128950,128951,128952,128953,128954,128955,128956,128957,128958,128959,128960,128962,128964,10022,128969,9733,10038,128971,10039,128975,128978,10041,128963,128967,10031,128973,128980,11212,11213,8251,8258,32,32,32,32,32,32],"Wingdings 3":[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,11104,11106,11105,11107,11110,11111,11113,11112,11120,11122,11121,11123,11126,11128,11131,11133,11108,11109,11114,11116,11115,11117,11085,11168,11169,11170,11171,11172,11173,11174,11175,11152,11153,11154,11155,11136,11139,11134,11135,11140,11142,11141,11143,11151,11149,11150,11148,11118,11119,9099,8996,8963,8997,9141,9085,8682,11192,129184,129185,129186,129187,129188,129189,129190,129191,129192,129193,129194,129195,8592,8594,8593,8595,8598,8599,8601,8600,129112,129113,9650,9660,9651,9661,9668,9658,9665,9655,9699,9698,9700,9701,128896,128898,128897,32,128899,9650,9660,9664,9654,11164,11166,11165,11167,129040,129042,129041,129043,129044,129046,129045,129047,129048,129050,129049,129051,129052,129054,129053,129055,129024,129026,129025,129027,129028,129030,129029,129031,129032,129034,129033,129035,129056,129058,129060,129062,129064,129066,129068,129180,129181,129182,129183,129070,129072,129074,129076,129078,129080,129082,129081,129083,129176,129178,129177,129179,129084,129086,129085,129087,129088,129090,129089,129091,129092,129094,129093,129095,11176,11177,11178,11179,11180,11181,11182,11183,129120,129122,129121,129123,129124,129125,129127,129126,129136,129138,129137,129139,129140,129141,129143,129142,129152,129154,129153,129155,129156,129157,129159,129158,129168,129170,129169,129171,129172,129174,129173,129175,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],Webdings:[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,128375,128376,128370,128374,127942,127894,128391,128488,128489,128496,128497,127798,127895,128638,128636,128469,128470,128471,9204,9205,9206,9207,9194,9193,9198,9197,9208,9209,9210,128474,128499,128736,127959,127960,127961,127962,127964,127981,127963,127968,127958,127965,128739,128269,127956,128065,128066,127966,127957,128740,127967,128755,128364,128363,128360,128264,127892,127893,128492,128637,128493,128490,128491,11156,10004,128690,11036,128737,127873,128753,11035,128657,128712,128745,128752,128968,128372,11044,128741,128660,128472,128473,10067,128754,128647,128653,128681,10680,8854,128685,128494,9168,128495,128498,9647,128697,128698,128713,128714,128700,128125,127947,9975,127938,127948,127946,127940,127949,127950,128664,128200,128738,128176,127991,128179,128106,128481,128482,128483,10031,128388,128389,128387,128390,128441,128442,128443,128373,128368,128445,128446,128203,128466,128467,128366,128218,128478,128479,128451,128199,128444,127917,127900,127896,127897,127911,128191,127902,128247,127903,127916,128253,128249,128254,128251,127898,127899,128250,128187,128421,128422,128423,128377,127918,128379,128380,128223,128385,128384,128424,128425,128447,128426,128476,128274,128275,128477,128229,128228,128371,127779,127780,127781,127782,9729,127784,127783,127785,127786,127788,127787,127772,127777,128715,128719,127869,127864,128718,128717,9413,9855,128710,128392,127891,128484,128485,128486,128487,128746,128063,128038,128031,128021,128008,128620,128622,128621,128623,128506,127757,127759,127758,128330],Symbol:"                                 !#%&()+,./0123456789:;<=>?[]_{|}                                   "};function r(e,n,i="?"){const f=s.fontToUnicode[n];if(f){const a=[];for(const l of e){const c=l.codePointAt(0),o=f[c];t.isDef(o)?a.push(t.isStr(o)?o:String.fromCodePoint(o)):i==="keep"?a.push(l):i==="?"&&a.push("?")}return a.join("")}}s.recodeSymbolFontText=r})(Ki)),Ki}var gc;function lf(){return gc||(gc=1,(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.ProcessTokens=s.procTokensDefaultOptions=void 0;const t=Qr(),r=cf(),e=Dt(),n=(c,o)=>c.toString(o),i=(c,o)=>ot.from(c,o);s.procTokensDefaultOptions={decode:n,encode:i,outputMode:"string",replaceSymbolFontChars:!1,warn:console.warn};const f={Wingdings:!0,"Wingdings 2":!0,"Wingdings 3":!0,Webdings:!0,Symbol:!0};function a(c){return!!c&&(c.fcharsetCpg===42||c.cpg===42||f[c.fontName||""]===!0)}class l extends t.Transform{constructor(o){super({writableObjectMode:!0,readableObjectMode:!0}),this._rootState={uc:1,groupDepth:0,destDepth:0,destGroupDepth:0},this._state=this._rootState,this._cpg=1252,this._count=0,this._lastLastToken=null,this._lastToken=null,this._currToken=null,this._done=!1,this._ansicpg=!1,this._skip=0,this._options=Object.assign(Object.assign({},s.procTokensDefaultOptions),o),this._pushOutput=this._pushOutput.bind(this)}get defaultCodepage(){return this._cpg}_getOutputAsString(o,d){let u,h=!1;if(d&&a(d)){const v=[];if(e.isStr(o))for(const _ of o){const E=_.codePointAt(0);E>=0&&E<=255||E>=61440&&E<=61695?v.push(String.fromCodePoint(E%61440)):v.push(String.fromCodePoint(E))}else v.push(o.toString("latin1"));const w=v.join(""),A=d.fontName;A&&(this._options.replaceSymbolFontChars===!0||this._options.replaceSymbolFontChars&&this._options.replaceSymbolFontChars[A])?u=r.recodeSymbolFontText(w,A,"keep")||"":(u=w,h=!0)}else if(e.isStr(o))u=o;else{const v=d?d.cpg||d.fcharsetCpg||this._cpg:this._cpg;if(v===20127||v===65001)u=o.toString("utf8");else if(v===1200)u=o.toString("utf16le");else if(v||this._options.allowCp0)u=this._options.decode(o,"cp"+v);else throw new Error("text with no codepage")}return[u,h]}_pushOutputData(o,d){if(this._options.outputMode==="buffer-utf8")this.push(ot.from(o,"utf8"));else if(this._options.outputMode==="buffer-default-cpg"&&this._options.encode)if(this._cpg===20127||this._cpg===65001)this.push(ot.from(o,"utf8"));else if(this._cpg===1200)this.push(ot.from(o,"utf16le"));else if(d){const u=[];for(const h of o){const v=h.charCodeAt(0);v>255?u.push(32):u.push(v)}this.push(ot.from(u))}else try{const u=this._options.encode(o,"cp"+this._cpg);this.push(u)}catch{this._options.warn("Unable to encode to cp"+this._cpg)}else this.push(o)}_getCurrentFont(){const d=this._state.font||this._deff||"";return this._fonttbl&&this._fonttbl[d]}_pushOutput(o){for(const v of this._featureHandlers)if(v.outputDataFilter&&v.outputDataFilter(this,o))return;const d=this._getCurrentFont(),[u,h]=this._getOutputAsString(o,d);this._pushOutputData(u,h)}_handleToken(o){try{for(const d of this._featureHandlers)if(d.allTokenHandler&&d.allTokenHandler(this,o))return;for(const d of this._featureHandlers)if(d.tokenHandlers){const u=d.tokenHandlers[o.type];if(u&&u(this,o))return}if(o.type===2){for(const d of this._featureHandlers)if(d.controlHandlers&&d.controlHandlers[o.word]&&d.controlHandlers[o.word](this,o))return}}catch(d){return d}}_transform(o,d,u){const h=this._handleToken(o);u(h)}_flush(o){let d;try{for(const u of this._featureHandlers)u.preStreamFlushHandler&&u.preStreamFlushHandler(this)}catch(u){d=u}o(d)}}s.ProcessTokens=l})(Yi)),Yi}var bc;function uf(){if(bc)return Ht;bc=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.DeEncapsulate=void 0;const s=Z0(),t=X0(),r=J0(),e=ef(),n=tf(),i=rf(),f=nf(),a=af(),l=sf(),c=of(),o=lf(),d={htmlEncodeNonAscii:!1,htmlFixContentType:!1,htmlPreserveSpaces:!1,mode:"either",prefix:!1,outlookQuirksMode:!1};function u(w){const A=[];let _=!0;for(const x of w){const g=x.codePointAt(0);g===160?(_=!1,A.push("&nbsp;")):g>127?(_=!1,A.push("&#x"+g.toString(16)+";")):A.push(x)}return _?w:A.join("")}const h=/(\bcharset=)([\w-]+)(")/i;class v extends o.ProcessTokens{constructor(A){super(A),this._featureHandlers=[t.countTokens,s.checkVersion,f.handleGroupState,l.handleUnicodeSkip,e.handleControlsAndDestinations,r.handleCharacterSet,i.handleFonts,n.handleDeEncapsulation,a.handleOutput,c.handleTextEscapes],this._rootState={uc:1,groupDepth:0,destDepth:0,destGroupDepth:0},this._state=this._rootState,this._fromhtml=!1,this._fromtext=!1,this._didHtmlCharsetReplace=!1,this._options=Object.assign(Object.assign(Object.assign({},o.procTokensDefaultOptions),d),A)}get isHtml(){return this._fromhtml}get isText(){return this._fromtext}get originalHtmlCharset(){return this._originalHtmlCharset}_getOutputAsString(A,_){var E;let[x,g]=super._getOutputAsString(A,_);return this._fromhtml&&(!!(!((E=this._state.allDestinations)===null||E===void 0)&&E.htmltag)?this._options.htmlFixContentType&&!this._didHtmlCharsetReplace&&(x=x.replace(h,(B,k,D,$)=>(this._didHtmlCharsetReplace=!0,this._originalHtmlCharset=D,k+"UTF-8"+$))):(x=x.replace(/<|>/g,B=>B==="<"?"&lt;":"&gt;"),this._options.htmlPreserveSpaces&&(x===" "?x="":x=x.replace(/  +/g,B=>" "+"".repeat(B.length-1)).replace(/^ +/,B=>"".repeat(B.length)).replace(/ +$/,B=>"".repeat(B.length))),this._options.htmlEncodeNonAscii&&(x=u(x)))),[x,g]}_getCurrentFont(){return!!(this._state.allDestinations||{}).htmltag?void 0:super._getCurrentFont()}}return Ht.DeEncapsulate=v,Ht.default=v,Ht}var Mt={},yc;function ff(){if(yc)return Mt;yc=1;var s=Mt&&Mt.__awaiter||function(r,e,n,i){function f(a){return a instanceof n?a:new n(function(l){l(a)})}return new(n||(n=Promise))(function(a,l){function c(u){try{d(i.next(u))}catch(h){l(h)}}function o(u){try{d(i.throw(u))}catch(h){l(h)}}function d(u){u.done?a(u.value):f(u.value).then(c,o)}d((i=i.apply(r,e||[])).next())})};Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.streamFlow=void 0;function t(r,...e){return s(this,void 0,void 0,function*(){return new Promise((n,i)=>{const f=c=>{r.unpipe();for(let o=1;o<e.length;o++)e[o-1].unpipe();i(c)};e.length&&r.pipe(e[0]);for(let c=1;c<e.length;c++)e[c-1].pipe(e[c]);r.on("error",f);for(let c=0;c<e.length;c++)e[c].on("error",f);const a=e.length?e[e.length-1]:r,l=[];a.on("readable",()=>{for(;;){const c=a.read();if(c===null)break;l.push(c)}}),a.on("end",()=>n(l))})})}return Mt.streamFlow=t,Mt}var jt={},vc;function df(){if(vc)return jt;vc=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.Tokenize=void 0;const s=Qr(),t=Dt(),r=i=>i>64&&i<91||i>96&&i<123,e=i=>i>47&&i<58;class n extends s.Transform{constructor(){super({readableObjectMode:!0}),this._expectedBinaryBytes=0,this._readHexDigitsCount=0,this._paramStr="",this._mode=0}_flushToken(){const f=this._token;if(f){this._paramStr&&(f.param=Number.parseInt(this._paramStr,10));const a=f.data;a&&(a.length>(f.length||0)&&(f.data=a.slice(0,f.length)),delete f.length),this.push(f)}this._token=null,this._readHexDigitsCount=0,this._paramStr="",this._mode=0}_handleSpecialOrPush(){const f=this._token,a=parseInt(this._paramStr||"0",10)||0;f.type===2&&f.word==="bin"&&a>0?(this._mode=4,f.data=ot.alloc(a),f.length=0):f.type===2&&f.word==="'"?(this._mode=5,f.data=ot.alloc(1),f.length=0,this._readHexDigitsCount=0):this._flushToken()}_transform(f,a,l){try{this.__transform(f,a)}catch(c){return l(c)}l()}__transform(f,a){const l=t.isStr(f)?ot.from(f,a):f,c=l.toString("binary"),o=l.length;for(let d=0;d<o;d++){const u=l[d];switch(this._mode){case 4:{const h=this._token;h.data&&t.isNum(h.length)&&(h.data[h.length++]=u),(!t.isNum(h.length)||!h.data||h.length>=h.data.length)&&this._flushToken();break}case 5:{const h=this._token,v=parseInt(String.fromCharCode(u),16);isNaN(v)||!h.data?console.warn("Bad hex digit"):this._readHexDigitsCount===0?h.data[0]+=v*16:h.data[0]+=v,this._readHexDigitsCount++,this._readHexDigitsCount===2&&(h.length=1,this._flushToken());break}case 1:{r(u)?(this._mode=2,this._token={type:2,word:String.fromCharCode(u)}):(this._token={type:2,word:String.fromCharCode(u)},this._handleSpecialOrPush());break}case 2:{const h=this._token;if(r(u))h.word+=String.fromCharCode(u);else if(e(u)||u===45)this._mode=3,this._paramStr=String.fromCharCode(u);else{this._handleSpecialOrPush(),u!==32&&(d-=1);continue}break}case 3:{if(e(u))this._paramStr+=String.fromCharCode(u);else{this._handleSpecialOrPush(),u!==32&&(d-=1);continue}break}case 0:{switch(u){case 123:this._flushToken(),this.push({type:0});break;case 125:this._flushToken(),this.push({type:1});break;case 92:this._flushToken(),this._mode=1;break;case 13:case 10:break;default:{const h=d,v=/[\r\n{}\\]/g;v.lastIndex=d;const w=v.exec(c),A=w?w.index:o,_=l.slice(h,A),E=this._token;if(!E)this._token={type:3,data:_,length:_.length},d=A-1;else if(E&&E.type===3)E.length+=_.length,E.data=ot.concat([E.data,_],E.length),d=A-1;else throw new Error("Unpushed token!")}}break}default:throw new Error("Unknown state!")}}}_flush(f){this._flushToken(),f()}}return jt.Tokenize=n,jt.default=n,jt}var wc;function hf(){return wc||(wc=1,(function(s){var t=nr&&nr.__awaiter||function(l,c,o,d){function u(h){return h instanceof o?h:new o(function(v){v(h)})}return new(o||(o=Promise))(function(h,v){function w(E){try{_(d.next(E))}catch(x){v(x)}}function A(E){try{_(d.throw(E))}catch(x){v(x)}}function _(E){E.done?h(E.value):u(E.value).then(w,A)}_((d=d.apply(l,c||[])).next())})};Object.defineProperty(s,"__esModule",{value:!0}),s.deEncapsulateStream=s.deEncapsulateSync=s.DeEncapsulate=s.Tokenize=void 0;const r=uf();Object.defineProperty(s,"DeEncapsulate",{enumerable:!0,get:function(){return r.DeEncapsulate}});const e=ff(),n=df();Object.defineProperty(s,"Tokenize",{enumerable:!0,get:function(){return n.Tokenize}});const i=Dt();function f(l,c){const o=w=>{if(i.isDef(w))throw w},d=new n.Tokenize,u=new r.DeEncapsulate(c);d.push=w=>(u._transform(w,"",o),!0);const h=[];u.push=w=>(h.push(w),!0),d._transform(l,void 0,o),d._flush(o),u._flush(o);const v=!c||!c.outputMode||c.outputMode==="string"?h.join(""):ot.concat(h);return{mode:u.isHtml?"html":"text",text:v}}s.deEncapsulateSync=f;function a(l,c){return t(this,void 0,void 0,function*(){const o=new n.Tokenize,d=new r.DeEncapsulate(c),u=yield e.streamFlow(l,o,d),h=!c||!c.outputMode||c.outputMode==="string"?u.join(""):ot.concat(u);return{mode:d.isHtml?"html":"text",text:h}})}s.deEncapsulateStream=a})(nr)),nr}var pf=hf(),Zi={exports:{}},Hr={},xc;function mf(){if(xc)return Hr;xc=1;var s="\uFEFF";Hr.PrependBOM=t;function t(e,n){this.encoder=e,this.addBOM=!0}t.prototype.write=function(e){return this.addBOM&&(e=s+e,this.addBOM=!1),this.encoder.write(e)},t.prototype.end=function(){return this.encoder.end()},Hr.StripBOM=r;function r(e,n){this.decoder=e,this.pass=!1,this.options=n||{}}return r.prototype.write=function(e){var n=this.decoder.write(e);return this.pass||!n||(n[0]===s&&(n=n.slice(1),typeof this.options.stripBOM=="function"&&this.options.stripBOM()),this.pass=!0),n},r.prototype.end=function(){return this.decoder.end()},Hr}var Xi,Ec;function pl(){if(Ec)return Xi;Ec=1;var s=typeof Object.hasOwn>"u"?Function.call.bind(Object.prototype.hasOwnProperty):Object.hasOwn;function t(r,e){for(var n in e)s(e,n)&&(r[n]=e[n])}return Xi=t,Xi}var Ji={},Qi,_c;function gf(){if(_c)return Qi;_c=1;var s=Ze().Buffer;Qi={utf8:{type:"_internal",bomAware:!0},cesu8:{type:"_internal",bomAware:!0},unicode11utf8:"utf8",ucs2:{type:"_internal",bomAware:!0},utf16le:"ucs2",binary:{type:"_internal"},base64:{type:"_internal"},hex:{type:"_internal"},_internal:t};function t(c,o){this.enc=c.encodingName,this.bomAware=c.bomAware,this.enc==="base64"?this.encoder=i:this.enc==="utf8"?this.encoder=l:this.enc==="cesu8"&&(this.enc="utf8",this.encoder=f,s.from("eda0bdedb2a9","hex").toString()!==""&&(this.decoder=a,this.defaultCharUnicode=o.defaultCharUnicode))}t.prototype.encoder=n,t.prototype.decoder=e;var r=Vr().StringDecoder;function e(c,o){this.decoder=new r(o.enc)}e.prototype.write=function(c){return s.isBuffer(c)||(c=s.from(c)),this.decoder.write(c)},e.prototype.end=function(){return this.decoder.end()};function n(c,o){this.enc=o.enc}n.prototype.write=function(c){return s.from(c,this.enc)},n.prototype.end=function(){};function i(c,o){this.prevStr=""}i.prototype.write=function(c){c=this.prevStr+c;var o=c.length-c.length%4;return this.prevStr=c.slice(o),c=c.slice(0,o),s.from(c,"base64")},i.prototype.end=function(){return s.from(this.prevStr,"base64")};function f(c,o){}f.prototype.write=function(c){for(var o=s.alloc(c.length*3),d=0,u=0;u<c.length;u++){var h=c.charCodeAt(u);h<128?o[d++]=h:h<2048?(o[d++]=192+(h>>>6),o[d++]=128+(h&63)):(o[d++]=224+(h>>>12),o[d++]=128+(h>>>6&63),o[d++]=128+(h&63))}return o.slice(0,d)},f.prototype.end=function(){};function a(c,o){this.acc=0,this.contBytes=0,this.accBytes=0,this.defaultCharUnicode=o.defaultCharUnicode}a.prototype.write=function(c){for(var o=this.acc,d=this.contBytes,u=this.accBytes,h="",v=0;v<c.length;v++){var w=c[v];(w&192)!==128?(d>0&&(h+=this.defaultCharUnicode,d=0),w<128?h+=String.fromCharCode(w):w<224?(o=w&31,d=1,u=1):w<240?(o=w&15,d=2,u=1):h+=this.defaultCharUnicode):d>0?(o=o<<6|w&63,d--,u++,d===0&&(u===2&&o<128&&o>0?h+=this.defaultCharUnicode:u===3&&o<2048?h+=this.defaultCharUnicode:h+=String.fromCharCode(o))):h+=this.defaultCharUnicode}return this.acc=o,this.contBytes=d,this.accBytes=u,h},a.prototype.end=function(){var c=0;return this.contBytes>0&&(c+=this.defaultCharUnicode),c};function l(c,o){this.highSurrogate=""}return l.prototype.write=function(c){if(this.highSurrogate&&(c=this.highSurrogate+c,this.highSurrogate=""),c.length>0){var o=c.charCodeAt(c.length-1);o>=55296&&o<56320&&(this.highSurrogate=c[c.length-1],c=c.slice(0,c.length-1))}return s.from(c,this.enc)},l.prototype.end=function(){if(this.highSurrogate){var c=this.highSurrogate;return this.highSurrogate="",s.from(c,this.enc)}},Qi}var _t={},Ac;function bf(){if(Ac)return _t;Ac=1;var s=Ze().Buffer;_t._utf32=t;function t(c,o){this.iconv=o,this.bomAware=!0,this.isLE=c.isLE}_t.utf32le={type:"_utf32",isLE:!0},_t.utf32be={type:"_utf32",isLE:!1},_t.ucs4le="utf32le",_t.ucs4be="utf32be",t.prototype.encoder=r,t.prototype.decoder=e;function r(c,o){this.isLE=o.isLE,this.highSurrogate=0}r.prototype.write=function(c){for(var o=s.from(c,"ucs2"),d=s.alloc(o.length*2),u=this.isLE?d.writeUInt32LE:d.writeUInt32BE,h=0,v=0;v<o.length;v+=2){var w=o.readUInt16LE(v),A=w>=55296&&w<56320,_=w>=56320&&w<57344;if(this.highSurrogate)if(A||!_)u.call(d,this.highSurrogate,h),h+=4;else{var E=(this.highSurrogate-55296<<10|w-56320)+65536;u.call(d,E,h),h+=4,this.highSurrogate=0;continue}A?this.highSurrogate=w:(u.call(d,w,h),h+=4,this.highSurrogate=0)}return h<d.length&&(d=d.slice(0,h)),d},r.prototype.end=function(){if(this.highSurrogate){var c=s.alloc(4);return this.isLE?c.writeUInt32LE(this.highSurrogate,0):c.writeUInt32BE(this.highSurrogate,0),this.highSurrogate=0,c}};function e(c,o){this.isLE=o.isLE,this.badChar=o.iconv.defaultCharUnicode.charCodeAt(0),this.overflow=[]}e.prototype.write=function(c){if(c.length===0)return"";var o=0,d=0,u=s.alloc(c.length+4),h=0,v=this.isLE,w=this.overflow,A=this.badChar;if(w.length>0){for(;o<c.length&&w.length<4;o++)w.push(c[o]);w.length===4&&(v?d=w[o]|w[o+1]<<8|w[o+2]<<16|w[o+3]<<24:d=w[o+3]|w[o+2]<<8|w[o+1]<<16|w[o]<<24,w.length=0,h=n(u,h,d,A))}for(;o<c.length-3;o+=4)v?d=c[o]|c[o+1]<<8|c[o+2]<<16|c[o+3]<<24:d=c[o+3]|c[o+2]<<8|c[o+1]<<16|c[o]<<24,h=n(u,h,d,A);for(;o<c.length;o++)w.push(c[o]);return u.slice(0,h).toString("ucs2")};function n(c,o,d,u){if((d<0||d>1114111)&&(d=u),d>=65536){d-=65536;var h=55296|d>>10;c[o++]=h&255,c[o++]=h>>8;var d=56320|d&1023}return c[o++]=d&255,c[o++]=d>>8,o}e.prototype.end=function(){this.overflow.length=0},_t.utf32=i,_t.ucs4="utf32";function i(c,o){this.iconv=o}i.prototype.encoder=f,i.prototype.decoder=a;function f(c,o){c=c||{},c.addBOM===void 0&&(c.addBOM=!0),this.encoder=o.iconv.getEncoder(c.defaultEncoding||"utf-32le",c)}f.prototype.write=function(c){return this.encoder.write(c)},f.prototype.end=function(){return this.encoder.end()};function a(c,o){this.decoder=null,this.initialBufs=[],this.initialBufsLen=0,this.options=c||{},this.iconv=o.iconv}a.prototype.write=function(c){if(!this.decoder){if(this.initialBufs.push(c),this.initialBufsLen+=c.length,this.initialBufsLen<32)return"";var o=l(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(o,this.options);for(var d="",u=0;u<this.initialBufs.length;u++)d+=this.decoder.write(this.initialBufs[u]);return this.initialBufs.length=this.initialBufsLen=0,d}return this.decoder.write(c)},a.prototype.end=function(){if(!this.decoder){var c=l(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(c,this.options);for(var o="",d=0;d<this.initialBufs.length;d++)o+=this.decoder.write(this.initialBufs[d]);var u=this.decoder.end();return u&&(o+=u),this.initialBufs.length=this.initialBufsLen=0,o}return this.decoder.end()};function l(c,o){var d=[],u=0,h=0,v=0,w=0,A=0;e:for(var _=0;_<c.length;_++)for(var E=c[_],x=0;x<E.length;x++)if(d.push(E[x]),d.length===4){if(u===0){if(d[0]===255&&d[1]===254&&d[2]===0&&d[3]===0)return"utf-32le";if(d[0]===0&&d[1]===0&&d[2]===254&&d[3]===255)return"utf-32be"}if((d[0]!==0||d[1]>16)&&v++,(d[3]!==0||d[2]>16)&&h++,d[0]===0&&d[1]===0&&(d[2]!==0||d[3]!==0)&&A++,(d[0]!==0||d[1]!==0)&&d[2]===0&&d[3]===0&&w++,d.length=0,u++,u>=100)break e}return A-v>w-h?"utf-32be":A-v<w-h?"utf-32le":o||"utf-32le"}return _t}var jr={},Sc;function yf(){if(Sc)return jr;Sc=1;var s=Ze().Buffer;jr.utf16be=t;function t(){}t.prototype.encoder=r,t.prototype.decoder=e,t.prototype.bomAware=!0;function r(){}r.prototype.write=function(l){for(var c=s.from(l,"ucs2"),o=0;o<c.length;o+=2){var d=c[o];c[o]=c[o+1],c[o+1]=d}return c},r.prototype.end=function(){};function e(){this.overflowByte=-1}e.prototype.write=function(l){if(l.length==0)return"";var c=s.alloc(l.length+1),o=0,d=0;for(this.overflowByte!==-1&&(c[0]=l[0],c[1]=this.overflowByte,o=1,d=2);o<l.length-1;o+=2,d+=2)c[d]=l[o+1],c[d+1]=l[o];return this.overflowByte=o==l.length-1?l[l.length-1]:-1,c.slice(0,d).toString("ucs2")},e.prototype.end=function(){this.overflowByte=-1},jr.utf16=n;function n(l,c){this.iconv=c}n.prototype.encoder=i,n.prototype.decoder=f;function i(l,c){l=l||{},l.addBOM===void 0&&(l.addBOM=!0),this.encoder=c.iconv.getEncoder("utf-16le",l)}i.prototype.write=function(l){return this.encoder.write(l)},i.prototype.end=function(){return this.encoder.end()};function f(l,c){this.decoder=null,this.initialBufs=[],this.initialBufsLen=0,this.options=l||{},this.iconv=c.iconv}f.prototype.write=function(l){if(!this.decoder){if(this.initialBufs.push(l),this.initialBufsLen+=l.length,this.initialBufsLen<16)return"";var c=a(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(c,this.options);for(var o="",d=0;d<this.initialBufs.length;d++)o+=this.decoder.write(this.initialBufs[d]);return this.initialBufs.length=this.initialBufsLen=0,o}return this.decoder.write(l)},f.prototype.end=function(){if(!this.decoder){var l=a(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(l,this.options);for(var c="",o=0;o<this.initialBufs.length;o++)c+=this.decoder.write(this.initialBufs[o]);var d=this.decoder.end();return d&&(c+=d),this.initialBufs.length=this.initialBufsLen=0,c}return this.decoder.end()};function a(l,c){var o=[],d=0,u=0,h=0;e:for(var v=0;v<l.length;v++)for(var w=l[v],A=0;A<w.length;A++)if(o.push(w[A]),o.length===2){if(d===0){if(o[0]===255&&o[1]===254)return"utf-16le";if(o[0]===254&&o[1]===255)return"utf-16be"}if(o[0]===0&&o[1]!==0&&h++,o[0]!==0&&o[1]===0&&u++,o.length=0,d++,d>=100)break e}return h>u?"utf-16be":h<u?"utf-16le":c||"utf-16le"}return jr}var mr={},Tc;function vf(){if(Tc)return mr;Tc=1;var s=Ze().Buffer;mr.utf7=t,mr.unicode11utf7="utf7";function t(w,A){this.iconv=A}t.prototype.encoder=e,t.prototype.decoder=n,t.prototype.bomAware=!0;var r=/[^A-Za-z0-9'\(\),-\.\/:\? \n\r\t]+/g;function e(w,A){this.iconv=A.iconv}e.prototype.write=function(w){return s.from(w.replace(r,function(A){return"+"+(A==="+"?"":this.iconv.encode(A,"utf16-be").toString("base64").replace(/=+$/,""))+"-"}.bind(this)))},e.prototype.end=function(){};function n(w,A){this.iconv=A.iconv,this.inBase64=!1,this.base64Accum=""}for(var i=/[A-Za-z0-9\/+]/,f=[],a=0;a<256;a++)f[a]=i.test(String.fromCharCode(a));var l=43,c=45,o=38;n.prototype.write=function(w){for(var A="",_=0,E=this.inBase64,x=this.base64Accum,g=0;g<w.length;g++)if(!E)w[g]==l&&(A+=this.iconv.decode(w.slice(_,g),"ascii"),_=g+1,E=!0);else if(!f[w[g]]){if(g==_&&w[g]==c)A+="+";else{var S=x+this.iconv.decode(w.slice(_,g),"ascii");A+=this.iconv.decode(s.from(S,"base64"),"utf16-be")}w[g]!=c&&g--,_=g+1,E=!1,x=""}if(!E)A+=this.iconv.decode(w.slice(_),"ascii");else{var S=x+this.iconv.decode(w.slice(_),"ascii"),B=S.length-S.length%8;x=S.slice(B),S=S.slice(0,B),A+=this.iconv.decode(s.from(S,"base64"),"utf16-be")}return this.inBase64=E,this.base64Accum=x,A},n.prototype.end=function(){var w="";return this.inBase64&&this.base64Accum.length>0&&(w=this.iconv.decode(s.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",w},mr.utf7imap=d;function d(w,A){this.iconv=A}d.prototype.encoder=u,d.prototype.decoder=h,d.prototype.bomAware=!0;function u(w,A){this.iconv=A.iconv,this.inBase64=!1,this.base64Accum=s.alloc(6),this.base64AccumIdx=0}u.prototype.write=function(w){for(var A=this.inBase64,_=this.base64Accum,E=this.base64AccumIdx,x=s.alloc(w.length*5+10),g=0,S=0;S<w.length;S++){var B=w.charCodeAt(S);B>=32&&B<=126?(A&&(E>0&&(g+=x.write(_.slice(0,E).toString("base64").replace(/\//g,",").replace(/=+$/,""),g),E=0),x[g++]=c,A=!1),A||(x[g++]=B,B===o&&(x[g++]=c))):(A||(x[g++]=o,A=!0),A&&(_[E++]=B>>8,_[E++]=B&255,E==_.length&&(g+=x.write(_.toString("base64").replace(/\//g,","),g),E=0)))}return this.inBase64=A,this.base64AccumIdx=E,x.slice(0,g)},u.prototype.end=function(){var w=s.alloc(10),A=0;return this.inBase64&&(this.base64AccumIdx>0&&(A+=w.write(this.base64Accum.slice(0,this.base64AccumIdx).toString("base64").replace(/\//g,",").replace(/=+$/,""),A),this.base64AccumIdx=0),w[A++]=c,this.inBase64=!1),w.slice(0,A)};function h(w,A){this.iconv=A.iconv,this.inBase64=!1,this.base64Accum=""}var v=f.slice();return v[44]=!0,h.prototype.write=function(w){for(var A="",_=0,E=this.inBase64,x=this.base64Accum,g=0;g<w.length;g++)if(!E)w[g]==o&&(A+=this.iconv.decode(w.slice(_,g),"ascii"),_=g+1,E=!0);else if(!v[w[g]]){if(g==_&&w[g]==c)A+="&";else{var S=x+this.iconv.decode(w.slice(_,g),"ascii").replace(/,/g,"/");A+=this.iconv.decode(s.from(S,"base64"),"utf16-be")}w[g]!=c&&g--,_=g+1,E=!1,x=""}if(!E)A+=this.iconv.decode(w.slice(_),"ascii");else{var S=x+this.iconv.decode(w.slice(_),"ascii").replace(/,/g,"/"),B=S.length-S.length%8;x=S.slice(B),S=S.slice(0,B),A+=this.iconv.decode(s.from(S,"base64"),"utf16-be")}return this.inBase64=E,this.base64Accum=x,A},h.prototype.end=function(){var w="";return this.inBase64&&this.base64Accum.length>0&&(w=this.iconv.decode(s.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",w},mr}var ea={},Fc;function wf(){if(Fc)return ea;Fc=1;var s=Ze().Buffer;ea._sbcs=t;function t(n,i){if(!n)throw new Error("SBCS codec is called without the data.");if(!n.chars||n.chars.length!==128&&n.chars.length!==256)throw new Error("Encoding '"+n.type+"' has incorrect 'chars' (must be of len 128 or 256)");if(n.chars.length===128){for(var f="",a=0;a<128;a++)f+=String.fromCharCode(a);n.chars=f+n.chars}this.decodeBuf=s.from(n.chars,"ucs2");for(var l=s.alloc(65536,i.defaultCharSingleByte.charCodeAt(0)),a=0;a<n.chars.length;a++)l[n.chars.charCodeAt(a)]=a;this.encodeBuf=l}t.prototype.encoder=r,t.prototype.decoder=e;function r(n,i){this.encodeBuf=i.encodeBuf}r.prototype.write=function(n){for(var i=s.alloc(n.length),f=0;f<n.length;f++)i[f]=this.encodeBuf[n.charCodeAt(f)];return i},r.prototype.end=function(){};function e(n,i){this.decodeBuf=i.decodeBuf}return e.prototype.write=function(n){for(var i=this.decodeBuf,f=s.alloc(n.length*2),a=0,l=0,c=0;c<n.length;c++)a=n[c]*2,l=c*2,f[l]=i[a],f[l+1]=i[a+1];return f.toString("ucs2")},e.prototype.end=function(){},ea}var ta,Bc;function xf(){return Bc||(Bc=1,ta={10029:"maccenteuro",maccenteuro:{type:"_sbcs",chars:""},808:"cp808",ibm808:"cp808",cp808:{type:"_sbcs",chars:""},mik:{type:"_sbcs",chars:""},cp720:{type:"_sbcs",chars:""},ascii8bit:"ascii",usascii:"ascii",ansix34:"ascii",ansix341968:"ascii",ansix341986:"ascii",csascii:"ascii",cp367:"ascii",ibm367:"ascii",isoir6:"ascii",iso646us:"ascii",iso646irv:"ascii",us:"ascii",latin1:"iso88591",latin2:"iso88592",latin3:"iso88593",latin4:"iso88594",latin5:"iso88599",latin6:"iso885910",latin7:"iso885913",latin8:"iso885914",latin9:"iso885915",latin10:"iso885916",csisolatin1:"iso88591",csisolatin2:"iso88592",csisolatin3:"iso88593",csisolatin4:"iso88594",csisolatincyrillic:"iso88595",csisolatinarabic:"iso88596",csisolatingreek:"iso88597",csisolatinhebrew:"iso88598",csisolatin5:"iso88599",csisolatin6:"iso885910",l1:"iso88591",l2:"iso88592",l3:"iso88593",l4:"iso88594",l5:"iso88599",l6:"iso885910",l7:"iso885913",l8:"iso885914",l9:"iso885915",l10:"iso885916",isoir14:"iso646jp",isoir57:"iso646cn",isoir100:"iso88591",isoir101:"iso88592",isoir109:"iso88593",isoir110:"iso88594",isoir144:"iso88595",isoir127:"iso88596",isoir126:"iso88597",isoir138:"iso88598",isoir148:"iso88599",isoir157:"iso885910",isoir166:"tis620",isoir179:"iso885913",isoir199:"iso885914",isoir203:"iso885915",isoir226:"iso885916",cp819:"iso88591",ibm819:"iso88591",cyrillic:"iso88595",arabic:"iso88596",arabic8:"iso88596",ecma114:"iso88596",asmo708:"iso88596",greek:"iso88597",greek8:"iso88597",ecma118:"iso88597",elot928:"iso88597",hebrew:"iso88598",hebrew8:"iso88598",turkish:"iso88599",turkish8:"iso88599",thai:"iso885911",thai8:"iso885911",celtic:"iso885914",celtic8:"iso885914",isoceltic:"iso885914",tis6200:"tis620",tis62025291:"tis620",tis62025330:"tis620",1e4:"macroman",10006:"macgreek",10007:"maccyrillic",10079:"maciceland",10081:"macturkish",cspc8codepage437:"cp437",cspc775baltic:"cp775",cspc850multilingual:"cp850",cspcp852:"cp852",cspc862latinhebrew:"cp862",cpgr:"cp869",msee:"cp1250",mscyrl:"cp1251",msansi:"cp1252",msgreek:"cp1253",msturk:"cp1254",mshebr:"cp1255",msarab:"cp1256",winbaltrim:"cp1257",cp20866:"koi8r",20866:"koi8r",ibm878:"koi8r",cskoi8r:"koi8r",cp21866:"koi8u",21866:"koi8u",ibm1168:"koi8u",strk10482002:"rk1048",tcvn5712:"tcvn",tcvn57121:"tcvn",gb198880:"iso646cn",cn:"iso646cn",csiso14jisc6220ro:"iso646jp",jisc62201969ro:"iso646jp",jp:"iso646jp",cshproman8:"hproman8",r8:"hproman8",roman8:"hproman8",xroman8:"hproman8",ibm1051:"hproman8",mac:"macintosh",csmacintosh:"macintosh"}),ta}var ra,Ic;function Ef(){return Ic||(Ic=1,ra={437:"cp437",737:"cp737",775:"cp775",850:"cp850",852:"cp852",855:"cp855",856:"cp856",857:"cp857",858:"cp858",860:"cp860",861:"cp861",862:"cp862",863:"cp863",864:"cp864",865:"cp865",866:"cp866",869:"cp869",874:"windows874",922:"cp922",1046:"cp1046",1124:"cp1124",1125:"cp1125",1129:"cp1129",1133:"cp1133",1161:"cp1161",1162:"cp1162",1163:"cp1163",1250:"windows1250",1251:"windows1251",1252:"windows1252",1253:"windows1253",1254:"windows1254",1255:"windows1255",1256:"windows1256",1257:"windows1257",1258:"windows1258",28591:"iso88591",28592:"iso88592",28593:"iso88593",28594:"iso88594",28595:"iso88595",28596:"iso88596",28597:"iso88597",28598:"iso88598",28599:"iso88599",28600:"iso885910",28601:"iso885911",28603:"iso885913",28604:"iso885914",28605:"iso885915",28606:"iso885916",windows874:{type:"_sbcs",chars:""},win874:"windows874",cp874:"windows874",windows1250:{type:"_sbcs",chars:""},win1250:"windows1250",cp1250:"windows1250",windows1251:{type:"_sbcs",chars:""},win1251:"windows1251",cp1251:"windows1251",windows1252:{type:"_sbcs",chars:""},win1252:"windows1252",cp1252:"windows1252",windows1253:{type:"_sbcs",chars:""},win1253:"windows1253",cp1253:"windows1253",windows1254:{type:"_sbcs",chars:""},win1254:"windows1254",cp1254:"windows1254",windows1255:{type:"_sbcs",chars:""},win1255:"windows1255",cp1255:"windows1255",windows1256:{type:"_sbcs",chars:""},win1256:"windows1256",cp1256:"windows1256",windows1257:{type:"_sbcs",chars:""},win1257:"windows1257",cp1257:"windows1257",windows1258:{type:"_sbcs",chars:""},win1258:"windows1258",cp1258:"windows1258",iso88591:{type:"_sbcs",chars:""},cp28591:"iso88591",iso88592:{type:"_sbcs",chars:""},cp28592:"iso88592",iso88593:{type:"_sbcs",chars:""},cp28593:"iso88593",iso88594:{type:"_sbcs",chars:""},cp28594:"iso88594",iso88595:{type:"_sbcs",chars:""},cp28595:"iso88595",iso88596:{type:"_sbcs",chars:""},cp28596:"iso88596",iso88597:{type:"_sbcs",chars:""},cp28597:"iso88597",iso88598:{type:"_sbcs",chars:""},cp28598:"iso88598",iso88599:{type:"_sbcs",chars:""},cp28599:"iso88599",iso885910:{type:"_sbcs",chars:""},cp28600:"iso885910",iso885911:{type:"_sbcs",chars:""},cp28601:"iso885911",iso885913:{type:"_sbcs",chars:""},cp28603:"iso885913",iso885914:{type:"_sbcs",chars:""},cp28604:"iso885914",iso885915:{type:"_sbcs",chars:""},cp28605:"iso885915",iso885916:{type:"_sbcs",chars:""},cp28606:"iso885916",cp437:{type:"_sbcs",chars:""},ibm437:"cp437",csibm437:"cp437",cp737:{type:"_sbcs",chars:""},ibm737:"cp737",csibm737:"cp737",cp775:{type:"_sbcs",chars:""},ibm775:"cp775",csibm775:"cp775",cp850:{type:"_sbcs",chars:""},ibm850:"cp850",csibm850:"cp850",cp852:{type:"_sbcs",chars:""},ibm852:"cp852",csibm852:"cp852",cp855:{type:"_sbcs",chars:""},ibm855:"cp855",csibm855:"cp855",cp856:{type:"_sbcs",chars:""},ibm856:"cp856",csibm856:"cp856",cp857:{type:"_sbcs",chars:""},ibm857:"cp857",csibm857:"cp857",cp858:{type:"_sbcs",chars:""},ibm858:"cp858",csibm858:"cp858",cp860:{type:"_sbcs",chars:""},ibm860:"cp860",csibm860:"cp860",cp861:{type:"_sbcs",chars:""},ibm861:"cp861",csibm861:"cp861",cp862:{type:"_sbcs",chars:""},ibm862:"cp862",csibm862:"cp862",cp863:{type:"_sbcs",chars:""},ibm863:"cp863",csibm863:"cp863",cp864:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`},ibm864:"cp864",csibm864:"cp864",cp865:{type:"_sbcs",chars:""},ibm865:"cp865",csibm865:"cp865",cp866:{type:"_sbcs",chars:""},ibm866:"cp866",csibm866:"cp866",cp869:{type:"_sbcs",chars:""},ibm869:"cp869",csibm869:"cp869",cp922:{type:"_sbcs",chars:""},ibm922:"cp922",csibm922:"cp922",cp1046:{type:"_sbcs",chars:""},ibm1046:"cp1046",csibm1046:"cp1046",cp1124:{type:"_sbcs",chars:""},ibm1124:"cp1124",csibm1124:"cp1124",cp1125:{type:"_sbcs",chars:""},ibm1125:"cp1125",csibm1125:"cp1125",cp1129:{type:"_sbcs",chars:""},ibm1129:"cp1129",csibm1129:"cp1129",cp1133:{type:"_sbcs",chars:""},ibm1133:"cp1133",csibm1133:"cp1133",cp1161:{type:"_sbcs",chars:""},ibm1161:"cp1161",csibm1161:"cp1161",cp1162:{type:"_sbcs",chars:""},ibm1162:"cp1162",csibm1162:"cp1162",cp1163:{type:"_sbcs",chars:""},ibm1163:"cp1163",csibm1163:"cp1163",maccroatian:{type:"_sbcs",chars:""},maccyrillic:{type:"_sbcs",chars:""},macgreek:{type:"_sbcs",chars:""},maciceland:{type:"_sbcs",chars:""},macroman:{type:"_sbcs",chars:""},macromania:{type:"_sbcs",chars:""},macthai:{type:"_sbcs",chars:"\uFEFF"},macturkish:{type:"_sbcs",chars:""},macukraine:{type:"_sbcs",chars:""},koi8r:{type:"_sbcs",chars:""},koi8u:{type:"_sbcs",chars:""},koi8ru:{type:"_sbcs",chars:""},koi8t:{type:"_sbcs",chars:""},armscii8:{type:"_sbcs",chars:")(.,-"},rk1048:{type:"_sbcs",chars:""},tcvn:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`},georgianacademy:{type:"_sbcs",chars:""},georgianps:{type:"_sbcs",chars:""},pt154:{type:"_sbcs",chars:""},viscii:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`},iso646cn:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}`},iso646jp:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_\`abcdefghijklmnopqrstuvwxyz{|}`},hproman8:{type:"_sbcs",chars:""},macintosh:{type:"_sbcs",chars:""},ascii:{type:"_sbcs",chars:""},tis620:{type:"_sbcs",chars:""}}),ra}var na={},Mc;function _f(){if(Mc)return na;Mc=1;var s=Ze().Buffer;na._dbcs=l;for(var t=-1,r=-2,e=-10,n=-1e3,i=new Array(256),f=-1,a=0;a<256;a++)i[a]=t;function l(u,h){if(this.encodingName=u.encodingName,!u)throw new Error("DBCS codec is called without the data.");if(!u.table)throw new Error("Encoding '"+this.encodingName+"' has no data.");var v=u.table();this.decodeTables=[],this.decodeTables[0]=i.slice(0),this.decodeTableSeq=[];for(var w=0;w<v.length;w++)this._addDecodeChunk(v[w]);if(typeof u.gb18030=="function"){this.gb18030=u.gb18030();var A=this.decodeTables.length;this.decodeTables.push(i.slice(0));var _=this.decodeTables.length;this.decodeTables.push(i.slice(0));for(var E=this.decodeTables[0],w=129;w<=254;w++)for(var x=this.decodeTables[n-E[w]],g=48;g<=57;g++){if(x[g]===t)x[g]=n-A;else if(x[g]>n)throw new Error("gb18030 decode tables conflict at byte 2");for(var S=this.decodeTables[n-x[g]],B=129;B<=254;B++){if(S[B]===t)S[B]=n-_;else{if(S[B]===n-_)continue;if(S[B]>n)throw new Error("gb18030 decode tables conflict at byte 3")}for(var k=this.decodeTables[n-S[B]],D=48;D<=57;D++)k[D]===t&&(k[D]=r)}}}this.defaultCharUnicode=h.defaultCharUnicode,this.encodeTable=[],this.encodeTableSeq=[];var $={};if(u.encodeSkipVals)for(var w=0;w<u.encodeSkipVals.length;w++){var j=u.encodeSkipVals[w];if(typeof j=="number")$[j]=!0;else for(var g=j.from;g<=j.to;g++)$[g]=!0}if(this._fillEncodeTable(0,0,$),u.encodeAdd)for(var Q in u.encodeAdd)Object.prototype.hasOwnProperty.call(u.encodeAdd,Q)&&this._setEncodeChar(Q.charCodeAt(0),u.encodeAdd[Q]);this.defCharSB=this.encodeTable[0][h.defaultCharSingleByte.charCodeAt(0)],this.defCharSB===t&&(this.defCharSB=this.encodeTable[0]["?"]),this.defCharSB===t&&(this.defCharSB=63)}l.prototype.encoder=c,l.prototype.decoder=o,l.prototype._getDecodeTrieNode=function(u){for(var h=[];u>0;u>>>=8)h.push(u&255);h.length==0&&h.push(0);for(var v=this.decodeTables[0],w=h.length-1;w>0;w--){var A=v[h[w]];if(A==t)v[h[w]]=n-this.decodeTables.length,this.decodeTables.push(v=i.slice(0));else if(A<=n)v=this.decodeTables[n-A];else throw new Error("Overwrite byte in "+this.encodingName+", addr: "+u.toString(16))}return v},l.prototype._addDecodeChunk=function(u){var h=parseInt(u[0],16),v=this._getDecodeTrieNode(h);h=h&255;for(var w=1;w<u.length;w++){var A=u[w];if(typeof A=="string")for(var _=0;_<A.length;){var E=A.charCodeAt(_++);if(E>=55296&&E<56320){var x=A.charCodeAt(_++);if(x>=56320&&x<57344)v[h++]=65536+(E-55296)*1024+(x-56320);else throw new Error("Incorrect surrogate pair in "+this.encodingName+" at chunk "+u[0])}else if(E>4080&&E<=4095){for(var g=4095-E+2,S=[],B=0;B<g;B++)S.push(A.charCodeAt(_++));v[h++]=e-this.decodeTableSeq.length,this.decodeTableSeq.push(S)}else v[h++]=E}else if(typeof A=="number")for(var k=v[h-1]+1,_=0;_<A;_++)v[h++]=k++;else throw new Error("Incorrect type '"+typeof A+"' given in "+this.encodingName+" at chunk "+u[0])}if(h>255)throw new Error("Incorrect chunk in "+this.encodingName+" at addr "+u[0]+": too long"+h)},l.prototype._getEncodeBucket=function(u){var h=u>>8;return this.encodeTable[h]===void 0&&(this.encodeTable[h]=i.slice(0)),this.encodeTable[h]},l.prototype._setEncodeChar=function(u,h){var v=this._getEncodeBucket(u),w=u&255;v[w]<=e?this.encodeTableSeq[e-v[w]][f]=h:v[w]==t&&(v[w]=h)},l.prototype._setEncodeSequence=function(u,h){var v=u[0],w=this._getEncodeBucket(v),A=v&255,_;w[A]<=e?_=this.encodeTableSeq[e-w[A]]:(_={},w[A]!==t&&(_[f]=w[A]),w[A]=e-this.encodeTableSeq.length,this.encodeTableSeq.push(_));for(var E=1;E<u.length-1;E++){var x=_[v];typeof x=="object"?_=x:(_=_[v]={},x!==void 0&&(_[f]=x))}v=u[u.length-1],_[v]=h},l.prototype._fillEncodeTable=function(u,h,v){for(var w=this.decodeTables[u],A=!1,_={},E=0;E<256;E++){var x=w[E],g=h+E;if(!v[g])if(x>=0)this._setEncodeChar(x,g),A=!0;else if(x<=n){var S=n-x;if(!_[S]){var B=g<<8>>>0;this._fillEncodeTable(S,B,v)?A=!0:_[S]=!0}}else x<=e&&(this._setEncodeSequence(this.decodeTableSeq[e-x],g),A=!0)}return A};function c(u,h){this.leadSurrogate=-1,this.seqObj=void 0,this.encodeTable=h.encodeTable,this.encodeTableSeq=h.encodeTableSeq,this.defaultCharSingleByte=h.defCharSB,this.gb18030=h.gb18030}c.prototype.write=function(u){for(var h=s.alloc(u.length*(this.gb18030?4:3)),v=this.leadSurrogate,w=this.seqObj,A=-1,_=0,E=0;;){if(A===-1){if(_==u.length)break;var x=u.charCodeAt(_++)}else{var x=A;A=-1}if(x>=55296&&x<57344)if(x<56320)if(v===-1){v=x;continue}else v=x,x=t;else v!==-1?(x=65536+(v-55296)*1024+(x-56320),v=-1):x=t;else v!==-1&&(A=x,x=t,v=-1);var g=t;if(w!==void 0&&x!=t){var S=w[x];if(typeof S=="object"){w=S;continue}else typeof S=="number"?g=S:S==null&&(S=w[f],S!==void 0&&(g=S,A=x));w=void 0}else if(x>=0){var B=this.encodeTable[x>>8];if(B!==void 0&&(g=B[x&255]),g<=e){w=this.encodeTableSeq[e-g];continue}if(g==t&&this.gb18030){var k=d(this.gb18030.uChars,x);if(k!=-1){var g=this.gb18030.gbChars[k]+(x-this.gb18030.uChars[k]);h[E++]=129+Math.floor(g/12600),g=g%12600,h[E++]=48+Math.floor(g/1260),g=g%1260,h[E++]=129+Math.floor(g/10),g=g%10,h[E++]=48+g;continue}}}g===t&&(g=this.defaultCharSingleByte),g<256?h[E++]=g:g<65536?(h[E++]=g>>8,h[E++]=g&255):g<16777216?(h[E++]=g>>16,h[E++]=g>>8&255,h[E++]=g&255):(h[E++]=g>>>24,h[E++]=g>>>16&255,h[E++]=g>>>8&255,h[E++]=g&255)}return this.seqObj=w,this.leadSurrogate=v,h.slice(0,E)},c.prototype.end=function(){if(!(this.leadSurrogate===-1&&this.seqObj===void 0)){var u=s.alloc(10),h=0;if(this.seqObj){var v=this.seqObj[f];v!==void 0&&(v<256?u[h++]=v:(u[h++]=v>>8,u[h++]=v&255)),this.seqObj=void 0}return this.leadSurrogate!==-1&&(u[h++]=this.defaultCharSingleByte,this.leadSurrogate=-1),u.slice(0,h)}},c.prototype.findIdx=d;function o(u,h){this.nodeIdx=0,this.prevBytes=[],this.decodeTables=h.decodeTables,this.decodeTableSeq=h.decodeTableSeq,this.defaultCharUnicode=h.defaultCharUnicode,this.gb18030=h.gb18030}o.prototype.write=function(u){for(var h=s.alloc(u.length*2),v=this.nodeIdx,w=this.prevBytes,A=this.prevBytes.length,_=-this.prevBytes.length,E,x=0,g=0;x<u.length;x++){var S=x>=0?u[x]:w[x+A],E=this.decodeTables[v][S];if(!(E>=0))if(E===t)E=this.defaultCharUnicode.charCodeAt(0),x=_;else if(E===r){if(x>=3)var B=(u[x-3]-129)*12600+(u[x-2]-48)*1260+(u[x-1]-129)*10+(S-48);else var B=(w[x-3+A]-129)*12600+((x-2>=0?u[x-2]:w[x-2+A])-48)*1260+((x-1>=0?u[x-1]:w[x-1+A])-129)*10+(S-48);var k=d(this.gb18030.gbChars,B);E=this.gb18030.uChars[k]+B-this.gb18030.gbChars[k]}else if(E<=n){v=n-E;continue}else if(E<=e){for(var D=this.decodeTableSeq[e-E],$=0;$<D.length-1;$++)E=D[$],h[g++]=E&255,h[g++]=E>>8;E=D[D.length-1]}else throw new Error("iconv-lite internal error: invalid decoding table value "+E+" at "+v+"/"+S);if(E>=65536){E-=65536;var j=55296|E>>10;h[g++]=j&255,h[g++]=j>>8,E=56320|E&1023}h[g++]=E&255,h[g++]=E>>8,v=0,_=x+1}return this.nodeIdx=v,this.prevBytes=_>=0?Array.prototype.slice.call(u,_):w.slice(_+A).concat(Array.prototype.slice.call(u)),h.slice(0,g).toString("ucs2")},o.prototype.end=function(){for(var u="";this.prevBytes.length>0;){u+=this.defaultCharUnicode;var h=this.prevBytes.slice(1);this.prevBytes=[],this.nodeIdx=0,h.length>0&&(u+=this.write(h))}return this.prevBytes=[],this.nodeIdx=0,u};function d(u,h){if(u[0]>h)return-1;for(var v=0,w=u.length;v<w-1;){var A=v+(w-v+1>>1);u[A]<=h?v=A:w=A}return v}return na}const Af=[["0","\0",128],["a1","",62],["8140","",9,""],["8180",""],["81b8",""],["81c8",""],["81da",""],["81f0",""],["81fc",""],["824f","",9],["8260","",25],["8281","",25],["829f","",82],["8340","",62],["8380","",22],["839f","",16,"",6],["83bf","",16,"",6],["8440","",5,"",25],["8470","",5,"",7],["8480","",17],["849f",""],["8740","",19,"",9],["875f",""],["877e",""],["8780","",4,""],["889f",""],["8940",""],["8980",""],["8a40",""],["8a80",""],["8b40",""],["8b80",""],["8c40",""],["8c80",""],["8d40",""],["8d80",""],["8e40",""],["8e80",""],["8f40",""],["8f80",""],["9040",""],["9080",""],["9140",""],["9180",""],["9240",""],["9280",""],["9340",""],["9380",""],["9440",""],["9480",""],["9540",""],["9580",""],["9640",""],["9680",""],["9740",""],["9780",""],["9840",""],["989f",""],["9940",""],["9980",""],["9a40",""],["9a80",""],["9b40",""],["9b80",""],["9c40",""],["9c80",""],["9d40",""],["9d80",""],["9e40",""],["9e80",""],["9f40",""],["9f80",""],["e040",""],["e080",""],["e140",""],["e180",""],["e240",""],["e280",""],["e340",""],["e380",""],["e440",""],["e480",""],["e540",""],["e580",""],["e640",""],["e680",""],["e740",""],["e780",""],["e840",""],["e880",""],["e940",""],["e980",""],["ea40",""],["ea80",""],["ed40",""],["ed80",""],["ee40",""],["ee80",""],["eeef","",9,""],["f040","",62],["f080","",124],["f140","",62],["f180","",124],["f240","",62],["f280","",124],["f340","",62],["f380","",124],["f440","",62],["f480","",124],["f540","",62],["f580","",124],["f640","",62],["f680","",124],["f740","",62],["f780","",124],["f840","",62],["f880","",124],["f940",""],["fa40","",9,"",9,""],["fa80",""],["fb40",""],["fb80",""],["fc40",""]],Sf=JSON.parse('[["0","\\u0000",127],["8ea1","",62],["a1a1","",9,""],["a2a1",""],["a2ba",""],["a2ca",""],["a2dc",""],["a2f2",""],["a2fe",""],["a3b0","",9],["a3c1","",25],["a3e1","",25],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a7a1","",5,"",25],["a7d1","",5,"",25],["a8a1",""],["ada1","",19,"",9],["adc0",""],["addf","",4,""],["b0a1",""],["b1a1",""],["b2a1",""],["b3a1",""],["b4a1",""],["b5a1",""],["b6a1",""],["b7a1",""],["b8a1",""],["b9a1",""],["baa1",""],["bba1",""],["bca1",""],["bda1",""],["bea1",""],["bfa1",""],["c0a1",""],["c1a1",""],["c2a1",""],["c3a1",""],["c4a1",""],["c5a1",""],["c6a1",""],["c7a1",""],["c8a1",""],["c9a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1",""],["d2a1",""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fcf1","",9,""],["8fa2af",""],["8fa2c2",""],["8fa2eb",""],["8fa6e1",""],["8fa6e7",""],["8fa6e9",""],["8fa6ec",""],["8fa6f1",""],["8fa7c2","",10,""],["8fa7f2","",10,""],["8fa9a1",""],["8fa9a4",""],["8fa9a6",""],["8fa9a8",""],["8fa9ab",""],["8fa9af",""],["8fa9c1",""],["8faaa1",""],["8faaba",""],["8faba1",""],["8fabbd",""],["8fabc5",""],["8fb0a1",""],["8fb1a1",""],["8fb2a1","",4,""],["8fb3a1",""],["8fb4a1",""],["8fb5a1",""],["8fb6a1","",5,"",4,""],["8fb7a1","",4,""],["8fb8a1",""],["8fb9a1",""],["8fbaa1","",4,""],["8fbba1",""],["8fbca1","",4,""],["8fbda1","",4,""],["8fbea1","",4,""],["8fbfa1",""],["8fc0a1",""],["8fc1a1",""],["8fc2a1",""],["8fc3a1","",4,""],["8fc4a1",""],["8fc5a1",""],["8fc6a1",""],["8fc7a1",""],["8fc8a1",""],["8fc9a1","",4,"",4,""],["8fcaa1",""],["8fcba1",""],["8fcca1","",9,""],["8fcda1","",5,""],["8fcea1","",6,""],["8fcfa1",""],["8fd0a1",""],["8fd1a1",""],["8fd2a1","",5],["8fd3a1",""],["8fd4a1","",4,""],["8fd5a1",""],["8fd6a1",""],["8fd7a1",""],["8fd8a1",""],["8fd9a1","",4,"",6,""],["8fdaa1","",4,""],["8fdba1","",6,""],["8fdca1","",4,""],["8fdda1","",4,""],["8fdea1","",4,""],["8fdfa1",""],["8fe0a1",""],["8fe1a1","",4,""],["8fe2a1",""],["8fe3a1","",5,"",4,""],["8fe4a1","",4,""],["8fe5a1","",4,""],["8fe6a1",""],["8fe7a1",""],["8fe8a1","",4,""],["8fe9a1","",4],["8feaa1","",4,""],["8feba1","",4,""],["8feca1",""],["8feda1","",4,"",4,""]]'),ia=JSON.parse('[["0","\\u0000",127,""],["8140","",5,"",9,"",6,""],["8180","",6,"",4,"",4,"",5,""],["8240","",4,"",8,"",4,"",11],["8280","",10,"",4,"",7,"",5,"",8,"",20,"",4,"",6,""],["8340","",17,"",5,"",10,"",4,"",9,""],["8380","",5,"",13,"",28,"",4,"",4,"",5],["8440","",5,"",5,""],["8480","",9,"",4,"",6,"",6,"",9,"",5,"",10,"",7,""],["8540","",9,""],["8580","",4,"",6,"",4,"",4,"",7,""],["8640","",4,"",5,"",4,"",5,""],["8680","",4,"",4,"",5,"",6,"",8,"",4,"",4,"",4,""],["8740","",7,"",11,"",4,"",4],["8780","",7,"",6,"",14,"",10,"",6,"",12,"",8,"",5,"",6],["8840","",9,"",4,"",4,""],["8880","",4,"",6,"",8,"",6,"",7,"",4,"",4,"",7],["8940","",5,"",6,"",4,"",5,"",4,"",16,""],["8980","",4,"",4,"",7,"",17,"",10,"",13,"",5,"",7,"",4,""],["8a40","",4,"",12,""],["8a80","",5,"",6,"",4,"",11,"",6,"",4,"",4,"",9,"",5],["8b40","",8,"",17,"",6,"",13,""],["8b80","",4,"",4,"",5,"",4,"",4,"",22,"",11,"",25,"",7,"",6],["8c40","",7,""],["8c80","",8,"",4,"",6,"",6,"",6,"",4,"",4,"",4],["8d40","",5,"",5,"",5,"",6,"",9,"",4],["8d80","",5,"",4,"",4,"",4,"",7,"",7,"",10,"",10,"",12,"",21,""],["8e40","",21,"",12,"",6,"",12,""],["8e80","",4,"",7,"",4,"",4,"",5,"",6,"",4,"",14,"",4,"",4,"",6],["8f40","",5,"",11,"",8,""],["8f80","",6,"",14,"",5,"",5,"",4,""],["9040","",4,"",4,"",6,""],["9080","",7,"",4,"",4,"",4,"",4,"",18,"",6],["9140","",6,"",6,"",18,"",4,""],["9180","",6,"",8,"",9,"",5,"",4,"",4,"",16,"",13,"",8,"",5,"",4,""],["9240","",6,"",5,""],["9280","",5,"",7,"",6,""],["9340","",6,"",4,"",4,"",5,""],["9380","",5,"",4,"",6,"",4,"",7,"",9,"",6,"",8,"",4,"",6,""],["9440","",24,"",7,"",7,"",4,"",8],["9480","",4,"",4,"",14,"",7,"",7,""],["9540","",4,"",4,"",6,""],["9580","",4,"",4,"",8,"",4,"",4,"",25,"",7,"",5,""],["9640","",5,"",4,""],["9680","",7,"",9,"",7,"",4,"",6,"",6,"",5],["9740","",7,"",8,"",7,"",9,""],["9780","",6,"",5,"",4,"",9,"",4,"",11,"",7,"",16,""],["9840","",4,"",5,"",9,""],["9880","",7,"",5,"",11,"",9,"",9,"",11,"",5,"",5,"",6,"",4,"",7,"",6,""],["9940","",4,"",10,"",6,"",8,"",4,"",7,"",5],["9980","",114,"",6],["9a40","",11,"",7,"",13,""],["9a80","",4,"",7,"",7,"",6,"",4,"",4,"",7,"",6,"",4,"",4,""],["9b40","",4,""],["9b80","",5,"",4,"",4,"",5,""],["9c40","",7,""],["9c80","",7,"",7,"",10,"",14,"",4,"",6,"",5],["9d40","",7,"",4,"",9,"",6,""],["9d80","",9,"",5,"",6,"",12,"",4,"",10,"",5,"",5,"",6,"",10,""],["9e40","",7,"",32,"",7,"",6,"",6],["9e80","",9,"",17,"",13,"",11,"",12,"",12,""],["9f40","",6,"",10,"",4,"",10,"",7,""],["9f80","",13,"",12,"",4,"",4,"",5,"",4,"",4,"",6,"",5,"",8,"",9,"",4],["a040","",9,"",5,"",9,"",11,"",19],["a080","",9,"",6,"",4,"",11,"",11,"",6,""],["a1a1","",7,""],["a2a1","",9],["a2b1","",19,"",19,"",9],["a2e5","",9],["a2f1","",11],["a3a1","",88,""],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a6e0",""],["a6ee",""],["a6f4",""],["a7a1","",5,"",25],["a7d1","",5,"",25],["a840","",35,"",6],["a880","",7,""],["a8a1",""],["a8bd",""],["a8c0",""],["a8c5","",36],["a940","",8,""],["a959",""],["a95c",""],["a960","",9,"",8],["a980","",4,""],["a996",""],["a9a4","",75],["aa40","",5,"",5,"",8],["aa80","",7,"",10,""],["ab40","",11,"",4,"",5,"",4],["ab80","",6,"",4],["ac40","",10,"",8,"",5,"",4,"",11],["ac80","",6,"",12,"",4,""],["ad40","",10,"",7,"",15,"",12],["ad80","",9,"",8,"",6,""],["ae40","",6,"",7,"",4,""],["ae80","",7,"",6,"",4,""],["af40","",4,""],["af80",""],["b040","",6,"",5,"",4,"",6,"",7,""],["b080","",7,"",8,"",9,""],["b140","",4,"",7,"",10,""],["b180","",4,"",7,"",7,""],["b240","",11,"",5,"",11,"",4],["b280","",12,"",8,"",4,""],["b340","",5,""],["b380","",11,"",7,"",6,""],["b440","",7,"",9],["b480","",4,"",5,"",6,""],["b540","",5,"",9,"",4,"",14,"",4,"",8,""],["b580","",6,"",4,""],["b640","",6,"",11,"",10,"",4,"",5,""],["b680","",6,"",4,""],["b740","",14,"",5,"",9,"",4,"",16],["b780","",6,""],["b840","",4,"",10,"",10,"",9,"",5,""],["b880","",4,""],["b940","",5,"",10,"",6,""],["b980","",7,""],["ba40","",4,"",4,"",7,"",5,""],["ba80","",4,"",5,"",12,"",5,""],["bb40","",9,"",36,"",5,"",9],["bb80","",6,"",4,""],["bc40","",6,"",6,"",5,"",7,"",13,"",5],["bc80","",14,"",6,""],["bd40","",54,"",7],["bd80","",32,""],["be40","",12,"",6,"",42],["be80","",32,""],["bf40","",62],["bf80","",4,"",4,"",21,""],["c040","",35,"",23,""],["c080","",6,"",9,""],["c140","",4,"",7,"",4,"",4,"",6,""],["c180","",4,"",4,"",5,""],["c240","",6,"",5,""],["c280","",13,"",5,"",11,""],["c340","",5,"",4,"",6,""],["c380","",12,"",4,""],["c440","",5,"",4,"",4,"",5,"",4,""],["c480","",7,"",5,"",6,""],["c540","",14,"",4,"",5,"",4,"",5,""],["c580","",7,"",7,""],["c640",""],["c680","",4,"",9,""],["c740","",4,"",4,"",6,"",6,"",6,""],["c780",""],["c840","",4,"",5,"",5,"",7,"",5,"",7,""],["c880","",6,"",4,"",4,""],["c940","",4,"",7,"",12,""],["c980","",4,"",4,"",10,""],["ca40","",8,"",8,"",9,"",4,"",10],["ca80","",4,"",8,""],["cb40","",6,"",10,"",6,"",5,"",6,"",6,"",4,""],["cb80","",5,"",6,"",14,""],["cc40","",4,"",10,"",15,"",13,""],["cc80","",11,"",4,"",7,""],["cd40","",6,"",6,"",4,"",5,"",4,"",4,""],["cd80",""],["ce40","",6,"",5,"",7,""],["ce80","",4,"",6,"",4,""],["cf40","",4,"",4,"",6,"",9],["cf80","",5,"",7,"",4,""],["d040","",13,"",5,"",5,"",5,"",6,""],["d080","",4,"",4,"",5,""],["d140","",4,"",4,"",6,"",5],["d180","",4,"",4,"",4,""],["d240","",8,"",24,"",5,"",19,""],["d280","",26,""],["d340","",30,"",6],["d380","",4,"",5,"",21,""],["d440","",31,"",8,"",21],["d480","",25,"",6,""],["d540","",7,"",7,"",46],["d580","",32,""],["d640","",34,"",27],["d680","",30,""],["d740","",31,"",4,"",25],["d780","",24,""],["d840","",8,"",7,"",5,"",6,"",6,"",6,""],["d880","",6,"",20,""],["d940","",62],["d980","",32,""],["da40","",14,"",8,"",4,"",9,""],["da80","",12,""],["db40","",6,"",7,"",4,""],["db80","",4,"",5,"",11,""],["dc40","",4,"",6,"",6,"",11,"",6,"",7],["dc80","",10,"",21,""],["dd40","",62],["dd80","",32,""],["de40","",32,""],["de80","",4,""],["df40","",5,"",4,"",4,"",5,"",4,"",6,""],["df80","",4,""],["e040","",19,""],["e080","",10,"",6,"",8,""],["e140","",4,"",6,"",5,"",5,""],["e180","",10,"",9,"",8,""],["e240","",62],["e280","",32,"",5,""],["e340","",45,"",16],["e380","",7,"",24,""],["e440","",5,"",24,"",31],["e480","",32,""],["e540","",51,"",10],["e580","",31,""],["e640","",34,"",27],["e680","",29,""],["e740","",7,"",54],["e780","",32,"",6,"",4,""],["e840","",14,"",43,""],["e880","",20,""],["e940","",7,"",42],["e980","",32,""],["ea40","",27,"",6,""],["ea80","",4,"",12,""],["eb40","",9,"",7,"",9,"",6,""],["eb80","",4,""],["ec40","",8,"",4,"",18,"",7],["ec80","",4,"",7,"",4,"",4,""],["ed40","",6,"",46],["ed80","",4,"",23,""],["ee40","",62],["ee80","",32,"",4,"",6,""],["ef40","",5,"",37,"",4],["ef80","",30,"",4,"",8,""],["f040","",4,"",28,"",26],["f080","",9,"",12,"",4,"",6,""],["f140","",10,"",47],["f180","",32,""],["f240","",62],["f280","",32,""],["f340","",17,"",6,"",4,""],["f380","",8,"",6,""],["f440","",5,"",10,"",10,"",7,"",5],["f480","",32,""],["f540","",62],["f580","",32,""],["f640","",62],["f680","",32,"",5,"",5,"",4,"",7,""],["f740","",62],["f780","",4,"",4,""],["f840","",62],["f880","",32],["f940","",62],["f980","",32],["fa40","",62],["fa80","",32],["fb40","",27,"",9,""],["fb80","",5,"",8,"",5,""],["fc40","",8,"",4,"",8,"",6],["fc80","",4,"",5,"",8,""],["fd40","",4,"",4,"",10,"",38],["fd80","",5,"",11,"",4,""],["fe40",""]]'),Cc=[["a140","",62],["a180","",32],["a240","",62],["a280","",32],["a2ab","",5],["a2e3",""],["a2ef",""],["a2fd",""],["a340","",62],["a380","",31,""],["a440","",62],["a480","",32],["a4f4","",10],["a540","",62],["a580","",32],["a5f7","",7],["a640","",62],["a680","",32],["a6b9","",7],["a6d9","",6],["a6ec",""],["a6f3",""],["a6f6","",8],["a740","",62],["a780","",32],["a7c2","",14],["a7f2","",12],["a896","",10],["a8bc",""],["a8bf",""],["a8c1",""],["a8ea","",20],["a958",""],["a95b",""],["a95d",""],["a989","",11],["a997","",12],["a9f0","",14],["aaa1","",93],["aba1","",93],["aca1","",93],["ada1","",93],["aea1","",93],["afa1","",93],["d7fa","",4],["f8a1","",93],["f9a1","",93],["faa1","",93],["fba1","",93],["fca1","",93],["fda1","",93],["fe50",""],["fe80","",6,"",93],["8135f437",""]],Tf=[128,165,169,178,184,216,226,235,238,244,248,251,253,258,276,284,300,325,329,334,364,463,465,467,469,471,473,475,477,506,594,610,712,716,730,930,938,962,970,1026,1104,1106,8209,8215,8218,8222,8231,8241,8244,8246,8252,8365,8452,8454,8458,8471,8482,8556,8570,8596,8602,8713,8720,8722,8726,8731,8737,8740,8742,8748,8751,8760,8766,8777,8781,8787,8802,8808,8816,8854,8858,8870,8896,8979,9322,9372,9548,9588,9616,9622,9634,9652,9662,9672,9676,9680,9702,9735,9738,9793,9795,11906,11909,11913,11917,11928,11944,11947,11951,11956,11960,11964,11979,12284,12292,12312,12319,12330,12351,12436,12447,12535,12543,12586,12842,12850,12964,13200,13215,13218,13253,13263,13267,13270,13384,13428,13727,13839,13851,14617,14703,14801,14816,14964,15183,15471,15585,16471,16736,17208,17325,17330,17374,17623,17997,18018,18212,18218,18301,18318,18760,18811,18814,18820,18823,18844,18848,18872,19576,19620,19738,19887,40870,59244,59336,59367,59413,59417,59423,59431,59437,59443,59452,59460,59478,59493,63789,63866,63894,63976,63986,64016,64018,64021,64025,64034,64037,64042,65074,65093,65107,65112,65127,65132,65375,65510,65536],Ff=[0,36,38,45,50,81,89,95,96,100,103,104,105,109,126,133,148,172,175,179,208,306,307,308,309,310,311,312,313,341,428,443,544,545,558,741,742,749,750,805,819,820,7922,7924,7925,7927,7934,7943,7944,7945,7950,8062,8148,8149,8152,8164,8174,8236,8240,8262,8264,8374,8380,8381,8384,8388,8390,8392,8393,8394,8396,8401,8406,8416,8419,8424,8437,8439,8445,8482,8485,8496,8521,8603,8936,8946,9046,9050,9063,9066,9076,9092,9100,9108,9111,9113,9131,9162,9164,9218,9219,11329,11331,11334,11336,11346,11361,11363,11366,11370,11372,11375,11389,11682,11686,11687,11692,11694,11714,11716,11723,11725,11730,11736,11982,11989,12102,12336,12348,12350,12384,12393,12395,12397,12510,12553,12851,12962,12973,13738,13823,13919,13933,14080,14298,14585,14698,15583,15847,16318,16434,16438,16481,16729,17102,17122,17315,17320,17402,17418,17859,17909,17911,17915,17916,17936,17939,17961,18664,18703,18814,18962,19043,33469,33470,33471,33484,33485,33490,33497,33501,33505,33513,33520,33536,33550,37845,37921,37948,38029,38038,38064,38065,38066,38069,38075,38076,38078,39108,39109,39113,39114,39115,39116,39265,39394,189e3],Bf={uChars:Tf,gbChars:Ff},If=JSON.parse('[["0","\\u0000",127],["8141","",4,"",6,""],["8161","",9,"",5,""],["8181","",18,"",4,"",6,"",5,"",6,"",7,"",7,"",4,"",4,""],["8241","",7,"",5],["8261","",6,"",5,""],["8281","",7,"",7,"",4,"",10,"",5,"",17,"",7,"",6,"",7,"",18],["8341","",5,"",5,"",7],["8361","",18,""],["8381","",4,"",6,"",5,"",5,"",46,"",6,"",5,"",8],["8441","",5,"",8],["8461","",18],["8481","",7,"",6,"",5,"",10,"",5,"",18,"",5,"",6,"",5,"",26,""],["8541","",5,"",4,"",6,"",4],["8561","",5,"",5,"",6,""],["8581","",6,"",6,"",9,"",26,"",29,"",6,"",5,""],["8641","",6,"",5,""],["8661","",6,"",10],["8681","",22,"",4,"",6,"",5,"",6,"",22,"",4,""],["8741","",9,"",15],["8761","",18,""],["8781","",5,"",7,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",4],["8841","",4,"",5,"",6,"",4],["8861","",4,""],["8881","",15,"",4,"",6,"",5,"",54,""],["8941","",6,"",5,""],["8961","",10,"",5,""],["8981","",21,"",18,"",18,"",6,"",6,"",7,"",15],["8a41","",10,"",6,""],["8a61","",4,"",18,""],["8a81","",4,"",19,"",5,"",7,"",5,"",6,"",5,"",4,"",5,"",26,""],["8b41","",5,"",4,"",6,""],["8b61","",6,"",8],["8b81","",52,"",4,"",6,"",5,"",18,"",18],["8c41","",15,"",4],["8c61","",6,"",5,"",6,"",5],["8c81","",12,"",26,"",50,"",5,"",16],["8d41","",16,"",8],["8d61","",17,""],["8d81","",4,"",33,"",6,"",7,"",6,"",9,"",6,"",5,"",6,""],["8e41","",6,"",5,"",8],["8e61","",4,"",19],["8e81","",13,"",6,"",4,"",6,"",5,"",6,"",5,"",11,"",7,"",6,"",5,"",7],["8f41","",7,"",17],["8f61","",7,"",6,"",4],["8f81","",5,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",5],["9041","",6,"",5,""],["9061","",5,"",15],["9081","",12,"",6,"",5,"",4,"",6,"",4,"",5,"",11,"",33,""],["9141","",6,"",5],["9161","",9,"",5],["9181","",20,"",4,"",5,"",14,"",33,"",7,"",5,"",6],["9241","",7,"",4,""],["9261","",7,"",7,"",4],["9281","",21,"",18,"",6,"",7,"",6,"",35,""],["9341","",4,""],["9361","",6,"",8],["9381","",37,"",4,"",4,"",6,"",5,"",7,"",22,""],["9441","",5,"",5,"",8],["9461","",5,"",6,"",12],["9481","",5,"",6,"",6,"",9,"",22,"",4,"",6,"",10,"",6,"",24],["9541","",11,"",5,""],["9561","",6,"",5,""],["9581","",6,"",35,"",4,"",4,"",4,"",6,"",5,"",13,"",14],["9641","",23,""],["9661","",6,"",5,"",8],["9681","",10,"",5,"",13,"",33,"",6,"",44],["9741","",16,"",8],["9761","",17,"",7],["9781","",11,"",5,"",6,"",89,""],["9841","",16,"",5,""],["9861","",6,"",15],["9881","",21,"",6,"",5,"",4,"",6,"",5,"",6,"",5,"",6,"",5,""],["9941","",6,"",5,""],["9961","",6,"",5,""],["9981","",8,"",5,"",4,"",11,"",5,"",6,"",6,"",6,"",7,"",6,"",5,""],["9a41","",16],["9a61","",6,"",6,""],["9a81","",4,"",6,"",5,"",5,"",6,"",5,"",5,"",33,"",5,"",6,""],["9b41","",6,"",8],["9b61","",17,"",7],["9b81","",25,"",4,"",5,"",50,"",22,""],["9c41","",4,"",5,"",5],["9c61","",8,"",6,"",9],["9c81","",8,"",6,"",6,"",9,"",26,"",6,"",5,"",18,"",6,"",12],["9d41","",13,"",8],["9d61","",25],["9d81","",8,"",5,"",9,"",6,"",10,"",6,"",5,"",6,"",5,""],["9e41","",7,"",9,""],["9e61","",4,"",6,""],["9e81","",6,"",6,"",6,"",5,"",10,"",5,"",6,"",5,"",6,""],["9f41","",5,"",4,"",5,""],["9f61","",6,"",5,""],["9f81","",4,"",5,"",6,"",5,"",6,"",4,"",6,"",7,"",4,"",4,""],["a041","",5,"",6,""],["a061","",5,"",13],["a081","",4,"",4,"",4,"",6,"",5,"",6,"",5,"",26,"",4,"",5,"",7,""],["a141","",18,""],["a161","",6,"",5,""],["a181","",14,"",5,"",4,"",9,""],["a241","",5,"",18],["a261","",6,"",18],["a281","",7,"",6,"",7,""],["a341","",6,"",10,""],["a361","",6,"",16],["a381","",16,"",4,"",58,"",32,""],["a441","",5,""],["a461","",5,"",12],["a481","",28,"",93],["a541","",4,"",6,"",5,""],["a561","",17,"",5,""],["a581","",16,"",14,"",9],["a5b0","",9],["a5c1","",16,"",6],["a5e1","",16,"",6],["a641","",19,""],["a661","",5,"",5,"",6],["a681","",6,"",18,"",7],["a741","",4,"",6,"",7],["a761","",22,""],["a781","",6,"",5,"",7,"",9,"",9,"",4,"",5,"",4,""],["a841","",10,"",14],["a861","",18,"",6],["a881","",19,"",11,""],["a8a6",""],["a8a8",""],["a8b1","",27,"",25,"",14,""],["a941","",14,"",10],["a961","",18],["a981","",14,"",6,"",27,"",25,"",14,""],["aa41","",6,"",4,""],["aa61","",4,"",5,"",6,""],["aa81","",29,"",82],["ab41","",6,"",5,""],["ab61","",6,"",5,"",5],["ab81","",8,"",6,"",12,"",85],["ac41","",5,"",6,""],["ac61","",11,"",4],["ac81","",28,"",5,"",25],["acd1","",5,"",25],["ad41","",6,"",5,"",7],["ad61","",6,"",10,""],["ad81","",5,"",18,""],["ae41","",5,"",16],["ae61","",5,"",6,"",4],["ae81","",6,"",5,""],["af41","",19],["af61","",13,"",5,""],["af81","",5,"",6,"",5,""],["b041","",5,"",5,"",12],["b061","",5,"",19],["b081","",13,"",6,"",5,"",7,"",4,""],["b141","",6,"",5,""],["b161","",6,"",5,"",11],["b181","",14,"",6,""],["b241","",6,"",5,""],["b261","",18,"",5,""],["b281","",5,"",18,"",6,""],["b341","",19,""],["b361","",5,"",5,"",5],["b381","",5,"",5,"",19,"",4,""],["b441","",5,"",6,"",5],["b461","",6,"",10,""],["b481","",6,"",18,"",4,"",4,""],["b541","",14,"",5],["b561","",5,"",5,"",4],["b581","",6,"",5,"",11,""],["b641","",7,"",17],["b661","",15,""],["b681","",5,"",6,"",5,""],["b741","",13,"",6,""],["b761","",20,""],["b781","",6,"",14,""],["b841","",7,"",17],["b861","",8,"",13],["b881","",5,"",24,"",4,""],["b941","",6,"",5,""],["b961","",14,"",6,""],["b981","",22,"",4,"",4,""],["ba41","",5,"",6,""],["ba61","",5,"",4,"",5],["ba81","",6,"",9,""],["bb41","",4,"",5,"",4,""],["bb61","",6,"",5,""],["bb81","",31,""],["bc41","",17,""],["bc61","",5,"",6,""],["bc81","",4,"",6,"",5,"",5,"",4,""],["bd41","",7,"",7,""],["bd61","",5,"",13],["bd81","",5,"",25,""],["be41","",7,"",14],["be61","",7,"",7,""],["be81","",4,"",4,"",5,"",8,"",6,""],["bf41","",10,"",14],["bf61","",18,""],["bf81","",5,"",7,"",6,"",5,""],["c041","",5,"",6,"",5],["c061","",25],["c081","",6,"",5,"",7,""],["c141","",5,"",6,""],["c161","",19,""],["c181","",31,""],["c241","",4,"",5,""],["c261","",4,"",5,"",6,""],["c281","",5,"",7,"",9,""],["c341","",4],["c361","",4,"",5,"",11],["c381","",5,"",7,"",5,""],["c441","",7,"",7,""],["c461","",5,"",4],["c481","",5,"",11,""],["c541","",6,"",5,""],["c561","",6,"",5,"",4],["c581","",6,"",5,""],["c641","",6,"",5],["c6a1",""],["c7a1",""],["c8a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1","",5,"",4,""],["d2a1","",4,"",5,"",10,"",7,"",5,""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f5a1",""],["f6a1",""],["f7a1",""],["f8a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fda1",""]]'),Rc=JSON.parse('[["0","\\u0000",127],["a140",""],["a1a1","",4,""],["a240","",7,""],["a2a1","",9,"",9,"",8,"",25,"",21],["a340","",16,"",6,"",16,"",6,"",10],["a3a1","",25,""],["a3e1",""],["a440",""],["a4a1",""],["a540",""],["a5a1",""],["a640",""],["a6a1",""],["a740",""],["a7a1",""],["a840",""],["a8a1",""],["a940",""],["a9a1",""],["aa40",""],["aaa1",""],["ab40",""],["aba1",""],["ac40",""],["aca1",""],["ad40",""],["ada1",""],["ae40",""],["aea1",""],["af40",""],["afa1",""],["b040",""],["b0a1",""],["b140",""],["b1a1",""],["b240",""],["b2a1",""],["b340",""],["b3a1",""],["b440",""],["b4a1",""],["b540",""],["b5a1",""],["b640",""],["b6a1",""],["b740",""],["b7a1",""],["b840",""],["b8a1",""],["b940",""],["b9a1",""],["ba40",""],["baa1",""],["bb40",""],["bba1",""],["bc40",""],["bca1",""],["bd40",""],["bda1",""],["be40",""],["bea1",""],["bf40",""],["bfa1",""],["c040",""],["c0a1",""],["c140",""],["c1a1",""],["c240",""],["c2a1",""],["c340",""],["c3a1",""],["c440",""],["c4a1",""],["c540",""],["c5a1",""],["c640",""],["c940",""],["c9a1",""],["ca40",""],["caa1",""],["cb40",""],["cba1",""],["cc40",""],["cca1",""],["cd40",""],["cda1",""],["ce40",""],["cea1",""],["cf40",""],["cfa1",""],["d040",""],["d0a1",""],["d140",""],["d1a1",""],["d240",""],["d2a1",""],["d340",""],["d3a1",""],["d440",""],["d4a1",""],["d540",""],["d5a1",""],["d640",""],["d6a1",""],["d740",""],["d7a1",""],["d840",""],["d8a1",""],["d940",""],["d9a1",""],["da40",""],["daa1",""],["db40",""],["dba1",""],["dc40",""],["dca1",""],["dd40",""],["dda1",""],["de40",""],["dea1",""],["df40",""],["dfa1",""],["e040",""],["e0a1",""],["e140",""],["e1a1",""],["e240",""],["e2a1",""],["e340",""],["e3a1",""],["e440",""],["e4a1",""],["e540",""],["e5a1",""],["e640",""],["e6a1",""],["e740",""],["e7a1",""],["e840",""],["e8a1",""],["e940",""],["e9a1",""],["ea40",""],["eaa1",""],["eb40",""],["eba1",""],["ec40",""],["eca1",""],["ed40",""],["eda1",""],["ee40",""],["eea1",""],["ef40",""],["efa1",""],["f040",""],["f0a1",""],["f140",""],["f1a1",""],["f240",""],["f2a1",""],["f340",""],["f3a1",""],["f440",""],["f4a1",""],["f540",""],["f5a1",""],["f640",""],["f6a1",""],["f740",""],["f7a1",""],["f840",""],["f8a1",""],["f940",""],["f9a1",""]]'),Mf=[["8740",""],["8767",""],["87a1",""],["8840","",4,""],["88a1",""],["8940",""],["8943",""],["8946",""],["894c",""],["89a1",""],["89ab",""],["89b0",""],["89b5",""],["89c1",""],["89c5",""],["8a40",""],["8a43",""],["8a64",""],["8a76",""],["8aa1",""],["8aac",""],["8ab2",""],["8abb",""],["8ac9",""],["8ace",""],["8adf",""],["8af6",""],["8b40",""],["8b55",""],["8ba1",""],["8bde",""],["8c40",""],["8ca1",""],["8ca7",""],["8cc9",""],["8cce",""],["8ce6",""],["8d40",""],["8d42",""],["8da1",""],["8e40",""],["8ea1",""],["8f40",""],["8fa1",""],["9040",""],["90a1",""],["9140",""],["91a1",""],["9240",""],["92a1",""],["9340",""],["93a1",""],["9440",""],["94a1",""],["9540",""],["95a1",""],["9640",""],["96a1",""],["9740",""],["97a1",""],["9840",""],["98a1",""],["9940",""],["99a1",""],["9a40",""],["9aa1",""],["9b40",""],["9b62",""],["9ba1",""],["9c40",""],["9ca1",""],["9d40",""],["9da1",""],["9e40",""],["9ea1",""],["9ead",""],["9ec5",""],["9ef5",""],["9f40",""],["9f4f",""],["9fa1",""],["9fae",""],["9fb2",""],["9fc1",""],["9fc9",""],["9fdb",""],["9fe7",""],["9feb",""],["9ff0",""],["a040",""],["a055",""],["a058",""],["a05b",""],["a063",""],["a073",""],["a0a1",""],["a0a6",""],["a0ae",""],["a0b0",""],["a0d4",""],["a0e2",""],["a3c0","",31,""],["c6a1","",9,"",9,"",9,"",23],["c740","",58,""],["c7a1","",81,"",5,"",4],["c840","",26,"",25,""],["c8a1",""],["c8cd",""],["c8f5",""],["f9fe",""],["fa40",""],["faa1",""],["fb40",""],["fba1",""],["fc40",""],["fca1",""],["fd40",""],["fda1",""],["fe40",""],["fea1",""]];var aa,kc;function Cf(){return kc||(kc=1,aa={shiftjis:{type:"_dbcs",table:function(){return Af},encodeAdd:{"":92,"":126},encodeSkipVals:[{from:60736,to:63808}]},csshiftjis:"shiftjis",mskanji:"shiftjis",sjis:"shiftjis",windows31j:"shiftjis",ms31j:"shiftjis",xsjis:"shiftjis",windows932:"shiftjis",ms932:"shiftjis",932:"shiftjis",cp932:"shiftjis",eucjp:{type:"_dbcs",table:function(){return Sf},encodeAdd:{"":92,"":126}},gb2312:"cp936",gb231280:"cp936",gb23121980:"cp936",csgb2312:"cp936",csiso58gb231280:"cp936",euccn:"cp936",windows936:"cp936",ms936:"cp936",936:"cp936",cp936:{type:"_dbcs",table:function(){return ia}},gbk:{type:"_dbcs",table:function(){return ia.concat(Cc)}},xgbk:"gbk",isoir58:"gbk",gb18030:{type:"_dbcs",table:function(){return ia.concat(Cc)},gb18030:function(){return Bf},encodeSkipVals:[128],encodeAdd:{"":41699}},chinese:"gb18030",windows949:"cp949",ms949:"cp949",949:"cp949",cp949:{type:"_dbcs",table:function(){return If}},cseuckr:"cp949",csksc56011987:"cp949",euckr:"cp949",isoir149:"cp949",korean:"cp949",ksc56011987:"cp949",ksc56011989:"cp949",ksc5601:"cp949",windows950:"cp950",ms950:"cp950",950:"cp950",cp950:{type:"_dbcs",table:function(){return Rc}},big5:"big5hkscs",big5hkscs:{type:"_dbcs",table:function(){return Rc.concat(Mf)},encodeSkipVals:[36457,36463,36478,36523,36532,36557,36560,36695,36713,36718,36811,36862,36973,36986,37060,37084,37105,37311,37551,37552,37553,37554,37585,37959,38090,38361,38652,39285,39798,39800,39803,39878,39902,39916,39926,40002,40019,40034,40040,40043,40055,40124,40125,40144,40279,40282,40388,40431,40443,40617,40687,40701,40800,40907,41079,41180,41183,36812,37576,38468,38637,41636,41637,41639,41638,41676,41678]},cnbig5:"big5hkscs",csbig5:"big5hkscs",xxbig5:"big5hkscs"}),aa}var Dc;function Rf(){return Dc||(Dc=1,(function(s){for(var t=pl(),r=[gf(),bf(),yf(),vf(),wf(),xf(),Ef(),_f(),Cf()],e=0;e<r.length;e++){var n=r[e];t(s,n)}})(Ji)),Ji}var sa,Lc;function kf(){if(Lc)return sa;Lc=1;var s=Ze().Buffer;return sa=function(t){var r=t.Transform;function e(i,f){this.conv=i,f=f||{},f.decodeStrings=!1,r.call(this,f)}e.prototype=Object.create(r.prototype,{constructor:{value:e}}),e.prototype._transform=function(i,f,a){if(typeof i!="string")return a(new Error("Iconv encoding stream needs strings as its input."));try{var l=this.conv.write(i);l&&l.length&&this.push(l),a()}catch(c){a(c)}},e.prototype._flush=function(i){try{var f=this.conv.end();f&&f.length&&this.push(f),i()}catch(a){i(a)}},e.prototype.collect=function(i){var f=[];return this.on("error",i),this.on("data",function(a){f.push(a)}),this.on("end",function(){i(null,s.concat(f))}),this};function n(i,f){this.conv=i,f=f||{},f.encoding=this.encoding="utf8",r.call(this,f)}return n.prototype=Object.create(r.prototype,{constructor:{value:n}}),n.prototype._transform=function(i,f,a){if(!s.isBuffer(i)&&!(i instanceof Uint8Array))return a(new Error("Iconv decoding stream needs buffers as its input."));try{var l=this.conv.write(i);l&&l.length&&this.push(l,this.encoding),a()}catch(c){a(c)}},n.prototype._flush=function(i){try{var f=this.conv.end();f&&f.length&&this.push(f,this.encoding),i()}catch(a){i(a)}},n.prototype.collect=function(i){var f="";return this.on("error",i),this.on("data",function(a){f+=a}),this.on("end",function(){i(null,f)}),this},{IconvLiteEncoderStream:e,IconvLiteDecoderStream:n}},sa}var Oc;function Df(){return Oc||(Oc=1,(function(s){var t=Ze().Buffer,r=mf(),e=pl(),n=s.exports;n.encodings=null,n.defaultCharUnicode="",n.defaultCharSingleByte="?",n.encode=function(a,l,c){a=""+(a||"");var o=n.getEncoder(l,c),d=o.write(a),u=o.end();return u&&u.length>0?t.concat([d,u]):d},n.decode=function(a,l,c){typeof a=="string"&&(n.skipDecodeWarning||(console.error("Iconv-lite warning: decode()-ing strings is deprecated. Refer to https://github.com/ashtuchkin/iconv-lite/wiki/Use-Buffers-when-decoding"),n.skipDecodeWarning=!0),a=t.from(""+(a||""),"binary"));var o=n.getDecoder(l,c),d=o.write(a),u=o.end();return u?d+u:d},n.encodingExists=function(a){try{return n.getCodec(a),!0}catch{return!1}},n.toEncoding=n.encode,n.fromEncoding=n.decode,n._codecDataCache={__proto__:null},n.getCodec=function(a){if(!n.encodings){var l=Rf();n.encodings={__proto__:null},e(n.encodings,l)}for(var c=n._canonicalizeEncoding(a),o={};;){var d=n._codecDataCache[c];if(d)return d;var u=n.encodings[c];switch(typeof u){case"string":c=u;break;case"object":for(var h in u)o[h]=u[h];o.encodingName||(o.encodingName=c),c=u.type;break;case"function":return o.encodingName||(o.encodingName=c),d=new u(o,n),n._codecDataCache[o.encodingName]=d,d;default:throw new Error("Encoding not recognized: '"+a+"' (searched as: '"+c+"')")}}},n._canonicalizeEncoding=function(f){return(""+f).toLowerCase().replace(/:\d{4}$|[^0-9a-z]/g,"")},n.getEncoder=function(a,l){var c=n.getCodec(a),o=new c.encoder(l,c);return c.bomAware&&l&&l.addBOM&&(o=new r.PrependBOM(o,l)),o},n.getDecoder=function(a,l){var c=n.getCodec(a),o=new c.decoder(l,c);return c.bomAware&&!(l&&l.stripBOM===!1)&&(o=new r.StripBOM(o,l)),o},n.enableStreamingAPI=function(a){if(!n.supportsStreams){var l=kf()(a);n.IconvLiteEncoderStream=l.IconvLiteEncoderStream,n.IconvLiteDecoderStream=l.IconvLiteDecoderStream,n.encodeStream=function(o,d){return new n.IconvLiteEncoderStream(n.getEncoder(o,d),d)},n.decodeStream=function(o,d){return new n.IconvLiteDecoderStream(n.getDecoder(o,d),d)},n.supportsStreams=!0}};var i;try{i=Qr()}catch{}i&&i.Transform?n.enableStreamingAPI(i):n.encodeStream=n.decodeStream=function(){throw new Error("iconv-lite Streaming API is not enabled. Use iconv.enableStreamingAPI(require('stream')); to enable it.")}})(Zi)),Zi.exports}var Lf=Df();const Rt=va(Lf);function dt(s){return s?s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"):""}function Of(s){if(!s)return null;try{const t=decodeURIComponent(s);return t!==s?t:null}catch{return null}}function Nf(s){return Cl[s]||kl}function ml(s){return s?s.replace(/[<>]/g,"").trim():""}function Pf(s){return s?s.toLowerCase().startsWith("image/"):!1}function Uf(s,t){const r=[],e=ml(s),n=e?Of(e):null;return e&&(r.push(`src=["']?cid:${dt(e)}["']?`),r.push(`src=["']?cid:<${dt(e)}>["']?`),r.push(`src=["']?${dt(e)}["']?`),r.push(`src=["']?cid:${dt(e)}[^"'\\s>]*["']?`),n&&(r.push(`src=["']?cid:${dt(n)}["']?`),r.push(`src=["']?${dt(n)}["']?`))),t&&(r.push(`src=["']?cid:${dt(t)}["']?`),r.push(`src=["']?cid:${dt(t)}[^"'\\s>]*["']?`),r.push(`src=["']?${dt(t)}["']?`)),r}function Hf(s,t){const r=t.pidContentId||t.contentId||"",e=t.fileName||"",n=t.contentBase64,i=Uf(r,e);let f=s;return i.forEach(a=>{f=f.replace(new RegExp(a,"gi"),`src="${n}"`)}),f}function jf(s,t){const r=t.pidContentId||t.contentId||"";if(!r)return s;const e=ml(r),n=t.contentBase64;return s.replace(new RegExp(`href=["']?cid:${dt(e)}["']?`,"gi"),`href="${n}"`)}function gl(s,t){if(!s)return"";let r=s;return t&&t.length>0&&t.forEach(e=>{e.contentBase64&&(Pf(e.attachMimeTag)?r=Hf(r,e):(e.contentId||e.pidContentId)&&(r=jf(r,e)))}),r=r.replace(/src=["']?cid:[^"'\s>]+["']?/gi,`src="${Rl}"`),r}function bl(s){if(!s)return"attachment";let t=s.replace(/\.\.\//g,"").replace(/\.\.\\/g,"").replace(/^\/+/g,"").replace(/^[A-Za-z]:[\\/]/g,"").replace(/[\x00-\x1f\x7f]/g,"").replace(/\ufeff/g,"").replace(/\ufffd/g,"").replace(/[<>:"|?*]/g,"_").replace(/[_=]+$/,"").trim();return t=t.split("/").pop().split("\\").pop(),t||"attachment"}function Ma(s){return s?s.replace(/=\?([^?]+)\?([BQbq])\?([^?]*)\?=/g,(t,r,e,n)=>{try{if(e.toUpperCase()==="B"){const i=atob(n);return Rt.decode(gt.from(i,"binary"),r)}else if(e.toUpperCase()==="Q"){n=n.replace(/_/g," ");const i=n.replace(/=([0-9A-F]{2})/gi,(f,a)=>String.fromCharCode(parseInt(a,16)));return Rt.decode(gt.from(i,"binary"),r)}}catch(i){console.error("Error decoding MIME word:",i)}return t}):""}function br(s,t="attachment"){if(!s)return t;const r=s.match(/filename\*=([^']*)'([^']*)'([^;\s]+)/i);if(r){const n=r[3];try{return decodeURIComponent(n)}catch(i){console.error("Error decoding RFC 2231 filename:",i)}}const e=s.match(/filename="?([^";\n]+)"?/i);if(e){let n=e[1];return n=Ma(n),n=n.replace(/[_=]+$/,""),n}return t}function Ca(s){const t={};let r="";return s.split(/\r?\n/).forEach(e=>{if(e.match(/^\s+/))r&&(t[r]+=" "+e.trim());else{const n=e.match(/^([\w-]+):\s*(.*)$/i);n&&(r=n[1].toLowerCase().trim(),t[r]=n[2].trim())}}),t}function yr(s,t,r,e=!0){const n=(t||"").toLowerCase();if(n==="base64"){if(e)try{const i=gt.from(s.replace(/\s/g,""),"base64");return Rt.decode(i,r)}catch(i){return console.error("Error decoding base64 content:",i),s}return s}else if(n==="quoted-printable"){const i=s.replace(/=\r?\n/g,"").replace(/=([0-9A-F]{2})/gi,(a,l)=>String.fromCharCode(parseInt(l,16))),f=gt.from(i,"binary");return Rt.decode(f,r)}return s.trim()}function oa(s){return s?(s.match(/(?:"([^"]*)")?\s*(?:<([^>]+)>|([^\s,]+@[^\s,]+))/g)||[]).map(r=>{const e=r.match(/(?:"([^"]*)")?\s*(?:<([^>]+)>|([^\s,]+@[^\s,]+))/),n=e[2]||e[3],i=e[1]||n;return{name:Ma(i),address:n}}):[]}function vr(s,t,r,e=null){const n={fileName:bl(s),attachMimeTag:t,contentLength:Math.floor(r.length*Dl),contentBase64:`data:${t};base64,${r}`};return e&&(n.contentId=e.replace(/[<>]/g,"").trim()),n}function yl(s,t,r=0,e="utf-8"){const n={bodyHTML:"",bodyText:"",attachments:[]},i=new RegExp(`--${t}(?:--)?(?:\r?
|\r|$)`,"g");return s.split(i).filter(a=>a.trim()).forEach(a=>{const l=a.match(/^([\s\S]*?)\r?\n\r?\n([\s\S]*)$/);if(!l)return;const[,c,o]=l,d=Ca(c),u=d["content-type"]||"",h=d["content-transfer-encoding"]||"",v=d["content-disposition"]||"",w=d["content-id"]||"",A=u.match(/charset="?([^";\s]+)"?/i),_=A?A[1]:e,E=u.match(/boundary="?([^";\s]+)"?/);if(E){const g=yl(o,E[1],r+1,_);g.bodyHTML&&(n.bodyHTML=n.bodyHTML?n.bodyHTML+`
`+g.bodyHTML:g.bodyHTML),g.bodyText&&(n.bodyText=n.bodyText?n.bodyText+`
`+g.bodyText:g.bodyText),n.attachments.push(...g.attachments);return}if(v.toLowerCase().startsWith("attachment")){const g=br(v),S=u.split(";")[0]||"application/octet-stream";let B;if(h.toLowerCase()==="base64")B=o.replace(/\s/g,"");else{const D=yr(o.trim(),h,_);B=btoa(unescape(encodeURIComponent(D)))}const k=vr(g,S,B,w);n.attachments.push(k)}else if(u.startsWith("text/html")){const g=yr(o.trim(),h,_);n.bodyHTML=n.bodyHTML?n.bodyHTML+`
`+g:g}else if(u.startsWith("text/plain")){const g=yr(o.trim(),h,_);n.bodyText=n.bodyText?n.bodyText+`
`+g:g}else if(u.startsWith("image/")||u.startsWith("application/")){const g=br(v),S=u.split(";")[0];let B;h.toLowerCase()==="base64"?B=o.replace(/\s/g,""):B=gt.from(o,"binary").toString("base64");const k=vr(g,S,B,w);if(!w){const D=d["content-location"]||"";D&&(k.contentId=D.replace(/[<>]/g,"").trim())}n.attachments.push(k)}else if(u.startsWith("message/")){const g=br(v,"embedded_message.eml"),S=u.split(";")[0];let B;h.toLowerCase()==="base64"?B=o.replace(/\s/g,""):B=btoa(unescape(encodeURIComponent(o)));const k=vr(g,S,B,w);n.attachments.push(k)}else if(u.startsWith("text/")){const g=br(v);if(g&&g!=="attachment"){const S=u.split(";")[0],B=yr(o.trim(),h,_),k=btoa(unescape(encodeURIComponent(B))),D=vr(g,S,k,w);n.attachments.push(D)}}}),n}function qf(s){try{let t=null,r=null;if(typeof tr=="function")t=new tr(s),r=t.getFileData();else if(tr&&typeof tr.default=="function")t=new tr.default(s),r=t.getFileData();else return console.error("MsgReader constructor could not be found."),null;return{reader:t,info:r}}catch(t){return console.error("Error creating a MsgReader instance:",t),null}}function $f(s,t=null){const r=s.bodyHTML||s.body||"";if(s.html&&typeof s.html=="object")try{const e=Array.isArray(s.html)?Uint8Array.from(s.html):Uint8Array.from(Object.values(s.html)),n=Nf(s.internetCodepage);t&&(t.htmlSource="uint8array",t.htmlRawBytes=e,t.charset=n);let i;if(typeof TextDecoder<"u")try{i=new TextDecoder(n).decode(e)}catch{i=Rt.decode(gt.from(e),n)}else i=Rt.decode(gt.from(e),n);return t&&(t.htmlBeforeCid=i),i}catch(e){console.error("Failed to decode HTML from Uint8Array:",e)}if(s.compressedRtf)try{const e=Uint8Array.from(Object.values(s.compressedRtf)),n=j0.decompressRTF(e);t&&(t.htmlSource="rtf",t.compressedRtf=e,t.decompressedRtf=typeof n=="string"?n:new TextDecoder("latin1").decode(n instanceof Uint8Array?n:Uint8Array.from(Object.values(n))));const i=Wf(n);return t&&(t.rtfToHtml=i,t.htmlBeforeCid=i),i}catch(e){console.error("Failed to decompress or convert RTF:",e)}return t&&(t.htmlSource="fallback",t.htmlBeforeCid=r),r}function Gf(s,t){return t.map(r=>{const e=s.getAttachment(r).content,i=gt.from(e).toString("base64");return{...r,fileName:bl(r.fileName),contentBase64:`data:${r.attachMimeTag};base64,${i}`}})}function Nc(s,t={}){const{collectDebugData:r=!1}=t,e=r?{fileType:"msg",rawSize:s.byteLength,rawBuffer:s,timestamp:new Date().toISOString()}:null,n=qf(s);if(!n)return null;const{reader:i,info:f}=n,a=f.bodyHTML||f.body||"";e&&(e.msgInfoRaw=JSON.parse(JSON.stringify(f,(o,d)=>d instanceof Uint8Array||d instanceof ArrayBuffer?`[Binary: ${d.byteLength||d.length} bytes]`:o==="content"&&typeof d=="object"?"[Attachment content]":d)),e.plainText=a);let l=$f(f,e);f.attachments&&f.attachments.length>0&&(f.attachments=Gf(i,f.attachments),e&&(e.htmlBeforeCid=l),l=gl(l,f.attachments),e&&(e.htmlAfterCid=l,e.attachmentCount=f.attachments.length,e.attachments=f.attachments.map(o=>({fileName:o.fileName,mimeType:o.attachMimeTag,contentLength:o.contentLength,contentId:o.contentId||null})))),e&&(e.htmlFinal=l);const c={...f,bodyContent:a,bodyContentHTML:l};return e&&(c._debugData=e),c}function Wf(s){let t=s;if(typeof s!="string"){const e=s instanceof Uint8Array?s:Uint8Array.from(Object.values(s));t=new TextDecoder("latin1").decode(e)}return pf.deEncapsulateSync(t,{decode:Rt.decode}).text}function zf(s,t,r,e,n){const i={bodyHTML:"",bodyText:"",attachments:[]};if(t.startsWith("application/")||t.startsWith("image/")){const f=br(e),a=t.split(";")[0],l=r.toLowerCase()==="base64"?s.replace(/\s/g,""):gt.from(s).toString("base64");i.attachments.push(vr(f,a,l))}else{const f=yr(s,r,n);t.includes("text/html")?i.bodyHTML=f:i.bodyText=f}return i}function ba(s,t={}){const{collectDebugData:r=!1}=t,e=r?{fileType:"eml",rawSize:s.byteLength,rawBuffer:s,timestamp:new Date().toISOString()}:null;try{const n=gt.from(s).toString("binary");e&&(e.rawString=n);const i=n.match(/^([\s\S]*?)\r?\n\r?\n([\s\S]*)$/);if(!i)throw new Error("Could not split email into headers and body");const[,f,a]=i;e&&(e.headersRaw=f,e.bodyRaw=a);const l=Ca(f);e&&(e.headersParsed={...l});const c=l["content-type"]||"",o=c.match(/boundary="?([^";\s]+)"?/),d=c.match(/charset="?([^";\s]+)"?/i),u=d?d[1]:"utf-8";e&&(e.contentType=c,e.charset=u,e.isMultipart=!!o,e.boundary=o?o[1]:null);let h,v="";o?(h=yl(a,o[1],0,u),e&&(e.mimeStructure=vl(a,o[1])),v=h.bodyHTML,h.bodyHTML&&h.attachments.length>0&&(e&&(e.htmlBeforeCid=h.bodyHTML),h.bodyHTML=gl(h.bodyHTML,h.attachments),e&&(e.htmlAfterCid=h.bodyHTML))):(h=zf(a,c,l["content-transfer-encoding"]||"",l["content-disposition"]||"",u),v=h.bodyHTML),e&&(e.plainText=h.bodyText,e.htmlFinal=h.bodyHTML||h.bodyText,e.attachmentCount=h.attachments.length,e.attachments=h.attachments.map(g=>({fileName:g.fileName,mimeType:g.attachMimeTag,contentLength:g.contentLength,contentId:g.contentId||null})),e.htmlBeforeCid||(e.htmlBeforeCid=v));const w=oa(l.from)[0]||{name:"",address:""},A=oa(l.to),_=oa(l.cc),E=l.date?new Date(l.date):new Date,x={subject:Ma(l.subject)||"",senderName:w.name||w.address,senderEmail:w.address,recipients:[...A.map(g=>({...g,recipType:"to"})),..._.map(g=>({...g,recipType:"cc"}))],messageDeliveryTime:E.toISOString(),bodyContent:h.bodyText,bodyContentHTML:h.bodyHTML||h.bodyText,attachments:h.attachments};return e&&(x._debugData=e),x}catch(n){throw console.error("Error parsing EML file:",n),n}}function vl(s,t,r=0){const e={type:"multipart",boundary:t,parts:[]},n=new RegExp(`--${t}(?:--)?(?:\r?
|\r|$)`,"g");return s.split(n).filter(f=>f.trim()).forEach((f,a)=>{const l=f.match(/^([\s\S]*?)\r?\n\r?\n([\s\S]*)$/);if(!l)return;const[,c,o]=l,d=Ca(c),u=d["content-type"]||"text/plain",h={index:a,contentType:u.split(";")[0].trim(),headers:d,size:o.length},v=u.match(/boundary="?([^";\s]+)"?/);if(v&&(h.nested=vl(o,v[1],r+1)),d["content-disposition"]){h.disposition=d["content-disposition"].split(";")[0].trim();const w=d["content-disposition"].match(/filename="?([^";\n]+)"?/i);w&&(h.filename=w[1])}d["content-id"]&&(h.contentId=d["content-id"].replace(/[<>]/g,"")),e.parts.push(h)}),e}class Vf{constructor(t){this.showToast=t,this.attachmentModal=document.getElementById("attachmentModal"),this.attachmentModalBackdrop=this.attachmentModal?.querySelector(".attachment-modal-backdrop"),this.attachmentModalClose=document.getElementById("attachmentModalClose"),this.attachmentModalDownload=document.getElementById("attachmentModalDownload"),this.attachmentModalFilename=document.getElementById("attachmentModalFilename"),this.attachmentModalContent=document.getElementById("attachmentModalContent"),this.attachmentModalPrev=document.getElementById("attachmentModalPrev"),this.attachmentModalNext=document.getElementById("attachmentModalNext"),this.currentAttachmentIndex=0,this.previewableAttachments=[],this.currentAttachments=[],this.navigationStack=[],this.attachmentModalBack=document.getElementById("attachmentModalBack"),this.keyboardManager=null,this.initModalEventListeners()}setKeyboardManager(t){this.keyboardManager=t}setAttachments(t){this.currentAttachments=t||[]}getAttachments(){return this.currentAttachments}initModalEventListeners(){this.attachmentModal&&(this.attachmentModalClose?.addEventListener("click",()=>this.close()),this.attachmentModalBackdrop?.addEventListener("click",()=>this.close()),this.attachmentModalPrev?.addEventListener("click",()=>this.showPrevAttachment()),this.attachmentModalNext?.addEventListener("click",()=>this.showNextAttachment()),this.attachmentModalBack?.addEventListener("click",()=>this.navigateBack()),this.attachmentModalDownload?.addEventListener("click",t=>{it()&&(t.preventDefault(),this.downloadCurrentAttachment())}))}async downloadCurrentAttachment(){const t=this.previewableAttachments[this.currentAttachmentIndex];t&&await this.downloadAttachment(t)}async downloadAttachment(t){if(it())try{await pa(t.contentBase64,t.fileName)&&this.showToast&&this.showToast("File saved successfully","info")}catch(r){console.error("Failed to save file:",r),this.showToast&&this.showToast("Failed to save file","error")}else{const r=document.createElement("a");r.href=t.contentBase64,r.download=t.fileName,document.body.appendChild(r),r.click(),document.body.removeChild(r)}}isPreviewableImage(t){return t?["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/svg+xml","image/bmp"].includes(t.toLowerCase()):!1}isPdf(t){return t?t.toLowerCase()==="application/pdf":!1}isText(t){if(!t)return!1;const r=t.toLowerCase();return r.startsWith("text/")||r.startsWith("application/text")||r==="application/json"||r==="application/xml"||r==="application/javascript"||r==="application/x-diff"}isPreviewableEml(t){return t?t.toLowerCase()==="message/rfc822":!1}isPreviewable(t){return this.isPreviewableImage(t)||this.isPdf(t)||this.isText(t)||this.isPreviewableEml(t)}_shouldOpenWithSystemViewer(t){return it()&&this.isPdf(t.attachMimeTag)}_openPdfWithSystemViewer(t){yu(t.contentBase64,t.fileName).catch(r=>{console.error("Failed to open PDF with system viewer:",r),this.showToast&&this.showToast("Failed to open PDF","error")})}open(t){if(this.attachmentModal){if(this.clearNavigationStack(),this._shouldOpenWithSystemViewer(t)){this._openPdfWithSystemViewer(t);return}this.currentAttachments&&(this.previewableAttachments=this.currentAttachments.filter(r=>this.isPreviewable(r.attachMimeTag))),this.currentAttachmentIndex=this.previewableAttachments.findIndex(r=>r.fileName===t.fileName&&r.contentBase64===t.contentBase64),this.currentAttachmentIndex===-1&&(this.currentAttachmentIndex=0),this.renderAttachmentPreview(t),this.attachmentModal.classList.add("active"),document.body.style.overflow="hidden",this.keyboardManager&&this.keyboardManager.setContext("modal")}}renderAttachmentPreview(t){if(this.updateFilenameWithBreadcrumb(t.fileName),this.attachmentModalDownload.href=t.contentBase64,this.attachmentModalDownload.download=t.fileName,this.attachmentModalContent.innerHTML="",this.isPreviewableImage(t.attachMimeTag)){const r=document.createElement("img");r.src=t.contentBase64,r.alt=t.fileName,this.attachmentModalContent.appendChild(r)}else if(this.isPdf(t.attachMimeTag)){const r=document.createElement("object");r.data=t.contentBase64,r.type="application/pdf",r.innerHTML=`<p class="text-center p-4">PDF cannot be displayed. <a href="${t.contentBase64}" download="${t.fileName}" class="text-blue-500 underline">Download here</a></p>`,this.attachmentModalContent.appendChild(r)}else if(this.isText(t.attachMimeTag))try{const r=t.contentBase64?.split(",")[1];if(!r)throw new Error("Invalid base64 data format");const e=atob(r),n=document.createElement("pre");n.className="attachment-text-preview",n.textContent=e,this.attachmentModalContent.appendChild(n)}catch(r){console.error("Error decoding text attachment:",r);const e=document.createElement("div");e.className="text-center p-4 text-gray-500",e.textContent="Unable to preview this file",this.attachmentModalContent.appendChild(e)}else this.isPreviewableEml(t.attachMimeTag)&&this.renderNestedEmailPreview(t);this.updateNavButtons()}updateNavButtons(){const t=this.previewableAttachments.length,r=this.currentAttachmentIndex>0,e=this.currentAttachmentIndex<t-1;this.attachmentModalPrev.style.display=r?"flex":"none",this.attachmentModalNext.style.display=e?"flex":"none"}showPrevAttachment(){this.currentAttachmentIndex>0&&(this.currentAttachmentIndex--,this.renderAttachmentPreview(this.previewableAttachments[this.currentAttachmentIndex]))}showNextAttachment(){this.currentAttachmentIndex<this.previewableAttachments.length-1&&(this.currentAttachmentIndex++,this.renderAttachmentPreview(this.previewableAttachments[this.currentAttachmentIndex]))}pushToStack(t){this.navigationStack.push(t),this.updateBackButton()}navigateBack(){if(this.navigationStack.length>0){const t=this.navigationStack.pop();this.renderAttachmentPreview(t),this.updateBackButton()}}updateBackButton(){this.attachmentModalBack&&(this.attachmentModalBack.style.display=this.navigationStack.length>0?"flex":"none")}clearNavigationStack(){this.navigationStack=[],this.updateBackButton()}updateFilenameWithBreadcrumb(t){if(this.attachmentModalFilename.innerHTML="",this.navigationStack.length>0){this.navigationStack.forEach((e,n)=>{const i=document.createElement("button");i.type="button",i.className="breadcrumb-link",i.textContent=e.fileName,i.addEventListener("click",()=>{for(;this.navigationStack.length>n;)this.navigationStack.pop();this.renderAttachmentPreview(e),this.updateBackButton()}),this.attachmentModalFilename.appendChild(i);const f=document.createElement("span");f.className="breadcrumb-separator",f.textContent="  ",this.attachmentModalFilename.appendChild(f)});const r=document.createElement("span");r.className="breadcrumb-current",r.textContent=t,this.attachmentModalFilename.appendChild(r)}else this.attachmentModalFilename.textContent=t}renderNestedEmailPreview(t){try{const r=t.contentBase64?.split(",")[1];if(!r)throw new Error("Invalid base64 data format");const e=decodeURIComponent(escape(atob(r))),f=new TextEncoder().encode(e).buffer,a=ba(f),l=document.createElement("div");l.className="nested-email-preview";const c=document.createElement("div");c.className="nested-email-header",[{label:"From",value:a.senderName?`${a.senderName} <${a.senderEmail}>`:a.senderEmail},{label:"To",value:this.formatRecipients(a.recipients,"to")},{label:"CC",value:this.formatRecipients(a.recipients,"cc")},{label:"Subject",value:a.subject},{label:"Date",value:a.messageDeliveryTime?new Date(a.messageDeliveryTime).toLocaleString():""}].forEach(u=>{if(u.value){const h=document.createElement("div");h.className="nested-email-header-row",h.innerHTML=`<span class="nested-email-label">${u.label}:</span> <span class="nested-email-value">${this.escapeHtml(u.value)}</span>`,c.appendChild(h)}}),l.appendChild(c);const d=document.createElement("div");if(d.className="nested-email-body",a.bodyContentHTML){const u=document.createElement("iframe");u.className="nested-email-iframe",u.sandbox="allow-same-origin",d.appendChild(u),setTimeout(()=>{const h=u.contentDocument||u.contentWindow.document;h.open(),h.write(`
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <style>
                                body { font-family: system-ui, -apple-system, sans-serif; font-size: 14px; margin: 1rem; color: #333; }
                                img { max-width: 100%; height: auto; }
                            </style>
                        </head>
                        <body>${a.bodyContentHTML}</body>
                        </html>
                    `),h.close()},0)}else if(a.bodyContent){const u=document.createElement("pre");u.className="nested-email-text",u.textContent=a.bodyContent,d.appendChild(u)}if(l.appendChild(d),a.attachments&&a.attachments.length>0){const u=document.createElement("div");u.className="nested-email-attachments",u.innerHTML=`<div class="nested-email-attachments-title">Attachments (${a.attachments.length})</div>`;const h=document.createElement("div");h.className="nested-email-attachments-list",a.attachments.forEach(v=>{const w=this.isPreviewable(v.attachMimeTag),A=this.isPreviewableImage(v.attachMimeTag),_=this.isPdf(v.attachMimeTag),E=this.isText(v.attachMimeTag),x=this.isPreviewableEml(v.attachMimeTag),g=()=>A?`<img src="${v.contentBase64}" alt="Attachment" class="w-10 h-10 object-cover">`:_?`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-red-500">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                            </svg>`:E?`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 attachment-icon">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                            </svg>`:x?`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-blue-500">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />
                            </svg>`:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 attachment-icon">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                        </svg>`,S=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
                    </svg>`;if(w){const B=document.createElement("div");B.className="nested-email-attachment-item nested-email-attachment-previewable cursor-pointer",B.title="Click to preview",B.innerHTML=`
                            <div class="attachment-thumbnail w-10 h-10 shrink-0 flex items-center justify-center overflow-hidden">
                                ${g()}
                            </div>
                            <div class="flex-1 min-w-0">
                                <p class="attachment-filename">${this.escapeHtml(v.fileName)}</p>
                                <p class="attachment-meta">${v.attachMimeTag} - ${this.formatFileSize(v.contentLength)}</p>
                            </div>
                            <button class="ml-auto pl-2 attachment-download-btn nested-download-btn"
                                    title="Download">
                                ${S}
                            </button>
                        `,B.addEventListener("click",k=>{k.target.closest(".nested-download-btn")?(k.stopPropagation(),this.downloadAttachment(v)):this._shouldOpenWithSystemViewer(v)?this._openPdfWithSystemViewer(v):(this.pushToStack(t),this.renderAttachmentPreview(v))}),h.appendChild(B)}else{const B=document.createElement("div");B.className="nested-email-attachment-item cursor-pointer",B.title="Click to download",B.innerHTML=`
                            <div class="attachment-thumbnail w-10 h-10 shrink-0 flex items-center justify-center">
                                ${g()}
                            </div>
                            <div class="flex-1 min-w-0">
                                <p class="attachment-filename">${this.escapeHtml(v.fileName)}</p>
                                <p class="attachment-meta">${v.attachMimeTag} - ${this.formatFileSize(v.contentLength)}</p>
                            </div>
                            <div class="ml-auto pl-2 attachment-download-btn">
                                ${S}
                            </div>
                        `,B.addEventListener("click",()=>{this.downloadAttachment(v)}),h.appendChild(B)}}),u.appendChild(h),l.appendChild(u)}this.attachmentModalContent.appendChild(l)}catch(r){console.error("Error rendering nested email:",r);const e=document.createElement("div");e.className="text-center p-4 text-gray-500",e.textContent="Unable to preview this email file",this.attachmentModalContent.appendChild(e)}}formatRecipients(t,r){return!t||!Array.isArray(t)?"":t.filter(e=>e.recipType===r).map(e=>{const n=e.name||"",i=e.smtpAddress||e.email||e.address||"";return n&&n!==i?`${n} <${i}>`:i}).join(", ")}escapeHtml(t){if(!t)return"";const r=document.createElement("div");return r.textContent=t,r.innerHTML}formatFileSize(t){return t?t<1024?t+" B":t<1024*1024?(t/1024).toFixed(1)+" KB":(t/(1024*1024)).toFixed(1)+" MB":""}handleEscape(){return this.navigationStack.length>0?(this.navigateBack(),!0):!1}close(){this.attachmentModal&&(this.attachmentModal.classList.remove("active"),this.attachmentModalContent.innerHTML="",this.clearNavigationStack(),document.body.style.overflow="",this.keyboardManager&&this.keyboardManager.setContext("main"))}}class Yf{constructor(){this.container=null,this.initEventDelegation()}initEventDelegation(){document.body.addEventListener("click",t=>{const r=t.target.closest('[data-action="close-toast"]');if(r){const e=r.closest(".toast");e&&(e.classList.add("translate-x-full","opacity-0"),setTimeout(()=>e.remove(),300))}})}getContainer(){return this.container||(this.container=document.getElementById("toast-container")),this.container||(this.container=document.createElement("div"),this.container.id="toast-container",this.container.className="fixed bottom-4 right-4 z-50 flex flex-col gap-2",document.body.appendChild(this.container)),this.container}show(t,r="info",e=Tr[r]||3e3){const n=this.getContainer(),i=document.createElement("div");i.className=`toast toast-${r} flex items-center gap-3 px-4 py-3 rounded-lg shadow-lg transform transition-all duration-300 translate-x-full opacity-0`,i.className+=` ${Ga[r]||Ga.info}`;const f={error:'<svg class="w-5 h-5 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>',warning:'<svg class="w-5 h-5 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>',info:'<svg class="w-5 h-5 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>'};i.innerHTML=`
            ${f[r]||f.info}
            <span class="grow">${t}</span>
            <button class="ml-2 hover:opacity-75 focus:outline-none" data-action="close-toast">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
        `,n.appendChild(i),requestAnimationFrame(()=>{i.classList.remove("translate-x-full","opacity-0")}),setTimeout(()=>{i.classList.add("translate-x-full","opacity-0"),setTimeout(()=>i.remove(),300)},e)}error(t,r=Tr.error){this.show(t,"error",r)}warning(t,r=Tr.warning){this.show(t,"warning",r)}info(t,r=Tr.info){this.show(t,"info",r)}}class Kf{constructor(t){this.messageHandler=t,this.currentQuery="",this.searchTerms=[],this.debounceTimer=null}search(t){return this.currentQuery=t.toLowerCase().trim(),this.searchTerms=this.currentQuery.split(/\s+/).filter(Boolean),this.currentQuery?this.messageHandler.getMessages().filter(r=>this.matchesQuery(r)):this.messageHandler.getMessages()}matchesQuery(t){const r=[t.subject,t.senderName,t.senderEmail,t.senderSmtpAddress,t.body,t.bodyContent,this.stripHtml(t.bodyContentHTML),t.recipients?.map(n=>`${n.name||""} ${n.email||""} ${n.address||""}`).join(" ")].filter(Boolean).join(" ").toLowerCase(),e=this.normalizeText(r);return this.searchTerms.every(n=>{const i=this.normalizeText(n);return r.includes(n)||e.includes(i)})}normalizeText(t){return t?t.replace(/[.\-_@]/g," ").replace(/\s+/g," "):""}stripHtml(t){return t?t.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim():""}searchDebounced(t,r,e=300){clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{const n=this.search(t);r(n)},e)}clearSearch(){return this.currentQuery="",this.searchTerms=[],clearTimeout(this.debounceTimer),this.messageHandler.getMessages()}getQuery(){return this.currentQuery}highlightMatches(t){if(!this.currentQuery||!t)return t;const r=new RegExp(`(${this.escapeRegex(this.currentQuery)})`,"gi");return t.replace(r,'<mark class="search-highlight">$1</mark>')}escapeRegex(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}isSearchActive(){return this.currentQuery.length>0}getResultCount(){return this.isSearchActive()?this.search(this.currentQuery).length:this.messageHandler.getMessages().length}}const Ke=`\r
`,Pc=76;function Yr(s){return String(s||"").replace(/[\x00-\x1f\x7f]/g," ").replace(/[\r\n]+/g," ").trim()}function zr(s){return String(s||"").replace(/\.\.\//g,"").replace(/\.\.\\/g,"").replace(/^\/+/,"").replace(/^[A-Za-z]:[\\/]/g,"").replace(/[\x00-\x1f\x7f]/g,"").replace(/[<>:"|?*]/g,"_").replace(/[/\\]/g,"_").trim()||"message.eml"}function ya(s){return String(s||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`).replace(/\n/g,Ke)}function wl(s){let t="";for(let e=0;e<s.length;e+=32768){const n=s.subarray(e,e+32768);t+=String.fromCharCode(...n)}return btoa(t)}function wr(s){const r=new TextEncoder().encode(s);return wl(r)}function Kr(s){if(!s)return"";const t=[];for(let r=0;r<s.length;r+=Pc)t.push(s.slice(r,r+Pc));return t.join(Ke)}function xl(s){const t=Yr(s);return t?/[^\x00-\x7f]/.test(t)?`=?UTF-8?B?${wr(t)}?=`:t:""}function El(s){const t=Yr(s?.address||"");if(!t)return"";const r=Yr(s?.name||"");if(!r||r===t)return`<${t}>`;const e=/[^\x00-\x7f]/.test(r)?xl(r):r;return e.startsWith("=?UTF-8?B?")?`${e} <${t}>`:`${/[",<>@]/.test(e)?`"${e.replace(/"/g,'\\"')}"`:e} <${t}>`}function Zf(s){const t=s?.smtpAddress||s?.email||s?.address||"";return{name:s?.name||t,address:t}}function Uc(s,t){return Array.isArray(s)?s.filter(e=>e?.recipType===t).map(e=>El(Zf(e))).filter(Boolean).join(", "):""}function Xf(s){const t=s?.messageDeliveryTime||s?.timestamp||null;if(!t)return"";const r=new Date(t);return Number.isNaN(r.getTime())?"":r.toUTCString()}function ca(s){const t=Math.random().toString(16).slice(2);return`${s}-${Date.now()}-${t}`}function Jf(s){if(!s)return"";const t=s.indexOf(",");return t===-1?s:s.slice(t+1)}function Zr(s,t){const r=ya(s||""),e=Kr(wr(r));return[`Content-Type: ${t}; charset="utf-8"`,"Content-Transfer-Encoding: base64","",e]}function Hc(s,t,r,e){const n=[];return e&&(n.push(`Content-Type: multipart/alternative; boundary="${s}"`),n.push("")),n.push(`--${s}`),n.push(...Zr(t,"text/plain")),n.push(`--${s}`),n.push(...Zr(r,"text/html")),n.push(`--${s}--`),n}function Qf(s){const t=s?.attachMimeTag||"application/octet-stream",r=zr(s?.fileName||"attachment"),e=Jf(s?.contentBase64||"");if(!e)return null;const n=[`Content-Type: ${t}; name="${r}"`,"Content-Transfer-Encoding: base64"];if(s?.contentId){const f=Yr(s.contentId).replace(/[<>]/g,"");f&&n.push(`Content-ID: <${f}>`)}const i=s?.contentId?"inline":"attachment";return n.push(`Content-Disposition: ${i}; filename="${r}"`),n.push(""),n.push(Kr(e)),n}function ed(s){const t=[],r=xl(s?.subject||"");r&&t.push(`Subject: ${r}`);const e=El({name:s?.senderName||"",address:s?.senderEmail||""});e&&t.push(`From: ${e}`);const n=Uc(s?.recipients,"to");n&&t.push(`To: ${n}`);const i=Uc(s?.recipients,"cc");i&&t.push(`Cc: ${i}`);const f=Xf(s);f&&t.push(`Date: ${f}`),t.push("MIME-Version: 1.0");const a=Array.isArray(s?.attachments)?s.attachments:[],l=ya(s?.bodyContent||""),c=ya(s?.bodyContentHTML||""),o=l.trim().length>0,d=c.trim().length>0,u=o&&d;if(a.length>0){const h=ca("mixed");t.push(`Content-Type: multipart/mixed; boundary="${h}"`);const v=[];if(u){const w=ca("alt");v.push(`--${h}`),v.push(...Hc(w,l,c,!0))}else if(d||o){const w=d?"text/html":"text/plain";v.push(`--${h}`),v.push(...Zr(d?c:l,w))}else v.push(`--${h}`),v.push(...Zr("","text/plain"));return a.forEach(w=>{const A=Qf(w);A&&(v.push(`--${h}`),v.push(...A))}),v.push(`--${h}--`),t.join(Ke)+Ke+Ke+v.join(Ke)}if(u){const h=ca("alt");t.push(`Content-Type: multipart/alternative; boundary="${h}"`);const v=Hc(h,l,c,!1);return t.join(Ke)+Ke+Ke+v.join(Ke)}if(d||o){const h=d?"text/html":"text/plain";t.push(`Content-Type: ${h}; charset="utf-8"`),t.push("Content-Transfer-Encoding: base64");const v=Kr(wr(d?c:l));return t.join(Ke)+Ke+Ke+v}return t.push('Content-Type: text/plain; charset="utf-8"'),t.push("Content-Transfer-Encoding: base64"),t.join(Ke)+Ke+Ke+Kr(wr(""))}function td(s){const t=String(s?.fileName||"").trim();if(t){if(/\.eml$/i.test(t))return zr(t);if(/\.msg$/i.test(t))return zr(t.replace(/\.msg$/i,".eml"))}return`${zr(s?.subject||"message").replace(/\.eml$/i,"").trim()||"message"}.eml`}function rd(s){const t=new Uint8Array(s);return wl(t)}function nd(s){if(!s)return null;const t=td(s);if(s._fileType==="eml"&&s._rawBuffer){const n=rd(s._rawBuffer);return{fileName:t,dataUrl:`data:message/rfc822;base64,${n}`}}const r=ed(s),e=wr(r);return{fileName:t,dataUrl:`data:message/rfc822;base64,${e}`}}const id=500;class ad{constructor(t){this.messageHandler=t,this.lastAttachmentClickTime=0,this.welcomeScreen=document.getElementById("welcomeScreen"),this.appContainer=document.getElementById("appContainer"),this.dropOverlay=document.querySelector(".drop-overlay"),this.toasts=new Yf,this.modal=new Vf((r,e)=>this.showToast(r,e)),this.searchManager=new Kf(t),this.messageList=new Nl(document.getElementById("messageItems"),t),this.messageContent=new hu(document.getElementById("messageViewer"),t,this.modal),this.searchInput=document.getElementById("search-input"),this.searchClearBtn=document.getElementById("search-clear"),this.searchResultsCount=document.getElementById("search-results-count"),this.srAnnouncements=document.getElementById("srAnnouncements"),this.bulkActions=document.getElementById("bulkActions"),this.bulkSelectToggle=this.bulkActions?.querySelector('[data-action="bulk-select-toggle"]')||null,this.bulkActionsMeta=document.getElementById("bulkActionsMeta"),this.bulkDownloadBtn=this.bulkActions?.querySelector('[data-action="bulk-download"]')||null,this.bulkPinBtn=this.bulkActions?.querySelector('[data-action="bulk-pin"]')||null,this.bulkDeleteBtn=this.bulkActions?.querySelector('[data-action="bulk-delete"]')||null,this.keyboardManager=null,this.devPanel=null,this.initEventDelegation(),this.initSearchListeners(),this.initBulkActions()}setKeyboardManager(t){this.keyboardManager=t,this.modal.setKeyboardManager(t)}setDevPanel(t){this.devPanel=t}initEventDelegation(){document.getElementById("messageItems")?.addEventListener("click",t=>{if(t.target.closest('[data-action="select-message"]'))return;const r=t.target.closest("[data-message-index]");r&&window.app&&window.app.showMessage(parseInt(r.dataset.messageIndex,10))}),document.getElementById("messageItems")?.addEventListener("change",t=>{const r=t.target.closest('[data-action="select-message"]');if(!r)return;const e=parseInt(r.dataset.messageIndex,10),n=this.messageHandler.getMessages()[e];if(!n)return;this.messageHandler.setSelected(n,r.checked);const i=r.closest(".message-item");i&&(i.classList.toggle("selected",r.checked),i.setAttribute("aria-selected",r.checked?"true":"false")),this.updateBulkActions()}),document.getElementById("messageViewer")?.addEventListener("click",t=>{const r=t.target.closest("[data-action]");if(!r||!window.app)return;const e=r.dataset.action,n=parseInt(r.dataset.index,10);if(e==="pin")window.app.togglePin(n);else if(e==="delete")window.app.deleteMessage(n);else if(e==="download-eml"){if(Number.isNaN(n))return;const i=this.messageHandler.getMessages()[n];i&&this.downloadMessageAsEml(i)}else if(e==="preview"||e==="download"){const i=Date.now();if(i-this.lastAttachmentClickTime<id)return;this.lastAttachmentClickTime=i;const f=parseInt(r.dataset.attachmentIndex,10),a=this.modal.getAttachments();if(!a?.[f])return;e==="preview"?this.modal.open(a[f]):(t.stopPropagation(),this.downloadAttachment(a[f]))}})}initSearchListeners(){this.searchInput&&(this.searchInput.addEventListener("input",t=>{const r=t.target.value;this.updateSearchUI(r),this.searchManager.searchDebounced(r,e=>{this.messageList.renderFiltered(e),this.updateSearchResultsCount(e.length,r),this.updateBulkActions()})}),this.searchInput.addEventListener("keydown",t=>{if(t.key==="Escape")this.clearSearch(),this.searchInput.blur();else if(t.key==="Enter"||t.key==="ArrowDown"){const r=this.messageList.getFilteredMessages();if(r.length>0&&window.app){t.preventDefault();const n=this.messageHandler.getMessages().indexOf(r[0]);window.app.showMessage(n),this.searchInput.blur(),document.getElementById("messageItems")?.focus()}}}),this.searchClearBtn?.addEventListener("click",()=>{this.clearSearch(),this.searchInput.focus()}))}updateSearchUI(t){this.searchClearBtn&&(t.length>0?this.searchClearBtn.classList.remove("hidden"):this.searchClearBtn.classList.add("hidden"))}updateSearchResultsCount(t,r){this.searchResultsCount&&(!r||r.trim().length===0||t===0?(this.searchResultsCount.classList.add("hidden"),this.searchResultsCount.classList.remove("no-results")):(this.searchResultsCount.classList.remove("hidden"),this.searchResultsCount.classList.remove("no-results"),this.searchResultsCount.textContent=`${t} ${t===1?"result":"results"} found`),this.announceSearchResults(t))}announceSearchResults(t){if(!this.srAnnouncements)return;const r=t===0?"No results found":`${t} ${t===1?"result":"results"} found`;this.srAnnouncements.textContent=r,setTimeout(()=>{this.srAnnouncements.textContent=""},1e3)}clearSearch(){this.searchInput&&(this.searchInput.value=""),this.updateSearchUI("");const t=this.searchManager.clearSearch();this.messageList.renderFiltered(t),this.updateSearchResultsCount(0,""),this.updateBulkActions()}focusSearch(){this.searchInput?.focus()}isSearchFocused(){return document.activeElement===this.searchInput}showWelcomeScreen(){this.welcomeScreen.style.display="flex",this.appContainer.style.display="none"}showAppContainer(){this.welcomeScreen.style.display="none",this.appContainer.style.display="flex"}updateMessageList(){if(this.searchManager.isSearchActive()){const t=this.searchManager.search(this.searchManager.getQuery());this.messageList.renderFiltered(t)}else this.messageList.render();this.updateBulkActions()}showMessage(t){this.messageContent.render(t),this.updateMessageList(),this.devPanel&&this.devPanel.isVisible&&(t._debugData?this.devPanel.setDebugData(t._debugData):t._rawBuffer&&window.app?.reloadDebugData&&window.app.reloadDebugData(t))}showDropOverlay(){this.dropOverlay?.classList.add("active")}hideDropOverlay(){this.dropOverlay?.classList.remove("active")}showToast(t,r="info",e){this.toasts.show(t,r,e)}showError(t,r=5e3){this.toasts.error(t,r)}showWarning(t,r=4e3){this.toasts.warning(t,r)}showInfo(t,r=3e3){this.toasts.info(t,r)}async downloadAttachment(t){if(it())try{await pa(t.contentBase64,t.fileName)&&this.showInfo("File saved successfully")}catch(r){console.error("Failed to save file:",r),this.showError("Failed to save file")}else{const r=document.createElement("a");r.href=t.contentBase64,r.download=t.fileName,document.body.appendChild(r),r.click(),document.body.removeChild(r)}}initBulkActions(){this.bulkActions&&(this.bulkActions.addEventListener("click",t=>{const r=t.target.closest('[data-action^="bulk-"]');if(!r)return;const e=r.dataset.action;e==="bulk-select-toggle"?this.toggleSelectAll():e==="bulk-download"?this.handleBulkDownload():e==="bulk-delete"?this.handleBulkDelete():e==="bulk-pin"&&this.handleBulkPin()}),this.updateBulkActions())}getBulkScopeMessages(){return this.searchManager?.isSearchActive()?this.messageList.getFilteredMessages():this.messageHandler.getMessages()}getBulkTargetMessages(){const t=this.messageHandler.getSelectedMessages?this.messageHandler.getSelectedMessages():[];if(t.length>0)return{messages:t,scope:"selected"};const r=this.getBulkScopeMessages(),e=this.searchManager?.isSearchActive()?"filtered":"all";return{messages:r,scope:e}}updateBulkActions(){if(!this.bulkActions)return;const t=this.getBulkScopeMessages(),e=(this.messageHandler.getSelectedMessages?this.messageHandler.getSelectedMessages():[]).length,{messages:n,scope:i}=this.getBulkTargetMessages(),f=n.length;if(this.bulkActionsMeta)if(e>0)this.bulkActionsMeta.textContent=`${e} selected`;else if(t.length===0)this.bulkActionsMeta.textContent="No messages";else{const o=i==="filtered"?"filtered":"total";this.bulkActionsMeta.textContent=`${t.length} ${o}`}const a=t.length>0&&t.every(o=>this.messageHandler.isSelected?.(o)),l=t.some(o=>this.messageHandler.isSelected?.(o));if(this.bulkSelectToggle){const o=this.bulkSelectToggle.querySelector("span"),d=!a,u=i==="filtered"?"Select filtered":"Select all";o&&(o.textContent=d?u:"Clear selection"),this.bulkSelectToggle.classList.toggle("active",a),this.bulkSelectToggle.classList.toggle("partial",!a&&l),this.bulkSelectToggle.disabled=t.length===0,this.bulkSelectToggle.setAttribute("aria-pressed",a||l?"true":"false"),this.bulkSelectToggle.title=d?u:"Clear selection"}const c=f===0;if(this.bulkDownloadBtn&&(this.bulkDownloadBtn.disabled=c),this.bulkDeleteBtn&&(this.bulkDeleteBtn.disabled=c),this.bulkPinBtn){this.bulkPinBtn.disabled=c;const o=n.length>0&&n.every(u=>this.messageHandler.isPinned?.(u)),d=this.bulkPinBtn.querySelector("span");d&&(d.textContent=o?"Unpin":"Pin"),this.bulkPinBtn.title=o?"Remove bookmark":"Bookmark selected"}}toggleSelectAll(){const t=this.getBulkScopeMessages(),r=t.length>0&&t.every(e=>this.messageHandler.isSelected?.(e));this.messageHandler.setSelectionForMessages(t,!r),this.updateMessageList()}async handleBulkDownload(){const{messages:t}=this.getBulkTargetMessages();if(t.length)for(const r of t)await this.downloadMessageAsEml(r)}handleBulkDelete(){const{messages:t}=this.getBulkTargetMessages();!t.length||!window.app?.bulkDeleteMessages||(window.app.bulkDeleteMessages(t),this.updateBulkActions())}handleBulkPin(){const{messages:t}=this.getBulkTargetMessages();if(!t.length||!window.app?.bulkSetPinned)return;const r=t.every(e=>this.messageHandler.isPinned?.(e));window.app.bulkSetPinned(t,!r),this.updateBulkActions()}async downloadMessageAsEml(t){try{const r=nd(t);if(!r)return;if(it())await pa(r.dataUrl,r.fileName)&&this.showInfo("Email saved successfully");else{const e=document.createElement("a");e.href=r.dataUrl,e.download=r.fileName,document.body.appendChild(e),e.click(),document.body.removeChild(e)}}catch(r){console.error("Failed to export email:",r),this.showError("Failed to export email")}}openAttachmentModal(t){this.modal.open(t)}closeAttachmentModal(){this.modal.close()}showPrevAttachment(){this.modal.showPrevAttachment()}showNextAttachment(){this.modal.showNextAttachment()}}class sd{constructor(t,r,e={},n=null){this.messageHandler=t,this.uiManager=r,this.extractMsg=e.extractMsg||null,this.extractEml=e.extractEml||null,this.devModeManager=n,this.setupEventListeners()}setupEventListeners(){document.addEventListener("dragover",e=>{e.preventDefault(),this.uiManager.showDropOverlay()}),document.addEventListener("dragleave",e=>{e.preventDefault(),(e.clientX<=0||e.clientY<=0||e.clientX>=window.innerWidth||e.clientY>=window.innerHeight)&&this.uiManager.hideDropOverlay()}),document.addEventListener("drop",e=>{e.preventDefault(),this.uiManager.hideDropOverlay(),e.dataTransfer?.files?.length>0&&this.handleFiles(e.dataTransfer.files)});const t=document.getElementById("fileInput");t&&t.addEventListener("change",e=>{this.handleFiles(e.target.files)});const r=document.getElementById("fileInputInApp");r&&r.addEventListener("change",e=>{this.handleFiles(e.target.files)})}handleFiles(t){Array.from(t).forEach(r=>{const e=r.name.toLowerCase().split(".").pop();ln.includes(e)&&this.handleFile(r)})}handleFile(t){const r=new FileReader;r.onerror=e=>{console.error("FileHandler: Error reading file:",e),this.uiManager.showError&&this.uiManager.showError(`Failed to read file: ${t.name}`)},r.onload=e=>{try{const n=e.target.result,i=t.name.toLowerCase().split(".").pop(),a={collectDebugData:this.devModeManager?.isEnabled()||!1};let l=null;if(i==="msg"&&this.extractMsg?l=this.extractMsg(n,a):i==="eml"&&this.extractEml&&(l=this.extractEml(n,a)),!l)throw new Error(`Failed to parse ${i.toUpperCase()} file`);l._rawBuffer=n,l._fileType=i;const c=this.messageHandler.addMessage(l,t.name);this.uiManager.showAppContainer(),this.uiManager.updateMessageList(),this.messageHandler.getMessages().length===1&&this.uiManager.showMessage(c)}catch(n){console.error("FileHandler: Error processing file:",n),this.uiManager.showError&&this.uiManager.showError(`Failed to process email: ${t.name}`)}},r.readAsArrayBuffer(t)}async handleFileFromPath(t){if(!it()){console.error("handleFileFromPath is only available in Tauri");return}try{const r=gn(t),e=r.toLowerCase().split(".").pop();if(!ln.includes(e)){console.error("Unsupported file type:",e);return}const n=await rs(t),f={collectDebugData:this.devModeManager?.isEnabled()||!1};let a=null;if(e==="msg"&&this.extractMsg?a=this.extractMsg(n,f):e==="eml"&&this.extractEml&&(a=this.extractEml(n,f)),!a)throw new Error(`Failed to parse ${e.toUpperCase()} file`);a._rawBuffer=n,a._fileType=e;const l=this.messageHandler.addMessage(a,r);this.uiManager.showAppContainer(),this.uiManager.updateMessageList(),this.uiManager.showMessage(l)}catch(r){console.error("FileHandler: Error processing file from path:",r),this.uiManager.showError&&this.uiManager.showError(`Failed to open: ${t}`)}}async handleFilesFromPaths(t){if(!it()){console.error("handleFilesFromPaths is only available in Tauri");return}if(!t||t.length===0)return;const r=t.filter(l=>{const o=gn(l).toLowerCase().split(".").pop();return ln.includes(o)});if(r.length===0)return;this.uiManager.showAppContainer();const e=20,n=[];let i=0;const a={collectDebugData:this.devModeManager?.isEnabled()||!1};for(let l=0;l<r.length;l+=e){const c=r.slice(l,l+e),o=await Promise.all(c.map(async d=>{try{const u=gn(d),h=u.toLowerCase().split(".").pop(),v=await rs(d);let w=null;if(h==="msg"&&this.extractMsg?w=this.extractMsg(v,a):h==="eml"&&this.extractEml&&(w=this.extractEml(v,a)),!w)throw new Error(`Failed to parse ${h.toUpperCase()} file`);return w._rawBuffer=v,w._fileType=h,{msgInfo:w,fileName:u}}catch(u){return console.error("FileHandler: Error processing file:",d,u),null}}));for(const d of o)if(d){const u=this.messageHandler.addMessage(d.msgInfo,d.fileName);n.push(u)}else i++}n.length>0&&(this.uiManager.updateMessageList(),this.uiManager.showMessage(n[0])),i>0&&this.uiManager.showWarning(`${i} file(s) could not be loaded`)}}const Ne={MAIN:"main",MODAL:"modal"},qr={navigation:[{keys:["j","ArrowDown"],action:"nextMessage",contexts:[Ne.MAIN],description:"Next message"},{keys:["k","ArrowUp"],action:"prevMessage",contexts:[Ne.MAIN],description:"Previous message"},{keys:["Enter","o"],action:"openMessage",contexts:[Ne.MAIN],description:"Open message"},{keys:["Home"],action:"firstMessage",contexts:[Ne.MAIN],description:"First message"},{keys:["End"],action:"lastMessage",contexts:[Ne.MAIN],description:"Last message"},{keys:["PageDown"," "],action:"pageDown",contexts:[Ne.MAIN],description:"Page down (5 messages)"},{keys:["PageUp"],action:"pageUp",contexts:[Ne.MAIN],description:"Page up (5 messages)"}],actions:[{keys:["s"],action:"togglePin",contexts:[Ne.MAIN],description:"Pin/unpin message"},{keys:["Delete","Backspace"],action:"deleteMessage",contexts:[Ne.MAIN],description:"Delete message"},{keys:["Ctrl+o","Meta+o"],action:"openFilePicker",contexts:[Ne.MAIN],description:"Open file picker"},{keys:["/"],action:"focusSearch",contexts:[Ne.MAIN],description:"Focus search"},{keys:["Escape"],action:"clearSearch",contexts:[Ne.MAIN],description:"Clear search"},{keys:["t"],action:"toggleTheme",contexts:[Ne.MAIN],description:"Toggle theme"}],modal:[{keys:["Escape"],action:"closeModal",contexts:[Ne.MAIN,Ne.MODAL],description:"Close modal"},{keys:["ArrowLeft"],action:"prevAttachment",contexts:[Ne.MODAL],description:"Previous attachment"},{keys:["ArrowRight"],action:"nextAttachment",contexts:[Ne.MODAL],description:"Next attachment"}],help:[{keys:["?"],action:"showHelp",contexts:[Ne.MAIN,Ne.MODAL],description:"Show keyboard shortcuts"}]},od=[{title:"Navigation",shortcuts:[{keys:["j",""],description:"Next message"},{keys:["k",""],description:"Previous message"},{keys:["Enter","o"],description:"Open message"},{keys:["Home"],description:"First message"},{keys:["End"],description:"Last message"},{keys:["PageDown","Space"],description:"Page down (5 messages)"},{keys:["PageUp"],description:"Page up (5 messages)"}]},{title:"Actions",shortcuts:[{keys:["s"],description:"Pin/unpin message"},{keys:["Delete"],description:"Delete message"},{keys:["Ctrl/+O"],description:"Open file picker"},{keys:["/"],description:"Focus search"},{keys:["t"],description:"Toggle theme"}]},{title:"Modal",shortcuts:[{keys:["Esc"],description:"Close modal"},{keys:["",""],description:"Previous/next attachment"}]},{title:"Help",shortcuts:[{keys:["?"],description:"Show this help"}]}],cd=["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Tab","CapsLock","Shift","Control","Alt","Meta"],Je={LIGHT:"light",DARK:"dark",SYSTEM:"system"},at={LIGHT:"light",DARK:"dark",INHERIT:"inherit"},$r={APP_THEME:"msgReader_theme",EMAIL_THEME:"msgReader_emailTheme"};class ld{constructor(){this.mediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.listeners=new Set}init(){this.applyTheme(this.getSavedTheme()),this.applyEmailTheme(this.getSavedEmailTheme()),this.mediaQuery.addEventListener("change",()=>{this.getSavedTheme()===Je.SYSTEM&&this.applyTheme(Je.SYSTEM),this.getSavedEmailTheme()===at.INHERIT&&this.applyEmailTheme(at.INHERIT)})}getSavedTheme(){return gr.get($r.APP_THEME,Je.SYSTEM)}getSavedEmailTheme(){return gr.get($r.EMAIL_THEME,at.INHERIT)}setTheme(t){if(!Object.values(Je).includes(t)){console.warn(`ThemeManager: Invalid theme '${t}'`);return}gr.set($r.APP_THEME,t),this.applyTheme(t),this.getSavedEmailTheme()===at.INHERIT&&this.applyEmailTheme(at.INHERIT),this.notifyListeners("app",t)}setEmailTheme(t){if(!Object.values(at).includes(t)){console.warn(`ThemeManager: Invalid email theme '${t}'`);return}gr.set($r.EMAIL_THEME,t),this.applyEmailTheme(t),this.notifyListeners("email",t)}applyTheme(t){const r=document.documentElement;r.classList.remove("light","dark");const e=this.resolveTheme(t);r.classList.add(e),r.dataset.theme=e}applyEmailTheme(t){const r=document.documentElement;let e;t===at.INHERIT?e=this.getActiveTheme():e=t,r.dataset.emailTheme=e}resolveTheme(t){return t===Je.SYSTEM?this.mediaQuery.matches?Je.DARK:Je.LIGHT:t}getActiveTheme(){return this.resolveTheme(this.getSavedTheme())}getActiveEmailTheme(){const t=this.getSavedEmailTheme();return t===at.INHERIT?this.getActiveTheme():t}toggleTheme(){const t=this.getSavedTheme(),r=[Je.LIGHT,Je.DARK,Je.SYSTEM],e=r.indexOf(t),n=r[(e+1)%r.length];return this.setTheme(n),n}toggleEmailTheme(){const t=this.getSavedEmailTheme(),r=[at.INHERIT,at.LIGHT,at.DARK],e=r.indexOf(t),n=r[(e+1)%r.length];return this.setEmailTheme(n),n}addListener(t){this.listeners.add(t)}removeListener(t){this.listeners.delete(t)}notifyListeners(t,r){this.listeners.forEach(e=>e(t,r))}getThemeLabel(t){return{[Je.LIGHT]:"Light",[Je.DARK]:"Dark",[Je.SYSTEM]:"System",[at.INHERIT]:"Same as App"}[t]||t}}const St=new ld;class ud{constructor(t){this.app=t,this.context=Ne.MAIN,this.helpModal=null,this.srAnnouncements=null,this.actionMap=this.buildActionMap(),this.handleKeyDown=this.handleKeyDown.bind(this),this.init()}init(){document.addEventListener("keydown",this.handleKeyDown),this.srAnnouncements=document.getElementById("srAnnouncements"),this.helpModal=document.getElementById("helpModal"),this.initHelpModal(),document.getElementById("shortcutHint")?.addEventListener("click",()=>this.showHelpModal())}buildActionMap(){return new Map([["nextMessage",()=>this.navigateMessages(1)],["prevMessage",()=>this.navigateMessages(-1)],["openMessage",()=>this.selectCurrentMessage()],["firstMessage",()=>this.navigateToMessage(0)],["lastMessage",()=>this.navigateToMessage(-1)],["pageDown",()=>this.navigateMessages(5)],["pageUp",()=>this.navigateMessages(-5)],["togglePin",()=>this.toggleCurrentPin()],["deleteMessage",()=>this.deleteCurrentMessage()],["openFilePicker",()=>this.openFilePicker()],["focusSearch",()=>this.focusSearch()],["clearSearch",()=>this.clearSearch()],["closeModal",()=>this.closeCurrentModal()],["prevAttachment",()=>this.navigateAttachment(-1)],["nextAttachment",()=>this.navigateAttachment(1)],["showHelp",()=>this.showHelpModal()],["toggleTheme",()=>this.toggleTheme()]])}setContext(t){this.context=t}isInputFocused(){const t=document.activeElement;if(!t)return!1;const r=t.tagName.toLowerCase(),e=r==="input"||r==="textarea"||r==="select",n=t.isContentEditable;return e||n}handleKeyDown(t){if(this.isInputFocused()&&t.key!=="Escape"||cd.includes(t.key))return;if((t.key==="d"||t.key==="D")&&!t.ctrlKey&&!t.metaKey&&!t.altKey){t.preventDefault(),this.toggleDevPanel();return}const r=this.buildKeyIdentifier(t),e=this.findShortcut(r,t.key);if(e){const n=this.actionMap.get(e.action);n&&(t.preventDefault(),n())}}toggleDevPanel(){this.app.toggleDevPanel&&this.app.toggleDevPanel()}buildKeyIdentifier(t){const r=[];t.ctrlKey&&r.push("Ctrl"),t.metaKey&&r.push("Meta"),t.altKey&&r.push("Alt");const e=["?","/"];return t.shiftKey&&!e.includes(t.key)&&r.push("Shift"),r.push(t.key),r.join("+")}findShortcut(t,r){const e=[...qr.navigation,...qr.actions,...qr.modal,...qr.help];for(const n of e){if(!n.contexts.includes(this.context))continue;if(n.keys.some(f=>f.includes("+")?f===t:f===r&&t===r))return n}return null}getVisibleMessages(){return this.app.uiManager.messageList.getFilteredMessages()}getCurrentMessageIndex(){const t=this.getVisibleMessages(),r=this.app.messageHandler.getCurrentMessage();return t.indexOf(r)}navigateMessages(t){const r=this.getVisibleMessages();if(r.length===0)return;const e=this.getCurrentMessageIndex(),n=Math.max(0,Math.min(r.length-1,e+t));if(n!==e||e===-1){const i=e===-1?0:n,f=r[i],l=this.app.messageHandler.getMessages().indexOf(f);this.app.showMessage(l),this.scrollMessageIntoView(i),this.announce(`Message ${i+1} of ${r.length}`)}}navigateToMessage(t){const r=this.getVisibleMessages();if(r.length===0)return;const e=t===-1?r.length-1:t,n=r[e],f=this.app.messageHandler.getMessages().indexOf(n);this.app.showMessage(f),this.scrollMessageIntoView(e),this.announce(`Message ${e+1} of ${r.length}`)}selectCurrentMessage(){const t=this.getVisibleMessages();if(t.length===0)return;let r=this.getCurrentMessageIndex();r===-1&&(r=0);const e=t[r],i=this.app.messageHandler.getMessages().indexOf(e);this.app.showMessage(i),this.scrollMessageIntoView(r);const f=document.getElementById("messageViewer");f&&f.focus()}toggleCurrentPin(){const t=this.getVisibleMessages(),r=this.getCurrentMessageIndex();if(r===-1)return;const e=t[r],i=this.app.messageHandler.getMessages().indexOf(e);this.app.togglePin(i);const f=this.app.messageHandler.isPinned(e);this.announce(f?"Message pinned":"Message unpinned")}deleteCurrentMessage(){const t=this.getVisibleMessages(),r=this.getCurrentMessageIndex();if(r===-1)return;const e=t[r],i=this.app.messageHandler.getMessages().indexOf(e);this.app.deleteMessage(i),this.announce("Message deleted")}openFilePicker(){const t=document.getElementById("fileInputInApp")||document.getElementById("fileInput");t&&t.click()}focusSearch(){this.app.uiManager.focusSearch()}toggleTheme(){const t=St.toggleTheme(),r=St.getThemeLabel(t);this.announce(`Theme: ${r}`)}clearSearch(){if(this.helpModal?.classList.contains("active")){this.closeHelpModal();return}this.app.uiManager.searchManager?.isSearchActive()&&this.app.uiManager.clearSearch()}closeCurrentModal(){if(this.context===Ne.MODAL){if(this.app.uiManager.modal?.handleEscape())return;this.app.uiManager.closeAttachmentModal(),this.setContext(Ne.MAIN)}else this.helpModal?.classList.contains("active")&&this.closeHelpModal()}navigateAttachment(t){this.context===Ne.MODAL&&(t<0?this.app.uiManager.showPrevAttachment():this.app.uiManager.showNextAttachment())}scrollMessageIntoView(t){this.app.uiManager.messageList.scrollToMessage(t,{behavior:"smooth",block:"nearest"}),requestAnimationFrame(()=>{const r=this.app.uiManager.messageList.getMessageElement(t);r&&r.focus()})}announce(t){this.srAnnouncements&&(this.srAnnouncements.textContent=t,setTimeout(()=>{this.srAnnouncements.textContent=""},1e3))}initHelpModal(){if(!this.helpModal)return;const t=this.helpModal.querySelector(".help-modal-backdrop"),r=this.helpModal.querySelector(".help-modal-close");t?.addEventListener("click",()=>this.closeHelpModal()),r?.addEventListener("click",()=>this.closeHelpModal())}showHelpModal(){if(!this.helpModal)return;const t=this.helpModal.querySelector(".help-modal-content");t&&!t.dataset.initialized&&(t.innerHTML=this.buildHelpContent(),t.dataset.initialized="true"),this.helpModal.classList.add("active"),document.body.style.overflow="hidden",this.helpModal.querySelector(".help-modal-close")?.focus()}closeHelpModal(){this.helpModal&&(this.helpModal.classList.remove("active"),document.body.style.overflow="")}buildHelpContent(){return`
            <h2 id="helpModalTitle">Keyboard Shortcuts</h2>
            ${od.map(r=>`
            <div class="help-section">
                <h3>${r.title}</h3>
                <dl class="shortcut-list">
                    ${r.shortcuts.map(e=>`
                        <div class="shortcut-item">
                            <dt>${e.keys.map(n=>`<kbd>${n}</kbd>`).join(" / ")}</dt>
                            <dd>${e.description}</dd>
                        </div>
                    `).join("")}
                </dl>
            </div>
        `).join("")}
            <button class="help-modal-close-btn">Close <kbd>Esc</kbd></button>
        `}destroy(){document.removeEventListener("keydown",this.handleKeyDown)}}class fd{constructor(){this.enabled=this.checkUrlParam(),this.debugDataMap=new Map,this.panelVisible=!1,this.listeners=[]}checkUrlParam(){return typeof window>"u"?!1:new URLSearchParams(window.location.search).has("dev")}isEnabled(){return this.enabled}enable(){this.enabled||(this.enabled=!0,this.notifyListeners())}toggle(){this.enabled=!this.enabled,this.enabled||(this.panelVisible=!1),this.notifyListeners()}togglePanel(){this.enabled&&(this.panelVisible=!this.panelVisible,this.notifyListeners())}showPanel(){this.enabled&&(this.panelVisible=!0,this.notifyListeners())}hidePanel(){this.panelVisible=!1,this.notifyListeners()}isPanelVisible(){return this.enabled&&this.panelVisible}setDebugData(t,r){this.debugDataMap.set(t,r)}getDebugData(t){return this.debugDataMap.get(t)||null}clearDebugData(t){this.debugDataMap.delete(t)}clearAllDebugData(){this.debugDataMap.clear()}addListener(t){this.listeners.push(t)}removeListener(t){this.listeners=this.listeners.filter(r=>r!==t)}notifyListeners(){this.listeners.forEach(t=>t({enabled:this.enabled,panelVisible:this.panelVisible}))}}const qt=new fd;class dd{constructor(t){this.container=t,this.debugData=null,this.activeTab="headers",this.isVisible=!1,this.tabs=[{id:"raw",label:"Raw",icon:this.getIcon("binary")},{id:"headers",label:"Headers",icon:this.getIcon("headers")},{id:"rtf",label:"RTF",icon:this.getIcon("code"),condition:r=>r?.decompressedRtf},{id:"html",label:"HTML",icon:this.getIcon("code")},{id:"sanitized",label:"Sanitized",icon:this.getIcon("shield")},{id:"text",label:"Text",icon:this.getIcon("text")},{id:"mime",label:"MIME",icon:this.getIcon("tree"),condition:r=>r?.mimeStructure},{id:"debug",label:"Debug",icon:this.getIcon("json")}]}getIcon(t){return{binary:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="M14.25 9.75 16.5 12l-2.25 2.25m-4.5 0L7.5 12l2.25-2.25M6 20.25h12A2.25 2.25 0 0 0 20.25 18V6A2.25 2.25 0 0 0 18 3.75H6A2.25 2.25 0 0 0 3.75 6v12A2.25 2.25 0 0 0 6 20.25Z" />
            </svg>`,headers:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z" />
            </svg>`,code:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 6.75 22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3-4.5 16.5" />
            </svg>`,shield:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z" />
            </svg>`,text:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
            </svg>`,tree:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
            </svg>`,json:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 6.75 22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3-4.5 16.5" />
            </svg>`,copy:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184" />
            </svg>`,close:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
            </svg>`}[t]||""}setDebugData(t){this.debugData=t,this.isVisible&&this.render()}show(){this.isVisible=!0,this.container.style.display="block",this.render()}hide(){this.isVisible=!1,this.container.style.display="none"}toggle(){this.isVisible?this.hide():this.show()}render(){if(!this.container||!this.debugData){this.container.innerHTML=`
                <div class="dev-panel-empty">
                    <p>No debug data available. Load an email file to see parsing details.</p>
                </div>
            `;return}const t=this.tabs.filter(n=>!n.condition||n.condition(this.debugData));t.find(n=>n.id===this.activeTab)||(this.activeTab=t[0]?.id||"headers");const r=t.map(n=>`
            <button class="dev-panel-tab ${n.id===this.activeTab?"active":""}"
                    data-tab="${n.id}"
                    title="${n.label}">
                ${n.icon}
                <span class="dev-panel-tab-label">${n.label}</span>
            </button>
        `).join(""),e=this.renderTabContent(this.activeTab);this.container.innerHTML=`
            <div class="dev-panel-header">
                <div class="dev-panel-title">
                    <span class="dev-panel-badge">${this.debugData.fileType?.toUpperCase()}</span>
                    <span>Debug Panel</span>
                    <span class="dev-panel-size">${this.formatSize(this.debugData.rawSize)}</span>
                </div>
                <div class="dev-panel-actions">
                    <button class="dev-panel-copy" title="Copy to clipboard">
                        ${this.getIcon("copy")}
                    </button>
                    <button class="dev-panel-close" title="Close panel">
                        ${this.getIcon("close")}
                    </button>
                </div>
            </div>
            <div class="dev-panel-tabs">
                ${r}
            </div>
            <div class="dev-panel-content">
                ${e}
            </div>
        `,this.attachEventListeners()}renderTabContent(t){const r=this.debugData;if(!r)return"<p>No data</p>";switch(t){case"raw":return this.renderRawContent(r);case"headers":return this.renderHeadersContent(r);case"rtf":return this.renderRtfContent(r);case"html":return this.renderHtmlContent(r);case"sanitized":return this.renderSanitizedContent(r);case"text":return this.renderTextContent(r);case"mime":return this.renderMimeContent(r);case"debug":return this.renderDebugContent(r);default:return"<p>Unknown tab</p>"}}renderRawContent(t){const r=t.rawString?this.escapeHtml(t.rawString.substring(0,5e3)):"[Binary data - ArrayBuffer]",e=t.rawString&&t.rawString.length>5e3;return`
            <div class="dev-panel-info">
                <span>Size: ${this.formatSize(t.rawSize)}</span>
                <span>Type: ${t.fileType?.toUpperCase()}</span>
                ${e?'<span class="dev-panel-truncated">Truncated (showing first 5000 chars)</span>':""}
            </div>
            <pre class="dev-panel-code">${r}</pre>
        `}renderHeadersContent(t){if(t.headersParsed)return`<pre class="dev-panel-code dev-panel-headers">${Object.entries(t.headersParsed).map(([e,n])=>`<span class="dev-header-key">${this.escapeHtml(e)}:</span> ${this.escapeHtml(n)}`).join(`
`)}</pre>`;if(t.msgInfoRaw){const r=t.msgInfoRaw;return`<pre class="dev-panel-code dev-panel-headers">${[`<span class="dev-header-key">Subject:</span> ${this.escapeHtml(r.subject||"")}`,`<span class="dev-header-key">From:</span> ${this.escapeHtml(r.senderName||"")} &lt;${this.escapeHtml(r.senderEmail||"")}&gt;`,`<span class="dev-header-key">Date:</span> ${this.escapeHtml(r.messageDeliveryTime||"")}`,`<span class="dev-header-key">Internet Codepage:</span> ${r.internetCodepage||"N/A"}`,`<span class="dev-header-key">Message Class:</span> ${this.escapeHtml(r.messageClass||"N/A")}`].join(`
`)}</pre>`}return"<p>No headers available</p>"}renderRtfContent(t){if(!t.decompressedRtf)return"<p>No RTF content available</p>";const r=this.escapeHtml(t.decompressedRtf.substring(0,1e4)),e=t.decompressedRtf.length>1e4;return`
            <div class="dev-panel-info">
                <span>Source: Compressed RTF</span>
                <span>Decompressed size: ${this.formatSize(t.decompressedRtf.length)}</span>
                ${e?'<span class="dev-panel-truncated">Truncated</span>':""}
            </div>
            <pre class="dev-panel-code">${r}</pre>
        `}renderHtmlContent(t){const r=t.htmlBeforeCid||t.htmlAfterCid||"";if(!r)return"<p>No HTML content available</p>";const e=this.escapeHtml(r.substring(0,2e4)),n=r.length>2e4;return`
            <div class="dev-panel-info">
                <span>Source: ${t.htmlSource||"unknown"}</span>
                <span>Size: ${this.formatSize(r.length)}</span>
                ${t.charset?`<span>Charset: ${t.charset}</span>`:""}
                ${n?'<span class="dev-panel-truncated">Truncated</span>':""}
            </div>
            <pre class="dev-panel-code dev-panel-html">${e}</pre>
        `}renderSanitizedContent(t){const r=t.htmlFinal||"";if(!r)return"<p>No sanitized content available</p>";const e=this.escapeHtml(r.substring(0,2e4)),n=r.length>2e4;return`
            <div class="dev-panel-info">
                <span>Final HTML (after CID replacement & sanitization)</span>
                <span>Size: ${this.formatSize(r.length)}</span>
                ${n?'<span class="dev-panel-truncated">Truncated</span>':""}
            </div>
            <pre class="dev-panel-code dev-panel-html">${e}</pre>
        `}renderTextContent(t){const r=t.plainText||"";if(!r)return"<p>No plain text content available</p>";const e=this.escapeHtml(r.substring(0,1e4)),n=r.length>1e4;return`
            <div class="dev-panel-info">
                <span>Plain text body</span>
                <span>Size: ${this.formatSize(r.length)}</span>
                ${n?'<span class="dev-panel-truncated">Truncated</span>':""}
            </div>
            <pre class="dev-panel-code">${e}</pre>
        `}renderMimeContent(t){return t.mimeStructure?`
            <div class="dev-panel-info">
                <span>MIME Structure</span>
                <span>Boundary: ${this.escapeHtml(t.mimeStructure.boundary||"N/A")}</span>
            </div>
            <div class="dev-panel-tree">
                ${this.renderMimeTree(t.mimeStructure)}
            </div>
        `:"<p>No MIME structure available (single-part email)</p>"}renderMimeTree(t,r=0){if(!t||!t.parts)return"";let e="";return t.parts.forEach((n,i)=>{const f=n.contentType.startsWith("text/html")?"mime-html":n.contentType.startsWith("text/")?"mime-text":n.contentType.startsWith("image/")?"mime-image":n.contentType.startsWith("multipart/")?"mime-multipart":"";e+=`
                <div class="mime-part ${f}" style="margin-left: ${r*20}px">
                    <span class="mime-index">[${i}]</span>
                    <span class="mime-type">${this.escapeHtml(n.contentType)}</span>
                    ${n.filename?`<span class="mime-filename">${this.escapeHtml(n.filename)}</span>`:""}
                    ${n.contentId?`<span class="mime-cid">cid:${this.escapeHtml(n.contentId)}</span>`:""}
                    <span class="mime-size">${this.formatSize(n.size)}</span>
                </div>
            `,n.nested&&(e+=this.renderMimeTree(n.nested,r+1))}),e}renderDebugContent(t){const r={...t};delete r.rawBuffer,delete r.rawString,delete r.htmlRawBytes,delete r.compressedRtf;const e=(f,a=500)=>{if(typeof f=="string"&&f.length>a)return f.substring(0,a)+`... [${f.length-a} more chars]`;if(Array.isArray(f))return f.map(l=>e(l,a));if(f&&typeof f=="object"){const l={};for(const[c,o]of Object.entries(f))l[c]=e(o,a);return l}return f},n=e(r),i=JSON.stringify(n,null,2);return`
            <div class="dev-panel-info">
                <span>Full debug object (large values truncated)</span>
            </div>
            <pre class="dev-panel-code dev-panel-json">${this.escapeHtml(i)}</pre>
        `}attachEventListeners(){this.container.querySelectorAll(".dev-panel-tab").forEach(e=>{e.addEventListener("click",()=>{this.activeTab=e.dataset.tab,this.render()})});const t=this.container.querySelector(".dev-panel-copy");t&&t.addEventListener("click",()=>this.copyCurrentContent());const r=this.container.querySelector(".dev-panel-close");r&&r.addEventListener("click",()=>this.hide())}async copyCurrentContent(){const t=this.container.querySelector(".dev-panel-code");if(t)try{await navigator.clipboard.writeText(t.textContent),this.showCopyFeedback()}catch(r){console.error("Failed to copy:",r)}}showCopyFeedback(){const t=this.container.querySelector(".dev-panel-copy");if(t){const r=t.innerHTML;t.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
            </svg>`,t.classList.add("copied"),setTimeout(()=>{t.innerHTML=r,t.classList.remove("copied")},1500)}}formatSize(t){if(!t)return"0 B";const r=["B","KB","MB","GB"];let e=t,n=0;for(;e>=1024&&n<r.length-1;)e/=1024,n++;return`${e.toFixed(n>0?1:0)} ${r[n]}`}escapeHtml(t){if(!t)return"";const r=document.createElement("div");return r.textContent=t,r.innerHTML}}class jc{constructor(){this.messageHandler=new Ml,this.uiManager=new ad(this.messageHandler),this.fileHandler=new sd(this.messageHandler,this.uiManager,{extractMsg:Nc,extractEml:ba},qt),this.keyboardManager=new ud(this),this.uiManager.setKeyboardManager(this.keyboardManager),this.devPanel=null,this.initDevMode()}initDevMode(){const t=document.getElementById("devPanel");t&&(this.devPanel=new dd(t),this.uiManager.setDevPanel(this.devPanel),qt.addListener(r=>{r.panelVisible&&this.devPanel?this.devPanel.show():this.devPanel&&this.devPanel.hide()}),qt.isEnabled()&&qt.showPanel())}toggleDevPanel(){qt.enable();const t=this.messageHandler.getCurrentMessage();t&&!t._debugData&&t._rawBuffer&&this.reloadDebugData(t),qt.togglePanel()}reloadDebugData(t){if(!(!t._rawBuffer||!t._fileType))try{const r={collectDebugData:!0};let e=null;t._fileType==="msg"?e=Nc(t._rawBuffer,r):t._fileType==="eml"&&(e=ba(t._rawBuffer,r)),e?._debugData&&(t._debugData=e._debugData,this.devPanel&&this.devPanel.setDebugData(t._debugData))}catch(r){console.error("Failed to reload debug data:",r)}}showMessage(t){const r=this.messageHandler.getMessages();r[t]&&this.uiManager.showMessage(r[t])}togglePin(t){const r=this.messageHandler.togglePin(t);this.uiManager.updateMessageList(),this.uiManager.showMessage(r)}deleteMessage(t){const e=this.messageHandler.getMessages()[t],n=this.uiManager.messageList.getFilteredMessages(),i=this.uiManager.searchManager.isSearchActive();let f=null;if(i&&n.length>1){const c=n.indexOf(e);if(c!==-1){const o=Math.min(c+1,n.length-1);f=c===n.length-1?n[c-1]:n[o]}}const a=this.messageHandler.deleteMessage(t);this.uiManager.updateMessageList();const l=i&&f?f:a;l?this.uiManager.showMessage(l):this.uiManager.showWelcomeScreen()}bulkDeleteMessages(t){if(!Array.isArray(t)||t.length===0)return;const r=new Set(t.map(f=>f.messageHash)),e=this.messageHandler.getCurrentMessage(),n=e&&r.has(e.messageHash);this.messageHandler.deleteMessagesByHash(r),this.uiManager.updateMessageList();const i=this.messageHandler.getMessages();if(i.length===0){this.uiManager.showWelcomeScreen();return}n||!e?this.uiManager.showMessage(i[0]):this.uiManager.showMessage(e)}bulkSetPinned(t,r){if(!Array.isArray(t)||t.length===0)return;const e=new Set(t.map(i=>i.messageHash));this.messageHandler.setPinnedByHash(e,r),this.uiManager.updateMessageList();const n=this.messageHandler.getCurrentMessage();n&&this.uiManager.showMessage(n)}}async function hd(){const s=await gu();s.length>0&&await window.app.fileHandler.handleFilesFromPaths(s),await bu(t=>{window.app.fileHandler.handleFileFromPath(t)}),await wu({onDrop:async t=>{await window.app.fileHandler.handleFilesFromPaths(t)},onEnter:()=>{window.app.uiManager.showDropOverlay()},onLeave:()=>{window.app.uiManager.hideDropOverlay()}}),vu()}function pd(){St.init();const s=document.getElementById("themeToggle"),t=document.getElementById("themeMenuDropdown");s?.addEventListener("click",r=>{r.stopPropagation(),t?.classList.toggle("active")}),document.addEventListener("click",r=>{r.target.closest("#themeMenu")||t?.classList.remove("active")}),document.querySelectorAll(".theme-menu-item").forEach(r=>{r.addEventListener("click",()=>{const e=r.dataset.theme,n=r.dataset.type;n==="app"?St.setTheme(e):n==="email"&&St.setEmailTheme(e),la(),t?.classList.remove("active")})}),St.addListener(()=>{la()}),la()}function la(){const s=St.getSavedTheme(),t=St.getActiveTheme(),r=St.getSavedEmailTheme(),e=document.getElementById("themeIconSun"),n=document.getElementById("themeIconMoon"),i=document.getElementById("themeIconSystem");e?.classList.remove("active"),n?.classList.remove("active"),i?.classList.remove("active"),s===Je.SYSTEM?i?.classList.add("active"):t===Je.DARK?e?.classList.add("active"):n?.classList.add("active"),document.querySelectorAll('.theme-menu-item[data-type="app"]').forEach(f=>{f.classList.toggle("active",f.dataset.theme===s)}),document.querySelectorAll('.theme-menu-item[data-type="email"]').forEach(f=>{f.classList.toggle("active",f.dataset.theme===r)})}typeof window<"u"&&(window.App=jc,document.addEventListener("DOMContentLoaded",async()=>{pd(),window.app=new jc,it()&&await hd()}));
